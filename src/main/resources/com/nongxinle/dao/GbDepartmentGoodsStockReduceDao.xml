<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.nongxinle.dao.GbDepartmentGoodsStockReduceDao">

    <select id="queryObject" resultType="com.nongxinle.entity.GbDepartmentGoodsStockReduceEntity">
        select *
        from gb_department_goods_stock_reduce
        where gb_department_goods_stock_reduce_id = #{value}
    </select>

    <select id="queryList" resultType="com.nongxinle.entity.GbDepartmentGoodsStockReduceEntity">
        select * from gb_department_goods_stock_reduce
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="queryTotal" resultType="int">
        select count(*)
        from gb_department_goods_stock_reduce
    </select>
    <select id="queryReduceCostByParams" resultType="com.nongxinle.entity.GbDepartmentGoodsStockReduceEntity">
        select * from gb_department_goods_stock_reduce as dgsr
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = dgsr.gb_dgsr_gb_dis_goods_id
        left join gb_department_goods_stock as gdgs on gdgs.gb_department_goods_stock_id =
        dgsr.gb_dgsr_gb_goods_stock_id
        <where>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>

            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt; #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="settleId != null and settleId == -1">
                and gb_dgsr_dep_settle_id is null
            </if>
            <if test="costWeight != null and costWeight == 1">
                and gb_dgsr_cost_weight is not null
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and dgsr.gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and dgsr.gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
    </select>
    <select id="queryReduceTypeCount" resultType="java.lang.Integer">
        select count(*) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>


            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="fatherGoodsId != null">
                and gb_dgsr_gb_dis_goods_father_id =#{fatherGoodsId}
            </if>
            <if test="waste != null and waste == 1">
                and gb_dgsr_waste_weight > 0
            </if>
            <if test="loss != null and loss == 1">
                and gb_dgsr_loss_weight > 0
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <select id="queryReduceProduceTotal" resultType="java.lang.Double">
        select SUM(gdgsr.gb_dgsr_produce_subtotal) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gdgsr.gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gdgsr.gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="week != null">
                and gdgsr.gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gdgsr.gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gdgsr.gb_dgsr_date = #{date}
            </if>
            <if test="equalType != null">
                and gdgsr.gb_dgsr_type = #{equalType}
            </if>

            <if test="fatherGoodsId != null">
                and gdgsr.gb_dgsr_gb_dis_goods_father_id =#{fatherGoodsId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryReduceLossTotal" resultType="java.lang.Double">
        select SUM(gb_dgsr_loss_subtotal) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="settleId != null and settleId == -1">
                and gb_dgsr_dep_settle_id is null
            </if>
            <if test="fatherGoodsId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{fatherGoodsId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>

    </select>
    <select id="queryReduceWasteTotal" resultType="java.lang.Double">
        select SUM(gb_dgsr_waste_subtotal) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>


            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>

            <if test="fatherGoodsId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{fatherGoodsId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>

    </select>
    <select id="queryReduceReturnTotal" resultType="java.lang.Double">
        select SUM(gb_dgsr_return_subtotal) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="fatherGoodsId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{fatherGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>

            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <resultMap id="depStock" type="GbDepartmentGoodsStockEntity">

        <id property="gbDepartmentGoodsStockId" column="gb_department_goods_stock_id"/>
        <result property="gbDgsProduceSellingSubtotal" column="gb_dgs_produce_selling_subtotal"/>
        <result property="gbDgsNxDistributerId" column="gb_dgs_nx_distributer_id"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsAfterProfitSubtotal" column="gb_dgs_after_profit_subtotal"/>
        <result property="gbDgsBetweenPrice" column="gb_dgs_between_price"/>
        <result property="gbDgsProfitWeight" column="gb_dgs_profit_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsRestWeightShowStandard" column="gb_dgs_rest_weight_show_standard"/>
        <result property="gbDgsRestWeightShowStandardName" column="gb_dgs_rest_weight_show_standard_name"/>
        <result property="gbDgsGbDisGoodsId" column="gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbDisGoodsFatherId" column="gb_dgs_gb_dis_goods_father_id"/>
        <result property="gbDgsGbDepDisGoodsId" column="gb_dgs_gb_dep_dis_goods_id"/>
        <result property="gbDgsPrice" column="gb_dgs_price"/>
        <result property="gbDgsWeight" column="gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="gb_dgs_produce_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="gb_dgs_gb_department_father_id"/>
        <result property="gbDgsStatus" column="gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="gb_dgs_date"/>
        <result property="gbDgsInventoryDate" column="gb_dgs_inventory_date"/>
        <result property="gbDgsInventoryWeek" column="gb_dgs_inventory_week"/>
        <result property="gbDgsInventoryMonth" column="gb_dgs_inventory_month"/>
        <result property="gbDgsWarnFullTime" column="gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="gb_dgs_return_subtotal"/>
        <result property="gbDgsWasteWeight" column="gb_dgs_waste_weight"/>
        <result property="gbDgsWasteSubtotal" column="gb_dgs_waste_subtotal"/>
        <result property="gbDgsWarnTimeQuantumName" column="gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPurGoodsId" column="from_gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="from_gb_dgs_gb_price_goods_id"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
        <collection property="goodsStockReduceEntityList" resultMap="reduceStock"/>
    </resultMap>

    <resultMap id="disGoods" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
        <result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
    </resultMap>

    <resultMap id="reduceStock" type="GbDepartmentGoodsStockReduceEntity">
        <id property="gbDepartmentGoodsStockReduceId" column="gb_department_goods_stock_reduce_id"/>
        <result property="gbDgsrStockNxDistribtuerId" column="gb_dgsr_stock_nx_distributer_id"/>
        <result property="gbDgsrProfitSubtotal" column="gb_dgsr_profit_subtotal"/>
        <result property="gbDgsrProfitSubtotal" column="gb_dgsr_profit_subtotal"/>
        <result property="gbDgsrGbGoodsStockId" column="gb_dgsr_gb_goods_stock_id"/>
        <result property="gbDgsrGbGoodsStockRecordId" column="gb_dgsr_gb_goods_stock_record_id"/>
        <result property="gbDgsrProduceWeight" column="gb_dgsr_produce_weight"/>
        <result property="gbDgsrProduceSubtotal" column="gb_dgsr_produce_subtotal"/>
        <result property="gbDgsrWasteWeight" column="gb_dgsr_waste_weight"/>
        <result property="gbDgsrWasteSubtotal" column="gb_dgsr_waste_subtotal"/>
        <result property="gbDgsrLossWeight" column="gb_dgsr_loss_weight"/>
        <result property="gbDgsrLossSubtotal" column="gb_dgsr_loss_subtotal"/>
        <result property="gbDgsrDate" column="gb_dgsr_date"/>
        <result property="gbDgsrType" column="gb_dgsr_type"/>
        <result property="gbDgsrStatus" column="gb_dgsr_status"/>
        <result property="gbDgsrDoUserId" column="gb_dgsr_do_user_id"/>
        <result property="gbDgsrFullTime" column="gb_dgsr_full_time"/>
        <result property="gbDgsrGbDepartmentId" column="gb_dgsr_gb_department_id"/>
        <result property="gbDgsrGbDepartmentFatherId" column="gb_dgsr_gb_department_father_id"/>
        <result property="gbDgsrGbDisGoodsId" column="gb_dgsr_gb_dis_goods_id"/>
        <result property="gbDgsrMonth" column="gb_dgsr_month"/>
        <result property="gbDgsrWeek" column="gb_dgsr_week"/>
        <result property="gbDgsrGbDistributerId" column="gb_dgsr_gb_distributer_id"/>
        <result property="gbDgsrReturnWeight" column="gb_dgsr_return_weight"/>
        <result property="gbDgsrReturnSubtotal" column="gb_dgsr_return_subtotal"/>
        <association property="gbDepartmentEntity" resultMap="dep"/>
        <association property="gbDepartmentGoodsStockEntity" resultMap="depStock"/>
    </resultMap>


    <select id="queryReduceGoodsTypeByParams" resultMap="reduceStock">
        select * ,
        fromgdgs.gb_department_goods_stock_id 'from_gb_department_goods_stock_id',
        fromgdgs.gb_dgs_gb_department_order_id 'from_gb_dgs_gb_department_order_id',
        fromgdgs.gb_dgs_gb_dis_goods_id 'from_gb_dgs_gb_dis_goods_id',
        fromgdgs.gb_dgs_gb_distributer_id 'from_gb_dgs_gb_distributer_id',
        fromgdgs.gb_dgs_gb_department_id 'from_gb_dgs_gb_department_id',
        fromgdgs.gb_dgs_price 'from_gb_dgs_price',
        fromgdgs.gb_dgs_weight 'from_gb_dgs_weight',
        fromgdgs.gb_dgs_price 'from_gb_dgs_price',
        fromgdgs.gb_dgs_subtotal 'from_gb_dgs_subtotal',
        fromgdgs.gb_dgs_rest_weight 'from_gb_dgs_rest_weight',
        fromgdgs.gb_dgs_rest_subtotal 'from_gb_dgs_rest_subtotal',
        fromgdgs.gb_dgs_status 'from_gb_dgs_status',
        fromgdgs.gb_dgs_gb_goods_stock_id 'from_gb_dgs_gb_goods_stock_id',
        fromgdgs.gb_dgs_receive_user_id 'from_gb_dgs_receive_user_id',
        fromgdgs.gb_dgs_date 'from_gb_dgs_date'

        from gb_department_goods_stock_reduce as gdgsr
        left join gb_department_goods_stock as gdg on gdgsr.gb_dgsr_gb_goods_stock_id = gdg.gb_department_goods_stock_id
        left join gb_distributer_goods as dg on gdgsr.gb_dgsr_gb_dis_goods_id = dg.gb_distributer_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        left join gb_department_goods_stock as fromgdgs on fromgdgs.gb_department_goods_stock_id =
        gdgsr.gb_dgsr_gb_goods_stock_id

        <where>
            <if test="inventoryType != null">
                and gdgsr.gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>

            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <resultMap id="dep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentAttrName" column="gb_department_attr_name"/>
        <result property="gbDepartmentFatherId" column="gb_department_father_id"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
        <result property="gbDepartmentPrintName" column="gb_department_print_name"/>
    </resultMap>

    <resultMap id="GbdepReduceAttach" type="GbDepartmentGoodsStockReduceAttachmentEntity">
        <id property="gbDepartmentGoodsStockReduceAttachId" column="gb_department_goods_stock_reduce_attach_id"/>
        <result property="gbDgsraContent" column="gb_dgsra_content"/>
        <result property="gbDgsraFilePath" column="gb_dgsra_file_path"/>
        <result property="gbDgsraGbDgsrId" column="gb_dgsra_gb_dgsr_id"/>
        <result property="gbDgsraStatus" column="gb_dgsra_startus"/>
    </resultMap>
    <resultMap id="reduceWithDep" type="GbDepartmentGoodsStockReduceEntity">
        <id property="gbDepartmentGoodsStockReduceId" column="gb_department_goods_stock_reduce_id"/>
        <result property="gbDgsrStockNxDistribtuerId" column="gb_dgsr_stock_nx_distributer_id"/>
        <result property="gbDgsrProfitSubtotal" column="gb_dgsr_profit_subtotal"/>
        <result property="gbDgsrGbGoodsStockId" column="gb_dgsr_gb_goods_stock_id"/>
        <result property="gbDgsrCostWeight" column="gb_dgsr_cost_weight"/>
        <result property="gbDgsrCostSubtotal" column="gb_dgsr_cost_subtotal"/>
        <result property="gbDgsrProduceWeight" column="gb_dgsr_produce_weight"/>
        <result property="gbDgsrProduceSubtotal" column="gb_dgsr_produce_subtotal"/>
        <result property="gbDgsrWasteWeight" column="gb_dgsr_waste_weight"/>
        <result property="gbDgsrWasteSubtotal" column="gb_dgsr_waste_subtotal"/>
        <result property="gbDgsrLossWeight" column="gb_dgsr_loss_weight"/>
        <result property="gbDgsrLossSubtotal" column="gb_dgsr_loss_subtotal"/>
        <result property="gbDgsrDate" column="gb_dgsr_date"/>
        <result property="gbDgsrType" column="gb_dgsr_type"/>
        <result property="gbDgsrStatus" column="gb_dgsr_status"/>
        <result property="gbDgsrDoUserId" column="gb_dgsr_do_user_id"/>
        <result property="gbDgsrFullTime" column="gb_dgsr_full_time"/>
        <result property="gbDgsrGbDepartmentId" column="gb_dgsr_gb_department_id"/>
        <result property="gbDgsrGbDepartmentFatherId" column="gb_dgsr_gb_department_father_id"/>
        <result property="gbDgsrGbDisGoodsId" column="gb_dgsr_gb_dis_goods_id"/>
        <result property="gbDgsrMonth" column="gb_dgsr_month"/>
        <result property="gbDgsrWeek" column="gb_dgsr_week"/>
        <result property="gbDgsrReturnWeight" column="gb_dgsr_return_weight"/>
        <result property="gbDgsrReturnSubtotal" column="gb_dgsr_return_subtotal"/>
        <result property="gbDgsrDoUserId" column="gb_dgsr_do_user_id"/>
        <association property="gbDepartmentGoodsStockEntity" resultMap="depStock"/>
        <association property="gbDepartmentEntity" resultMap="dep"/>
        <association property="gbDepartmentUserEntity" resultMap="depUser"/>
        <association property="gbDeGoodsStockReduceAttachmentEntity" resultMap="GbdepReduceAttach"/>
    </resultMap>


    <select id="queryStockReduceListByParams" resultMap="reduceWithDep">
        select * from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as dep on dep.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        left join gb_department_user as gdu on gdu.gb_department_user_id = gdgsr.gb_dgsr_do_user_id
        left join gb_department_goods_stock as gdgs on gdgs.gb_department_goods_stock_id =
        gdgsr.gb_dgsr_gb_goods_stock_id
        left join gb_department_goods_stock_reduce_attachment as gdgsra on gdgsra.gb_dgsra_gb_dgsr_id =
        gdgsr.gb_department_goods_stock_reduce_id

        <where>
            <if test="inventoryType != null">
                and gdgsr.gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="businessDisGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{businessDisGoodsId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>

            <if test="date != null">
                and gdgsr.gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="stockId != null">
                and gdgsr.gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="recordId != null">
                and gdgsr.gb_dgsr_gb_goods_stock_record_id = #{recordId}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="fromSettleId != null and fromSettleId == -1">
                and gdgsr.gb_dgsr_from_dep_settle_id is null
            </if>
            <if test="settleId != null and settleId != -1">
                and gb_dgsr_dep_settle_id = #{settleId}
            </if>

            <if test="settleId != null and settleId == -1">
                and gb_dgsr_dep_settle_id is null
            </if>
            <if test="month != null">
                and gb_dgsr_month = #{month}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
        order by gb_department_goods_stock_reduce_id
    </select>

    <resultMap id="fatherGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsLevel" column="gb_dfg_father_goods_level"/>
        <collection property="gbDistributerGoodsEntities" resultMap="disGoods"/>
    </resultMap>
    <resultMap id="grandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGrant_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGrant_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGrant_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="ndfgGrant_gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsLevel" column="ndfgGrant_gb_dfg_father_goods_level"/>
        <collection property="fatherGoodsEntities" resultMap="fatherGoods"/>
    </resultMap>

    <resultMap id="greatGrandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGreatGrand_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGreatGrand_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGreatGrand_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="ndfgGreatGrand_gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsLevel" column="ndfgGreatGrand_gb_dfg_father_goods_level"/>
        <collection property="fatherGoodsEntities" resultMap="grandGoods"/>
    </resultMap>

    <select id="queryReduceGoodsFatherTypeByParams" resultMap="greatGrandGoods">
        select *,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGrant.gb_dfg_father_goods_color 'ndfgGrant_gb_dfg_father_goods_color',
        ndfgGrant.gb_dfg_father_goods_level 'ndfgGrant_gb_dfg_father_goods_level',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_level 'ndfgGreatGrand_gb_dfg_father_goods_level'
        from gb_department_goods_stock_reduce as gdgsr
        left join nongxinle.gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgsr.gb_dgsr_gb_dis_goods_father_id
        left join nongxinle.gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join nongxinle.gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        <where>
            <if test="inventoryType != null">
                and gdgsr.gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="settleId != null and settleId == -1">
                and gb_dgsr_dep_settle_id is null
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
        order by ndfgGreatGrand.gb_distributer_father_goods_id,
        ndfgGrant.gb_distributer_father_goods_id,ndfg.gb_distributer_father_goods_id
    </select>


    <select id="queryReduceWasteWeightTotal" resultType="java.lang.Double">
        select SUM(gb_dgsr_waste_weight) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>

            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryReduceLossWeightTotal" resultType="java.lang.Double">
        select SUM(gb_dgsr_loss_weight) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>

            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryReduceProduceWeightTotal" resultType="java.lang.Double">
        select SUM(gdgsr.gb_dgsr_produce_weight) from gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <select id="queryReduceTypeGoodsFather" resultMap="fatherGoods">
        select * from nongxinle.gb_department_goods_stock_reduce as gdgsr
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        left join gb_distributer_father_goods as gdfg on gdfg.gb_distributer_father_goods_id = gdgsr.gb_dgsr_gb_dis_goods_father_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="inventoryType != null">
                and gdgsr.gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>

            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>


    <select id="queryReduceFatherGoods" resultMap="grandGoods">
        select *,
               ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
               ndfgGrant.gb_dfg_fathers_father_id       'ndfgGrant_gb_dfg_fathers_father_id',
               ndfgGrant.gb_dfg_father_goods_name       'ndfgGrant_gb_dfg_father_goods_name',
               ndfgGrant.gb_dfg_father_goods_color      'ndfgGrant_gb_dfg_father_goods_color',
               ndfgGrant.gb_dfg_father_goods_level      'ndfgGrant_gb_dfg_father_goods_level'
        from gb_department_goods_stock_reduce as gdgsr
                 left join gb_distributer_father_goods as f
                           on f.gb_distributer_father_goods_id = gdgsr.gb_dgsr_gb_dis_goods_father_id
                 left join gb_distributer_father_goods as ndfgGrant
                           on f.gb_dfg_fathers_father_id = ndfgGrant.gb_distributer_father_goods_id
    </select>

    <!--	<resultMap id="dep" type="GbDepartmentEntity">-->
    <!--		<id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>-->
    <!--		<result property="gbDepartmentName" column="gb_department_name"/>-->
    <!--	</resultMap>-->

    <resultMap id="sockLevel" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
        <result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="goodsWasteTotal" column="goods_waste_total"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>

        <collection property="wasteDepartmentEntities" resultMap="dep"/>
    </resultMap>
    <select id="queryGoodsStockRecordTreeByParams" resultMap="sockLevel">
        select * from gb_distributer_goods as dg
        left join gb_department_goods_stock_reduce as gdgsr on dg.gb_distributer_goods_id =
        gdgsr.gb_dgsr_gb_dis_goods_id
        left join gb_department as dep on dep.gb_department_id = gdgsr.gb_dgsr_gb_department_id
        <where>
            <if test="inventoryType != null">
                and gdgsr.gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dg_distributer_id = #{disId}
            </if>
            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>

            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgsr.gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depId != null">
                and gdgsr.gb_dgsr_gb_department_father_id = #{depId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
    </select>

    <resultMap id="reduceDepStock" type="GbDepartmentGoodsStockReduceEntity">
        <id property="gbDepartmentGoodsStockReduceId" column="gb_department_goods_stock_reduce_id"/>
        <result property="gbDgsrStockNxDistribtuerId" column="gb_dgsr_stock_nx_distributer_id"/>
        <result property="gbDgsrProfitSubtotal" column="gb_dgsr_profit_subtotal"/>
        <result property="gbDgsrGbGoodsStockId" column="gb_dgsr_gb_goods_stock_id"/>
        <result property="gbDgsrCostWeight" column="gb_dgsr_cost_weight"/>
        <result property="gbDgsrCostSubtotal" column="gb_dgsr_cost_subtotal"/>
        <result property="gbDgsrProduceWeight" column="gb_dgsr_produce_weight"/>
        <result property="gbDgsrProduceSubtotal" column="gb_dgsr_produce_subtotal"/>
        <result property="gbDgsrWasteWeight" column="gb_dgsr_waste_weight"/>
        <result property="gbDgsrWasteSubtotal" column="gb_dgsr_waste_subtotal"/>
        <result property="gbDgsrLossWeight" column="gb_dgsr_loss_weight"/>
        <result property="gbDgsrLossSubtotal" column="gb_dgsr_loss_subtotal"/>
        <result property="gbDgsrDate" column="gb_dgsr_date"/>
        <result property="gbDgsrType" column="gb_dgsr_type"/>
        <result property="gbDgsrStatus" column="gb_dgsr_status"/>
        <result property="gbDgsrDoUserId" column="gb_dgsr_do_user_id"/>
        <result property="gbDgsrFullTime" column="gb_dgsr_full_time"/>
        <result property="gbDgsrGbDepartmentId" column="gb_dgsr_gb_department_id"/>
        <result property="gbDgsrGbDepartmentFatherId" column="gb_dgsr_gb_department_father_id"/>
        <result property="gbDgsrGbDisGoodsId" column="gb_dgsr_gb_dis_goods_id"/>
        <result property="gbDgsrMonth" column="gb_dgsr_month"/>
        <result property="gbDgsrWeek" column="gb_dgsr_week"/>
        <result property="gbDgsrReturnWeight" column="gb_dgsr_return_weight"/>
        <result property="gbDgsrReturnSubtotal" column="gb_dgsr_return_subtotal"/>
        <result property="gbDgsrGbDepartmentId" column="gb_dgsr_gb_department_id"/>
        <result property="gbDgsrGbDepartmentFatherId" column="gb_dgsr_gb_department_father_id"/>
    </resultMap>


    <resultMap id="reduceDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="wasteDep_gb_department_id"/>
        <result property="gbDepartmentName" column="wasteDep_gb_department_name"/>
        <result property="gbDepartmentAttrName" column="wasteDep_gb_department_attr_name"/>
        <result property="gbDepartmentFatherId" column="wasteDep_gb_department_father_id"/>
        <association property="gbDepartmentGoodsStockEntities" resultMap="depStock"/>
<!--        <collection property="gbDepGoodsStockReduceEntities" resultMap="reduceDepStock"/>-->
    </resultMap>
    <resultMap id="purDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="pur_gb_department_id"/>
        <result property="gbDepartmentName" column="pur_gb_department_name"/>
    </resultMap>

<!---->


    <resultMap id="purGoodsWithReduce" type="GbDistributerPurchaseGoodsEntity">

        <id property="gbDistributerPurchaseGoodsId" column="gb_distributer_purchase_goods_id"/>
        <result property="gbDpgPurchaseNxDistributerId" column="gb_DPG_purchase_nx_distributer_id"/>
        <result property="gbDpgOrdersFinishAmount" column="gb_DPG_orders_finish_amount"/>
        <result property="gbDpgWeightId" column="gb_DPG_weight_id"/>
        <result property="gbDpgDisGoodsId" column="gb_DPG_dis_goods_id"/>
        <result property="gbDpgDisGoodsFatherId" column="gb_DPG_dis_goods_father_id"/>
        <result property="gbDpgQuantity" column="gb_DPG_quantity"/>
        <result property="gbDpgStandard" column="gb_DPG_standard"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgStatus" column="gb_DPG_status"/>
        <result property="gbDpgBuyPrice" column="gb_DPG_buy_price"/>
        <result property="gbDpgBuyScalePrice" column="gb_Dpg_buy_scale_price"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_Dpg_buy_scale_quantity"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgBuyQuantity" column="gb_DPG_buy_quantity"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgOrdersAmount" column="gb_DPG_orders_amount"/>
        <result property="gbDpgTypeAddUserId" column="gb_DPG_type_add_user_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgTime" column="gb_DPG_time"/>
        <result property="gbDpgDistributerId" column="gb_DPG_distributer_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgPurchaseFullTime" column="gb_DPG_purchase_full_time"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgPurchaseMonth" column="gb_DPG_purchase_month"/>
        <result property="gbDpgPurchaseDate" column="gb_DPG_purchase_date"/>
        <result property="gbDpgPurchaseYear" column="gb_DPG_purchase_year"/>
        <result property="gbDpgDisGoodsPriceId" column="gb_DPG_dis_goods_price_id"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgPurchaseDepartmentId" column="gb_DPG_purchase_department_id"/>
        <result property="gbDpgPurchaseWeek" column="gb_DPG_purchase_week"/>
        <result property="gbDpgPurchaseWeekYear" column="gb_DPG_purchase_week_year"/>
        <result property="gbDpgBatchId" column="gb_DPG_batch_id"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_DPG_buy_scale_quantity"/>
        <result property="gbDpgBuyScale" column="gb_DPG_buy_scale"/>
        <result property="gbDpgBuyScalePrice" column="gb_DPG_buy_scale_price"/>
        <result property="gbDpgBuyPriceReason" column="gb_DPG_buy_price_reason"/>
        <result property="gbDpgWarnFullTime" column="gb_DPG_warn_full_time"/>
        <result property="gbDpgWasteFullTime" column="gb_DPG_waste_full_time"/>
        <association property="purchaseDepartmentEntity" resultMap="purDep"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="depStock"/>
    </resultMap>

    <resultMap id="purGoodsWork" type="GbDistributerPurchaseGoodsEntity">

        <id property="gbDistributerPurchaseGoodsId" column="gb_distributer_purchase_goods_id"/>
        <result property="gbDpgPurchaseNxDistributerId" column="gb_DPG_purchase_nx_distributer_id"/>
        <result property="gbDpgOrdersFinishAmount" column="gb_DPG_orders_finish_amount"/>
        <result property="gbDpgWeightId" column="gb_DPG_weight_id"/>
        <result property="gbDpgDisGoodsId" column="gb_DPG_dis_goods_id"/>
        <result property="gbDpgDisGoodsFatherId" column="gb_DPG_dis_goods_father_id"/>
        <result property="gbDpgQuantity" column="gb_DPG_quantity"/>
        <result property="gbDpgStandard" column="gb_DPG_standard"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgStatus" column="gb_DPG_status"/>
        <result property="gbDpgBuyPrice" column="gb_DPG_buy_price"/>
        <result property="gbDpgBuyScalePrice" column="gb_Dpg_buy_scale_price"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_Dpg_buy_scale_quantity"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgBuyQuantity" column="gb_DPG_buy_quantity"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgOrdersAmount" column="gb_DPG_orders_amount"/>
        <result property="gbDpgTypeAddUserId" column="gb_DPG_type_add_user_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgTime" column="gb_DPG_time"/>
        <result property="gbDpgDistributerId" column="gb_DPG_distributer_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgPurchaseFullTime" column="gb_DPG_purchase_full_time"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgPurchaseMonth" column="gb_DPG_purchase_month"/>
        <result property="gbDpgPurchaseDate" column="gb_DPG_purchase_date"/>
        <result property="gbDpgPurchaseYear" column="gb_DPG_purchase_year"/>
        <result property="gbDpgDisGoodsPriceId" column="gb_DPG_dis_goods_price_id"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgPurchaseDepartmentId" column="gb_DPG_purchase_department_id"/>
        <result property="gbDpgPurchaseWeek" column="gb_DPG_purchase_week"/>
        <result property="gbDpgPurchaseWeekYear" column="gb_DPG_purchase_week_year"/>
        <result property="gbDpgBatchId" column="gb_DPG_batch_id"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_DPG_buy_scale_quantity"/>
        <result property="gbDpgBuyScale" column="gb_DPG_buy_scale"/>
        <result property="gbDpgBuyScalePrice" column="gb_DPG_buy_scale_price"/>
        <result property="gbDpgBuyPriceReason" column="gb_DPG_buy_price_reason"/>
        <result property="gbDpgWarnFullTime" column="gb_DPG_warn_full_time"/>
        <result property="gbDpgWasteFullTime" column="gb_DPG_waste_full_time"/>
        <association property="purchaseDepartmentEntity" resultMap="purDep"/>
        <collection property="wasteDepartmentEntities" resultMap="reduceDep"/>
    </resultMap>


    <resultMap id="depStockRecord" type="GbDepartmentGoodsStockRecordEntity">
        <id property="gbDepartmentGoodsStockRecordId" column="gb_department_goods_stock_record_id"/>
        <result property="gbDgscGbDepartmentId" column="gb_dgsc_gb_department_id"/>
        <result property="gbDgscGbDepartmentFatherId" column="gb_dgsc_gb_department_father_id"/>
        <result property="gbDgscDate" column="gb_dgsc_date"/>
        <result property="gbDgscFromGbGoodsStockId" column="gb_dgsc_from_gb_goods_stock_id"/>
        <result property="gbDgscDepSettleId" column="gb_dgsc_from_gb_goods_stock_id"/>
        <result property="gbDgscGbDisGoodsId" column="gb_dgsc_gb_dis_goods_id"/>
        <result property="gbDgscWeight" column="gb_dgsc_weight"/>
        <result property="gbDgscProduceWeight" column="gb_dgsc_produce_weight"/>
        <result property="gbDgscProduceSubtotal" column="gb_dgsc_produce_subttotal"/>
        <result property="gbDgscLossWeight" column="gb_dgsc_loss_weight"/>
        <result property="gbDgscLossSubtotal" column="gb_dgsc_loss_subtotla"/>
        <result property="gbDgscDoWasteWeight" column="gb_dgsc_do_waste_weight"/>
        <result property="gbDgscDoWasteSubtotal" column="gb_dgsc_do_waste_subtotal"/>
        <result property="gbDgscDate" column="gb_dgsc_date"/>
        <result property="gbDgscWeek" column="gb_dgsc_week"/>
        <result property="gbDgscMonth" column="gb_dgsc_month"/>
        <result property="gbDgscYear" column="gb_dgsc_year"/>
        <result property="gbDgscTimeStamp" column="gb_dgsc_time_stamp"/>
        <result property="gbDgscGbPurGoodsId" column="gb_dgsc_gb_pur_goods_id"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
    </resultMap>
    <resultMap id="depStockWrok" type="GbDepartmentGoodsStockEntity">

        <id property="gbDepartmentGoodsStockId" column="gb_department_goods_stock_id"/>
        <result property="gbDgsProduceSellingSubtotal" column="gb_dgs_produce_selling_subtotal"/>
        <result property="gbDgsNxDistributerId" column="gb_dgs_nx_distributer_id"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsAfterProfitSubtotal" column="gb_dgs_after_profit_subtotal"/>
        <result property="gbDgsBetweenPrice" column="gb_dgs_between_price"/>
        <result property="gbDgsProfitWeight" column="gb_dgs_profit_weight"/>

        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsRestWeightShowStandard" column="gb_dgs_rest_weight_show_standard"/>
        <result property="gbDgsRestWeightShowStandardName" column="gb_dgs_rest_weight_show_standard_name"/>
        <result property="gbDgsGbDisGoodsId" column="gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbDisGoodsFatherId" column="gb_dgs_gb_dis_goods_father_id"/>
        <result property="gbDgsGbDepDisGoodsId" column="gb_dgs_gb_dep_dis_goods_id"/>
        <result property="gbDgsPrice" column="gb_dgs_price"/>
        <result property="gbDgsWeight" column="gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="gb_dgs_produce_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="gb_dgs_gb_department_father_id"/>
        <result property="gbDgsStatus" column="gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="gb_dgs_date"/>
        <result property="gbDgsInventoryDate" column="gb_dgs_inventory_date"/>
        <result property="gbDgsInventoryWeek" column="gb_dgs_inventory_week"/>
        <result property="gbDgsInventoryMonth" column="gb_dgs_inventory_month"/>
        <result property="gbDgsWarnFullTime" column="gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="gb_dgs_return_subtotal"/>
        <result property="gbDgsWarnTimeQuantumName" column="gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPurGoodsId" column="from_gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="from_gb_dgs_gb_price_goods_id"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
        <!--		<association property="purchaseGoodsEntity" resultMap="purGoodsWork"/>-->
    </resultMap>

    <resultMap id="depUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="gb_department_user_id"/>
        <result property="gbDuLoginTimes" column="gb_DU_login_times"/>
        <result property="gbDuCustomerService" column="gb_DU_customer_service"/>
        <result property="gbDuWxNickName" column="gb_DU_wx_nick_name"/>
        <result property="gbDuWxAvartraUrl" column="gb_DU_wx_avartra_url"/>
        <result property="gbDuUrlChange" column="gb_DU_url_change"/>
        <result property="gbDuPrintDeviceId" column="gb_DU_print_device_id"/>
        <result property="gbDuPrintBillDeviceId" column="gb_DU_print_bill_device_id"/>
    </resultMap>
    <!--	-->
    <!--	<resultMap id="reduceStockWork" type="GbDepartmentGoodsStockReduceEntity">-->
    <!--		<id property="gbDepartmentGoodsStockReduceId" column="gb_department_goods_stock_reduce_id"/>
            <result property="gbDgsrProfitSubtotal" column="gb_dgsr_profit_subtotal"/>-->
    <!--		<result property="gbDgsrGbGoodsStockId" column="gb_dgsr_gb_goods_stock_id"/>-->
    <!--		<result property="gbDgsrGbGoodsStockRecordId" column="gb_dgsr_gb_goods_stock_record_id"/>-->
    <!--		<result property="gbDgsrProduceWeight" column="gb_dgsr_produce_weight"/>-->
    <!--		<result property="gbDgsrProduceSubtotal" column="gb_dgsr_produce_subtotal"/>-->
    <!--		<result property="gbDgsrWasteWeight" column="gb_dgsr_waste_weight"/>-->
    <!--		<result property="gbDgsrWasteSubtotal" column="gb_dgsr_waste_subtotal"/>-->
    <!--		<result property="gbDgsrLossWeight" column="gb_dgsr_loss_weight"/>-->
    <!--		<result property="gbDgsrLossSubtotal" column="gb_dgsr_loss_subtotal"/>-->
    <!--		<result property="gbDgsrDate" column="gb_dgsr_date"/>-->
    <!--		<result property="gbDgsrType" column="gb_dgsr_type"/>-->
    <!--		<result property="gbDgsrDoUserId" column="gb_dgsr_do_user_id"/>-->
    <!--		<result property="gbDgsrFullTime" column="gb_dgsr_full_time"/>-->
    <!--		<result property="gbDgsrGbDepartmentId" column="gb_dgsr_gb_department_id"/>-->
    <!--		<result property="gbDgsrGbDepartmentFatherId" column="gb_dgsr_gb_department_father_id"/>-->
    <!--		<result property="gbDgsrGbDisGoodsId" column="gb_dgsr_gb_dis_goods_id"/>-->
    <!--		<result property="gbDgsrMonth" column="gb_dgsr_month"/>-->
    <!--		<result property="gbDgsrWeek" column="gb_dgsr_week"/>-->
    <!--		<result property="gbDgsrGbDistributerId" column="gb_dgsr_gb_distributer_id"/>-->
    <!--		<result property="gbDgsrReturnWeight" column="gb_dgsr_return_weight"/>-->
    <!--		<result property="gbDgsrReturnSubtotal" column="gb_dgsr_return_subtotal"/>-->
    <!--		<result property="gbDgsrDoUserId" column="gb_dgsr_do_user_id"/>-->
    <!--		<result property="gbDgsrGbGoodsStockRecordId" column="gb_dgsr_gb_goods_record_id"/>-->
    <!--		<association property="gbDisPurchaseGoodsEntity" resultMap="purGoodsWork"/>-->
    <!--		<association property="gbDepartmentGoodsStockEntity" resultMap="depStockWrok"/>-->
    <!--		<association property="gbDepartmentUserEntity" resultMap="depUser"/>-->
    <!--		<association property="gbDepartmentGoodsStockRecordEntity" resultMap="depStockRecord"/>-->
    <!--	</resultMap>-->


    <!--	<select id="queryReduceGoodsTypeWorkByParams" resultMap="reduceStockWork">-->
    <!--		select *-->

    <!--		from  gb_department_goods_stock_reduce as gdgsr-->
    <!--		          left join gb_department_goods_stock as gdg on gdgsr.gb_dgsr_gb_goods_stock_id = gdg.gb_department_goods_stock_id-->
    <!--				  left join gb_distributer_goods as dg  on gdgsr.gb_dgsr_gb_dis_goods_id = dg.gb_distributer_goods_id-->
    <!--                  left join gb_distributer_purchase_goods as gdpg on gdpg.gb_distributer_purchase_goods_id = gdgsr.gb_dgsr_gb_pur_goods_id-->
    <!--			   	left join gb_department as purGd on purGd.gb_department_id = gdpg.gb_DPG_purchase_department_id-->
    <!--			   	left join gb_department_user as gdu on gdu.gb_department_user_id = gdgsr.gb_dgsr_do_user_id-->
    <!--			     left join gb_department_goods_stock_record  as gdgsc on gdgsc.gb_department_goods_stock_record_id = gdgsr.gb_dgsr_gb_goods_stock_record_id-->

    <!--		<where>-->
    <!--			<if test="disId != null">-->
    <!--				and gb_dg_distributer_id = #{disId}-->
    <!--			</if>-->
    <!--			<if test="startDate != null">-->
    <!--				and gdgsr.gb_dgsr_date  &gt;= #{startDate}-->
    <!--			</if>-->
    <!--			<if test="stopDate != null">-->
    <!--				and gdgsr.gb_dgsr_date  &lt;=  #{stopDate}-->
    <!--			</if>-->
    <!--			<if test="equalType != null">-->
    <!--				and  gb_dgsr_type = #{equalType}-->
    <!--			</if>-->

    <!--			<if test="disGoodsId != null">-->
    <!--				and gb_dgsr_gb_dis_goods_id = #{disGoodsId}-->
    <!--			</if>-->
    <!--			<if test="depFatherId != null">-->
    <!--				and  gb_dgsr_gb_department_father_id = #{depFatherId}-->
    <!--			</if>-->

    <!--		</where>-->
    <!--	</select>-->

    <resultMap id="reduceStockWorkGoods" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
        <result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgPullOff" column="gb_dg_pull_off"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgNxDistributerId" column="gb_dg_nx_distributer_id"/>
        <result property="gbDgNxDistributerGoodsId" column="gb_dg_nx_distributer_goods_id"/>
        <result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgGbSupplierId" column="gb_dg_gb_supplier_id"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsStatus" column="gb_dg_goods_status"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
        <collection property="wastePurGoodsEntities" resultMap="purGoodsWork"/>

    </resultMap>

    <select id="queryReduceGoodsTypeWorkByParams" resultMap="reduceStockWorkGoods">
        select *,
        purGd.gb_department_id 'pur_gb_department_id',
        purGd.gb_department_name 'pur_gb_department_name',
        reduceDep.gb_department_id 'wasteDep_gb_department_id',
        reduceDep.gb_department_name 'wasteDep_gb_department_name'
        from gb_department_goods_stock_reduce as gdgsr
        left join gb_department_goods_stock as gdg on gdgsr.gb_dgsr_gb_goods_stock_id = gdg.gb_department_goods_stock_id
        left join gb_distributer_goods as dg on gdgsr.gb_dgsr_gb_dis_goods_id = dg.gb_distributer_goods_id
        left join gb_distributer_purchase_goods as gdpg on gdpg.gb_distributer_purchase_goods_id =
        gdgsr.gb_dgsr_gb_pur_goods_id
        left join gb_department as purGd on purGd.gb_department_id = gdpg.gb_DPG_purchase_department_id
        left join gb_department as reduceDep on reduceDep.gb_department_id = gdgsr.gb_dgsr_gb_department_father_id
        left join gb_department_user as gdu on gdu.gb_department_user_id = gdgsr.gb_dgsr_do_user_id
        left join gb_department_goods_stock_record as gdgsc on gdgsc.gb_department_goods_stock_record_id =
        gdgsr.gb_dgsr_gb_goods_stock_record_id

        <where>
            <if test="inventoryType != null">
                and gdgsr.gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gdgsr.gb_dgsr_type = #{equalType}
            </if>

            <if test="disGoodsId != null">
                and gdgsr.gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgsr.gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryReduceCostSubtotal" resultType="java.lang.Double">
        select SUM(gdgsr.gb_dgsr_cost_subtotal) from gb_department_goods_stock_reduce gdgsr
        <where>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="fatherGoodsId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{fatherGoodsId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryReduceCostWeightTotal" resultType="java.lang.Double">
        select SUM(gdgsr.gb_dgsr_cost_weight) from gb_department_goods_stock_reduce as gdgsr
        <where>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryReduceProfitSubtotal" resultType="java.lang.Double">
        select SUM(gdgsr.gb_dgsr_profit_subtotal) from gb_department_goods_stock_reduce as gdgsr
        <where>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fatherGoodsId != null">
                and gb_dgsr_gb_dis_goods_father_id =#{fatherGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryReduceSellingSubtotal" resultType="java.lang.Double">
        select SUM(gdgsr.gb_dgsr_sales_subtotal) from gb_department_goods_stock_reduce as gdgsr
        <where>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fatherGoodsId != null">
                and gb_dgsr_gb_dis_goods_father_id =#{fatherGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>


    <resultMap id="disGoodsTree" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
        <result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgGoodsType" column="gb_dg_goods_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
        <association property="reduceEntity" resultMap="reduceStock"/>
    </resultMap>
    <resultMap id="fatherGoodsTree" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="gb_dfg_father_goods_color"/>
        <collection property="gbDistributerGoodsEntities" resultMap="disGoodsTree"/>
    </resultMap>
    <resultMap id="grandGoodsTree" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGrant_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGrant_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGrant_gb_dfg_father_goods_name"/>
        <collection property="fatherGoodsEntities" resultMap="fatherGoodsTree"/>
    </resultMap>

    <resultMap id="greatGrandGoodsTree" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGreatGrand_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGreatGrand_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGreatGrand_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="ndfgGreatGrand_gb_dfg_father_goods_color"/>
        <collection property="fatherGoodsEntities" resultMap="grandGoodsTree"/>
    </resultMap>
    <select id="queryDepStockReduceTreeFatherGoodsByParams" resultMap="greatGrandGoodsTree">

        select * ,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name'
        from gb_department_goods_stock_reduce as gdgsr
        left join gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgsr.gb_dgsr_gb_dis_goods_father_id
        left join gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgsr.gb_dgsr_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgsr.gb_dgsr_gb_department_father_id

        <where>
            <if test="disId != null">
                and gdgsr.gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depFatherId != null">
                and gdgsr.gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgsr.gb_dgsr_gb_department_id = #{depId}
            </if>

            <if test="loss != null">
                and gdgsr.gb_dgsr_loss_weight &gt; #{loss}
            </if>


            <if test="disGoodsId != null">
                and gdgsr.gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgsr.gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>

            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>

            <if test="date != null">
                and gdgsr.gb_dgsr_date = #{date}
            </if>

            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>

            <if test="depId != null">
                and gdgsr.gb_dgsr_gb_department_id = #{depId}
            </if>

            <if test="depFatherIds != null">
                and gdgsr.gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
        order by
        ndfgGreatGrand.gb_dfg_father_goods_sort,ndfgGrant.gb_dfg_father_goods_sort,ndfg.gb_dfg_father_goods_sort

    </select>
    <select id="queryReduceReturnWeightTotal" resultType="java.lang.Double">
        select SUM(gdgsr.gb_dgsr_return_weight) from gb_department_goods_stock_reduce as gdgsr
        <where>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <select id="queryReduceDepartment" resultMap="reduceDep">
        select *,
        reduceDep.gb_department_id 'wasteDep_gb_department_id',
        reduceDep.gb_department_name 'wasteDep_gb_department_name'
               from gb_department_goods_stock_reduce as gdgsr
            left join gb_department_goods_stock as gdgs on gdgs.gb_department_goods_stock_id = gdgsr.gb_dgsr_gb_goods_stock_id
        left join gb_department as reduceDep on reduceDep.gb_department_id = gdgsr.gb_dgsr_gb_department_father_id
        <where>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryPurGoodsForCost" resultMap="purGoodsWithReduce">
        select * from gb_department_goods_stock_reduce as gdgsr
        left join gb_department_goods_stock as gdgs on gdgs.gb_department_goods_stock_id = gdgsr.gb_dgsr_gb_goods_stock_id
         left join gb_distributer_purchase_goods as gdpg on gdpg.gb_distributer_purchase_goods_id = gdgs.gb_dgs_gb_pur_goods_id
          left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdpg.gb_DPG_dis_goods_id
        <where>
            <if test="inventoryType != null">
                and gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="depId != null">
                and gb_dgsr_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgsr_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="week != null">
                and gb_dgsr_week = #{week}
            </if>

            <if test="stockId != null">
                and gb_dgsr_gb_goods_stock_id = #{stockId}
            </if>
            <if test="date != null">
                and gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gb_dgsr_type = #{equalType}
            </if>
            <if test="disGoodsId != null">
                and gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="nxDisId != null">
                and gb_dgsr_stock_nx_distributer_id = #{nxDisId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgsr_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherIds != null">
                and gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>


    <insert id="save" parameterType="com.nongxinle.entity.GbDepartmentGoodsStockReduceEntity"
            useGeneratedKeys="true" keyProperty="gbDepartmentGoodsStockReduceId">
        insert into gb_department_goods_stock_reduce
        (`gb_department_goods_stock_reduce_id`,
         `gb_dgsr_gb_distributer_id`,
         `gb_dgsr_gb_department_id`,
         `gb_dgsr_gb_department_father_id`,
         `gb_dgsr_gb_dis_goods_id`,
         `gb_dgsr_gb_dep_dis_goods_id`,
         `gb_dgsr_gb_dis_goods_father_id`,
         `gb_dgsr_gb_goods_stock_id`,
         `gb_dgsr_gb_goods_stock_record_id`,
         `gb_dgsr_date`,
         `gb_dgsr_week`,
         `gb_dgsr_month`,
         `gb_dgsr_full_time`,
         `gb_dgsr_type`,
         `gb_dgsr_do_user_id`,
         `gb_dgsr_cost_weight`,
         `gb_dgsr_cost_subtotal`,
         `gb_dgsr_waste_weight`,
         `gb_dgsr_waste_subtotal`,
         `gb_dgsr_loss_weight`,
         `gb_dgsr_loss_subtotal`,
         `gb_dgsr_return_weight`,
         `gb_dgsr_return_subtotal`,
         `gb_dgsr_dep_settle_id`,
         `gb_dgsr_from_dep_settle_id`,
         `gb_dgsr_produce_weight`,
         `gb_dgsr_produce_subtotal`,
         `gb_dgsr_gb_pur_goods_id`,
         `gb_dgsr_gb_goods_inventory_type`,
         `gb_dgsr_profit_subtotal`,
         `gb_dgsr_sales_subtotal`,
         `gb_dgsr_status`,
         `gb_dgsr_stock_nx_distributer_id`)
        values (#{gbDepartmentGoodsStockReduceId},
                #{gbDgsrGbDistributerId},
                #{gbDgsrGbDepartmentId},
                #{gbDgsrGbDepartmentFatherId},
                #{gbDgsrGbDisGoodsId},
                #{gbDgsrGbDepDisGoodsId},
                #{gbDgsrGbDisGoodsFatherId},
                #{gbDgsrGbGoodsStockId},
                #{gbDgsrGbGoodsStockRecordId},
                #{gbDgsrDate},
                #{gbDgsrWeek},
                #{gbDgsrMonth},
                #{gbDgsrFullTime},
                #{gbDgsrType},
                #{gbDgsrDoUserId},
                #{gbDgsrCostWeight},
                #{gbDgsrCostSubtotal},
                #{gbDgsrWasteWeight},
                #{gbDgsrWasteSubtotal},
                #{gbDgsrLossWeight},
                #{gbDgsrLossSubtotal},
                #{gbDgsrReturnWeight},
                #{gbDgsrReturnSubtotal},
                #{gbDgsrDepSettleId},
                #{gbDgsrFromDepSettleId},
                #{gbDgsrProduceWeight},
                #{gbDgsrProduceSubtotal},
                #{gbDgsrGbPurGoodsId},
                #{gbDgsrGbGoodsInventoryType},
                #{gbDgsrProfitSubtotal},
                #{gbDgsrSalesSubtotal},
                #{gbDgsrStatus},
                #{gbDgsrStockNxDistribtuerId})
    </insert>


    <update id="update" parameterType="com.nongxinle.entity.GbDepartmentGoodsStockReduceEntity">
        update gb_department_goods_stock_reduce
        <set>
            <if test="gbDgsrGbDistributerId != null">`gb_dgsr_gb_distributer_id` = #{gbDgsrGbDistributerId},</if>
            <if test="gbDgsrGbDepartmentId != null">`gb_dgsr_gb_department_id` = #{gbDgsrGbDepartmentId},</if>
            <if test="gbDgsrGbDepartmentFatherId != null">`gb_dgsr_gb_department_father_id` =
                #{gbDgsrGbDepartmentFatherId},
            </if>
            <if test="gbDgsrGbDisGoodsId != null">`gb_dgsr_gb_dis_goods_id` = #{gbDgsrGbDisGoodsId},</if>
            <if test="gbDgsrGbDepDisGoodsId != null">`gb_dgsr_gb_dep_dis_goods_id` = #{gbDgsrGbDepDisGoodsId},</if>
            <if test="gbDgsrGbDisGoodsFatherId != null">`gb_dgsr_gb_dis_goods_father_id` =
                #{gbDgsrGbDisGoodsFatherId},
            </if>
            <if test="gbDgsrGbGoodsStockId != null">`gb_dgsr_gb_goods_stock_id` = #{gbDgsrGbGoodsStockId},</if>
            <if test="gbDgsrDate != null">`gb_dgsr_date` = #{gbDgsrDate},</if>
            <if test="gbDgsrWeek != null">`gb_dgsr_week` = #{gbDgsrWeek},</if>
            <if test="gbDgsrMonth != null">`gb_dgsr_month` = #{gbDgsrMonth},</if>
            <if test="gbDgsrFullTime != null">`gb_dgsr_full_time` = #{gbDgsrFullTime},</if>
            <if test="gbDgsrType != null">`gb_dgsr_type` = #{gbDgsrType},</if>
            <if test="gbDgsrDoUserId != null">`gb_dgsr_do_user_id` = #{gbDgsrDoUserId},</if>
            <if test="gbDgsrCostWeight != null">`gb_dgsr_cost_weight` = #{gbDgsrCostWeight},</if>
            <if test="gbDgsrCostSubtotal != null">`gb_dgsr_cost_subtotal` = #{gbDgsrCostSubtotal},</if>
            <if test="gbDgsrWasteWeight != null">`gb_dgsr_waste_weight` = #{gbDgsrWasteWeight},</if>
            <if test="gbDgsrWasteSubtotal != null">`gb_dgsr_waste_subtotal` = #{gbDgsrWasteSubtotal},</if>
            <if test="gbDgsrLossWeight != null">`gb_dgsr_loss_weight` = #{gbDgsrLossWeight},</if>
            <if test="gbDgsrLossSubtotal != null">`gb_dgsr_loss_subtotal` = #{gbDgsrLossSubtotal},</if>
            <if test="gbDgsrReturnWeight != null">`gb_dgsr_return_weight` = #{gbDgsrReturnWeight},</if>
            <if test="gbDgsrDepSettleId != null">`gb_dgsr_dep_settle_id` = #{gbDgsrDepSettleId},</if>
            <if test="gbDgsrFromDepSettleId != null">`gb_dgsr_from_dep_settle_id` = #{gbDgsrFromDepSettleId},</if>
            <if test="gbDgsrProduceWeight != null">`gb_dgsr_produce_weight` = #{gbDgsrProduceWeight},</if>
            <if test="gbDgsrProduceSubtotal != null">`gb_dgsr_produce_subtotal` = #{gbDgsrProduceSubtotal},</if>
            <if test="gbDgsrGbDistributerId != null">`gb_dgsr_gb_distributer_id` = #{gbDgsrGbDistributerId},</if>
            <if test="gbDgsrGbGoodsStockRecordId != null">`gb_dgsr_gb_goods_stock_record_id` =
                #{gbDgsrGbGoodsStockRecordId},
            </if>
            <if test="gbDgsrGbPurGoodsId != null">`gb_dgsr_gb_pur_goods_id` = #{gbDgsrGbPurGoodsId},</if>
            <if test="gbDgsrGbGoodsInventoryType != null">`gb_dgsr_gb_goods_inventory_type` =
                #{gbDgsrGbGoodsInventoryType},
            </if>
            <if test="gbDgsrProfitSubtotal != null">`gb_dgsr_profit_subtotal` = #{gbDgsrProfitSubtotal},</if>
            <if test="gbDgsrSalesSubtotal != null">`gb_dgsr_sales_subtotal` = #{gbDgsrSalesSubtotal},</if>
            <if test="gbDgsrStatus != null">`gb_dgsr_status` = #{gbDgsrStatus},</if>
            <if test="gbDgsrStockNxDistribtuerId != null">`gb_dgsr_stock_nx_distributer_id` =
                #{gbDgsrStockNxDistribtuerId},
            </if>
            <if test="gbDgsrReturnSubtotal != null">`gb_dgsr_return_subtotal` = #{gbDgsrReturnSubtotal}</if>
        </set>
        where gb_department_goods_stock_reduce_id = #{gbDepartmentGoodsStockReduceId}
    </update>

    <delete id="delete">
        delete
        from gb_department_goods_stock_reduce
        where gb_department_goods_stock_reduce_id = #{value}
    </delete>

    <delete id="deleteBatch">
        delete from gb_department_goods_stock_reduce where gb_department_goods_stock_reduce_id in
        <foreach item="gbDepartmentGoodsStockReduceId" collection="array" open="(" separator="," close=")">
            #{gbDepartmentGoodsStockReduceId}
        </foreach>
    </delete>

</mapper>