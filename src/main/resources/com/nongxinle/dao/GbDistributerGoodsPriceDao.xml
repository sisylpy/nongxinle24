<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.nongxinle.dao.GbDistributerGoodsPriceDao">

    <select id="queryObject" resultType="com.nongxinle.entity.GbDistributerGoodsPriceEntity">
        select *
        from gb_distributer_goods_price
        where gb_distributer_goods_price_id = #{value}
    </select>

    <select id="queryList" resultType="com.nongxinle.entity.GbDistributerGoodsPriceEntity">
        select * from gb_distributer_goods_price
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="queryTotal" resultType="int">
        select count(*)
        from gb_distributer_goods_price
    </select>

	<resultMap id="disGoodsWithGoodsPrice" type="GbDistributerGoodsEntity">
		<id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
		<result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
		<result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
		<result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
		<result property="gbDgGoodsName" column="gb_dg_goods_name"/>
		<result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
		<result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
		<result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
		<result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
		<result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
		<result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
		<result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
		<result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
		<result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
		<result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
		<result property="gbDgControlPrice" column="gb_dg_control_price"/>
		<result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
		<result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
		<result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
		<result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
		<result property="gbDgGbSupplierId" column="gb_dg_gb_supplier_id"/>
		<result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
		<result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
		<result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
		<result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
		<result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
		<result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
		<result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
		<result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
		<result property="gbDgSelfPrice" column="gb_dg_self_price"/>
		<collection property="gbDisGoodsPriceEntities" resultMap="justPurGoods"/>
 	</resultMap>
	<resultMap id="justPurGoods" type="GbDistributerPurchaseGoodsEntity">

		<id property="gbDistributerPurchaseGoodsId" column="gb_distributer_purchase_goods_id"/>
		<result property="gbDpgPurchaseNxDistributerId" column="gb_DPG_purchase_nx_distributer_id"/>
        <result property="gbDpgOrdersFinishAmount" column="gb_DPG_orders_finish_amount"/>
        <result property="gbDpgOrdersFinishAmount" column="gb_DPG_orders_finish_amount"/>
		<result property="gbDpgWeightId" column="gb_DPG_weight_id"/>
		<result property="gbDpgDisGoodsId" column="gb_DPG_dis_goods_id"/>
		<result property="gbDpgDisGoodsFatherId" column="gb_DPG_dis_goods_father_id"/>
		<result property="gbDpgQuantity" column="gb_DPG_quantity"/>
		<result property="gbDpgStandard" column="gb_DPG_standard"/>
		<result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
		<result property="gbDpgStatus" column="gb_DPG_status"/>
		<result property="gbDpgBuyPrice" column="gb_DPG_buy_price"/>
		<result property="gbDpgBuyScalePrice" column="gb_Dpg_buy_scale_price"/>
		<result property="gbDpgBuyScaleQuantity" column="gb_Dpg_buy_scale_quantity"/>
		<result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
		<result property="gbDpgBuyQuantity" column="gb_DPG_buy_quantity"/>
		<result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
		<result property="gbDpgPayType" column="gb_DPG_pay_type"/>
		<result property="gbDpgOrdersAmount" column="gb_DPG_orders_amount"/>
		<result property="gbDpgTypeAddUserId" column="gb_DPG_type_add_user_id"/>
		<result property="gbDpgInputType" column="gb_DPG_input_type"/>
		<result property="gbDpgTime" column="gb_DPG_time"/>
		<result property="gbDpgDistributerId" column="gb_DPG_distributer_id"/>
		<result property="gbDpgInputType" column="gb_DPG_input_type"/>
		<result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
		<result property="gbDpgPayType" column="gb_DPG_pay_type"/>
		<result property="gbDpgPurchaseFullTime" column="gb_DPG_purchase_full_time"/>
		<result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
		<result property="gbDpgPurchaseMonth" column="gb_DPG_purchase_month"/>
		<result property="gbDpgPurchaseDate" column="gb_DPG_purchase_date"/>
		<result property="gbDpgPurchaseYear" column="gb_DPG_purchase_year"/>
		<result property="gbDpgDisGoodsPriceId" column="gb_DPG_dis_goods_price_id"/>
		<result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
		<result property="gbDpgPurchaseDepartmentId" column="gb_DPG_purchase_department_id"/>
		<result property="gbDpgPurchaseWeek" column="gb_DPG_purchase_week"/>
		<result property="gbDpgPurchaseWeekYear" column="gb_DPG_purchase_week_year"/>
		<result property="gbDpgBatchId" column="gb_DPG_batch_id"/>
		<result property="gbDpgBuyScaleQuantity" column="gb_DPG_buy_scale_quantity"/>
		<result property="gbDpgBuyScale" column="gb_DPG_buy_scale"/>
		<result property="gbDpgBuyScalePrice" column="gb_DPG_buy_scale_price"/>
		<result property="gbDpgBuyPriceReason" column="gb_DPG_buy_price_reason"/>
		<result property="gbDpgWarnFullTime" column="gb_DPG_warn_full_time"/>
		<result property="gbDpgWasteFullTime" column="gb_DPG_waste_full_time"/>
	</resultMap>

    <resultMap id="disGoods" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
		<result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
		<result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgGbSupplierId" column="gb_dg_gb_supplier_id"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
    </resultMap>
    <resultMap id="purUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="gb_department_user_id"/>
		<result property="gbDuLoginTimes" column="gb_DU_login_times"/>
		<result property="gbDuCustomerService" column="gb_DU_customer_service"/>
        <result property="gbDuWxNickName" column="gb_DU_wx_nick_name"/>
        <result property="gbDuWxAvartraUrl" column="gb_DU_wx_avartra_url"/>
        <result property="gbDuWxPhone" column="gb_DU_wx_phone"/>
        <result property="gbDuPrintDeviceId" column="gb_DU_print_device_id"/>
        <result property="gbDuPrintBillDeviceId" column="gb_DU_print_bill_device_id"/>
    </resultMap>

    <resultMap id="purGoods" type="GbDistributerPurchaseGoodsEntity">

		<id property="gbDistributerPurchaseGoodsId" column="gb_distributer_purchase_goods_id"/>
		<result property="gbDpgPurchaseNxDistributerId" column="gb_DPG_purchase_nx_distributer_id"/>
        <result property="gbDpgOrdersFinishAmount" column="gb_DPG_orders_finish_amount"/>
        <result property="gbDpgWeightId" column="gb_DPG_weight_id"/>
        <result property="gbDpgDisGoodsId" column="gb_DPG_dis_goods_id"/>
        <result property="gbDpgDisGoodsFatherId" column="gb_DPG_dis_goods_father_id"/>
        <result property="gbDpgQuantity" column="gb_DPG_quantity"/>
        <result property="gbDpgStandard" column="gb_DPG_standard"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgStatus" column="gb_DPG_status"/>
        <result property="gbDpgBuyPrice" column="gb_DPG_buy_price"/>
        <result property="gbDpgBuyScalePrice" column="gb_Dpg_buy_scale_price"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_Dpg_buy_scale_quantity"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgBuyQuantity" column="gb_DPG_buy_quantity"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgOrdersAmount" column="gb_DPG_orders_amount"/>
        <result property="gbDpgTypeAddUserId" column="gb_DPG_type_add_user_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgTime" column="gb_DPG_time"/>
        <result property="gbDpgDistributerId" column="gb_DPG_distributer_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgPurchaseFullTime" column="gb_DPG_purchase_full_time"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgPurchaseMonth" column="gb_DPG_purchase_month"/>
        <result property="gbDpgPurchaseDate" column="gb_DPG_purchase_date"/>
        <result property="gbDpgPurchaseYear" column="gb_DPG_purchase_year"/>
        <result property="gbDpgDisGoodsPriceId" column="gb_DPG_dis_goods_price_id"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgPurchaseDepartmentId" column="gb_DPG_purchase_department_id"/>
        <result property="gbDpgPurchaseWeek" column="gb_DPG_purchase_week"/>
        <result property="gbDpgPurchaseWeekYear" column="gb_DPG_purchase_week_year"/>
        <result property="gbDpgBatchId" column="gb_DPG_batch_id"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_DPG_buy_scale_quantity"/>
        <result property="gbDpgBuyScale" column="gb_DPG_buy_scale"/>
        <result property="gbDpgBuyScalePrice" column="gb_DPG_buy_scale_price"/>
        <result property="gbDpgBuyPriceReason" column="gb_DPG_buy_price_reason"/>
        <result property="gbDpgWarnFullTime" column="gb_DPG_warn_full_time"/>
        <result property="gbDpgWasteFullTime" column="gb_DPG_waste_full_time"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
    </resultMap>

    <resultMap id="priceGoods" type="GbDistributerGoodsPriceEntity">
        <id property="gbDistributerGoodsPriceId" column="gb_distributer_goods_price_id"/>
        <result property="gbDgpDfgGoodsFatherId" column="gb_dpg_dfg_goods_father_id"/>
        <result property="gbDgpDistributerGoodsId" column="gb_dgp_distributer_goods_id"/>
        <result property="gbDgpGoodsPrice" column="gb_dgp_goods_price"/>
        <result property="gbDgpGoodsLowestPrice" column="gb_dgp_goods_lowest_price"/>
        <result property="gbDgpGoodsHighestPrice" column="gb_dgp_goods_highest_price"/>
        <result property="gbDgpDistributerId" column="gb_dgp_distributer_id"/>
        <result property="gbDgpPurDate" column="gb_dgp_pur_date"/>
        <result property="gbDgpPurGoodsId" column="gb_dgp_pur_goods_id"/>
        <result property="gbDgpPurUserId" column="gb_dgp_pur_user_id"/>
        <result property="gbDgpPurScale" column="gb_dgp_pur_scale"/>
        <result property="gbDgpPurWhatTotal" column="gb_dgp_pur_what_total"/>
        <result property="gbDgpPurWhat" column="gb_dgp_pur_what"/>
        <result property="gbDgpPurPrice" column="gb_dgp_pur_price"/>
        <association property="gbDisPurGoodsEntity" resultMap="purGoods"/>
        <association property="gbDepUserEntity" resultMap="purUser"/>
    </resultMap>

    <resultMap id="purGoodsa" type="GbDistributerPurchaseGoodsEntity">

		<id property="gbDistributerPurchaseGoodsId" column="gb_distributer_purchase_goods_id"/>
		<result property="gbDpgPurchaseNxDistributerId" column="gb_DPG_purchase_nx_distributer_id"/>
        <result property="gbDpgOrdersFinishAmount" column="gb_DPG_orders_finish_amount"/>
        <result property="gbDpgWeightId" column="gb_DPG_weight_id"/>
        <result property="gbDpgDisGoodsId" column="gb_DPG_dis_goods_id"/>
        <result property="gbDpgDisGoodsFatherId" column="gb_DPG_dis_goods_father_id"/>
        <result property="gbDpgQuantity" column="gb_DPG_quantity"/>
        <result property="gbDpgStandard" column="gb_DPG_standard"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgStatus" column="gb_DPG_status"/>
        <result property="gbDpgBuyPrice" column="gb_DPG_buy_price"/>
        <result property="gbDpgBuyScalePrice" column="gb_Dpg_buy_scale_price"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_Dpg_buy_scale_quantity"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgBuyQuantity" column="gb_DPG_buy_quantity"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgOrdersAmount" column="gb_DPG_orders_amount"/>
        <result property="gbDpgTypeAddUserId" column="gb_DPG_type_add_user_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgTime" column="gb_DPG_time"/>
        <result property="gbDpgDistributerId" column="gb_DPG_distributer_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgPurchaseFullTime" column="gb_DPG_purchase_full_time"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgPurchaseMonth" column="gb_DPG_purchase_month"/>
        <result property="gbDpgPurchaseDate" column="gb_DPG_purchase_date"/>
        <result property="gbDpgPurchaseYear" column="gb_DPG_purchase_year"/>
        <result property="gbDpgDisGoodsPriceId" column="gb_DPG_dis_goods_price_id"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgPurchaseDepartmentId" column="gb_DPG_purchase_department_id"/>
        <result property="gbDpgPurchaseWeek" column="gb_DPG_purchase_week"/>
        <result property="gbDpgPurchaseWeekYear" column="gb_DPG_purchase_week_year"/>
        <result property="gbDpgBatchId" column="gb_DPG_batch_id"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_DPG_buy_scale_quantity"/>
        <result property="gbDpgBuyScale" column="gb_DPG_buy_scale"/>
        <result property="gbDpgBuyScalePrice" column="gb_DPG_buy_scale_price"/>
        <result property="gbDpgBuyPriceReason" column="gb_DPG_buy_price_reason"/>
        <result property="gbDpgWarnFullTime" column="gb_DPG_warn_full_time"/>
        <result property="gbDpgWasteFullTime" column="gb_DPG_waste_full_time"/>
    </resultMap>

    <select id="queryPriceGoodsListByParams" resultMap="priceGoods">
        select * from gb_distributer_goods_price as dgp
        left join gb_distributer_purchase_goods as pg on pg.gb_distributer_purchase_goods_id = dgp.gb_dgp_pur_goods_id
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = pg.gb_DPG_dis_goods_id
        left join gb_department_user as du on du.gb_department_user_id = dgp.gb_dgp_pur_user_id
        <where>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>
        order by dgp.gb_dgp_pur_what_total
    </select>


    <select id="queryPriceWhatTotal" resultType="java.lang.Double">
        select sum(gb_dgp_pur_what_total) from gb_distributer_goods_price as gdgp
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgp.gb_dgp_distributer_goods_id
        <where>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>
    </select>
    <select id="queryPriceWhatAmount" resultType="java.lang.Integer">
        select count(*) from gb_distributer_goods_price as gdgp
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgp.gb_dgp_distributer_goods_id
        <where>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>

            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>

            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>


        </where>
    </select>

    <resultMap id="fatherGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="gb_dfg_father_goods_color"/>
        <collection property="gbDistributerGoodsEntities" resultMap="disGoods"/>
    </resultMap>
    <resultMap id="grandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGrant_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGrant_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGrant_gb_dfg_father_goods_name"/>
        <collection property="fatherGoodsEntities" resultMap="fatherGoods"/>
    </resultMap>

    <resultMap id="greatGrandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGreatGrand_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGreatGrand_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGreatGrand_gb_dfg_father_goods_name"/>
        <collection property="fatherGoodsEntities" resultMap="grandGoods"/>
    </resultMap>

    <select id="queryTreePriceGoodsList" resultMap="greatGrandGoods">
        select * ,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGrant.gb_dfg_father_goods_color 'ndfgGrant_gb_dfg_father_goods_color',
        ndfgGrant.gb_dfg_father_goods_level 'ndfgGrant_gb_dfg_father_goods_level',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_level 'ndfgGreatGrand_gb_dfg_father_goods_level'
        from gb_distributer_goods_price as gdgp
        left join gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgp.gb_dgp_dfg_goods_father_id
        left join gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgp.gb_dgp_distributer_goods_id
        <where>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>

            <if test="mdIds != null">
                and gb_dgp_pur_department_id in
                <foreach item="id" collection="mdIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryPurTotal" resultType="java.lang.Double">
        select sum(gdgp.gb_dgp_pur_total) from gb_distributer_goods_price as gdgp
        <where>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>
    </select>
    <select id="queryPriceHighestTotal" resultType="java.lang.Double">
        select sum(gdgp.gb_dgp_goods_highest_total) from gb_distributer_goods_price as gdgp
        <where>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>

        </where>
    </select>
    <select id="queryPriceLowestTotal" resultType="java.lang.Double">
        select sum(gdgp.gb_dgp_goods_lowest_total) from gb_distributer_goods_price as gdgp
        <where>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>

    </select>
    <select id="queryDisPriceGoodsCount" resultType="java.lang.Integer">
        select COUNT(*) from gb_distributer_goods_price as gdgp
        <where>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>
    </select>
    <select id="queryPriceWhatScale" resultType="java.lang.Double">
        select sum(gdgp.gb_dgp_pur_scale) from gb_distributer_goods_price as gdgp
        <where>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>
    </select>
    <select id="queryTreeSetDisGoods" resultMap="disGoodsWithGoodsPrice">
        select * from gb_distributer_goods_price as gdgp
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgp.gb_dgp_distributer_goods_id
        <where>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>
            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>
    </select>
    <select id="queryPricePurWeight" resultType="java.lang.Double">
        select sum(gdgp.gb_dgp_pur_weight) from gb_distributer_goods_price as gdgp
        <where>
            <if test="disId != null">
                and gb_dgp_distributer_id = #{disId}
            </if>
             <if test="depId != null">
                and gb_dgp_pur_department_id = #{depId}
            </if>
            <if test="nxDisId != null">
                and gb_dgp_pur_nx_distributer_id = #{nxDisId}
            </if>

            <if test="week != null">
                and gb_dgp_week = #{week}
            </if>
            <if test="status != null">
                and gb_dgp_status &lt; #{status}
            </if>
            <if test="purWhat != null">
                and gb_dgp_pur_what = #{purWhat}
            </if>
            <if test="date != null">
                and gb_dgp_pur_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgp_pur_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgp_pur_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgp_dfg_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgp_distributer_goods_id = #{disGoodsId}
            </if>
        </where>
    </select>
    <select id="queryItemByPurGoodsId" resultType="com.nongxinle.entity.GbDistributerGoodsPriceEntity">
        select *
        from gb_distributer_goods_price where  gb_dgp_pur_goods_id = #{purchaseGoodsId};
    </select>


    <insert id="save" parameterType="com.nongxinle.entity.GbDistributerGoodsPriceEntity" useGeneratedKeys="true"
            keyProperty="gbDistributerGoodsPriceId">
        insert into gb_distributer_goods_price
        (`gb_distributer_goods_price_id`,
         `gb_dgp_dfg_goods_father_id`,
         `gb_dgp_distributer_goods_id`,
         `gb_dgp_distributer_id`,
         `gb_dgp_goods_price`,
         `gb_dgp_goods_lowest_price`,
         `gb_dgp_goods_highest_price`,
         `gb_dgp_pur_goods_id`,
         `gb_dgp_pur_user_id`,
         `gb_dgp_pur_date`,
         `gb_dgp_pur_price`,
         `gb_dgp_pur_what`,
         `gb_dgp_pur_scale`,
         `gb_dgp_pur_what_total`,
         `gb_dgp_pur_department_id`,
         `gb_dgp_status`,
         `gb_dgp_week`,
         `gb_dgp_month`,
         `gb_dgp_year`,
         `gb_dgp_pur_total`,
         `gb_dgp_goods_lowest_total`,
         `gb_dgp_goods_highest_total`,
         `gb_dgp_pur_weight`,
         `gb_dgp_pur_nx_distributer_id`
         )
        values (#{gbDistributerGoodsPriceId},
                #{gbDgpDfgGoodsFatherId},
                #{gbDgpDistributerGoodsId},
                #{gbDgpDistributerId},
                #{gbDgpGoodsPrice},
                #{gbDgpGoodsLowestPrice},
                #{gbDgpGoodsHighestPrice},
                #{gbDgpPurGoodsId},
                #{gbDgpPurUserId},
                #{gbDgpPurDate},
                #{gbDgpPurPrice},
                #{gbDgpPurWhat},
                #{gbDgpPurScale},
                #{gbDgpPurWhatTotal},
                #{gbDgpPurDepartmentId},
                #{gbDgpStatus},
                #{gbDgpWeek},
                #{gbDgpMonth},
                #{gbDgpYear},
                #{gbDgpPurTotal},
                #{gbDgpGoodsLowestTotal},
                #{gbDgpGoodsHighestTotal},
                #{gbDgpPurWeight},
                #{gbDgpPurNxDistributerId}
                )
    </insert>

    <update id="update" parameterType="com.nongxinle.entity.GbDistributerGoodsPriceEntity">
        update gb_distributer_goods_price
        <set>
            <if test="gbDgpDfgGoodsFatherId != null">`gb_dgp_dfg_goods_father_id` = #{gbDgpDfgGoodsFatherId},</if>
            <if test="gbDgpDistributerGoodsId != null">`gb_dgp_distributer_goods_id` = #{gbDgpDistributerGoodsId},</if>
            <if test="gbDgpDistributerId != null">`gb_dgp_distributer_id` = #{gbDgpDistributerId},</if>
            <if test="gbDgpGoodsPrice != null">`gb_dgp_goods_price` = #{gbDgpGoodsPrice},</if>
            <if test="gbDgpGoodsLowestPrice != null">`gb_dgp_goods_lowest_price` = #{gbDgpGoodsLowestPrice},</if>
            <if test="gbDgpGoodsHighestPrice != null">`gb_dgp_goods_highest_price` = #{gbDgpGoodsHighestPrice},</if>
            <if test="gbDgpPurGoodsId != null">`gb_dgp_pur_goods_id` = #{gbDgpPurGoodsId},</if>
            <if test="gbDgpPurUserId != null">`gb_dgp_pur_user_id` = #{gbDgpPurUserId},</if>
            <if test="gbDgpPurDate != null">`gb_dgp_pur_date` = #{gbDgpPurDate},</if>
            <if test="gbDgpPurPrice != null">`gb_dgp_pur_price` = #{gbDgpPurPrice},</if>
            <if test="gbDgpPurWhat != null">`gb_dgp_pur_what` = #{gbDgpPurWhat},</if>
            <if test="gbDgpPurScale != null">`gb_dgp_pur_scale` = #{gbDgpPurScale},</if>
            <if test="gbDgpPurDepartmentId != null">`gb_dgp_pur_department_id` = #{gbDgpPurDepartmentId},</if>
            <if test="gbDgpStatus != null">`gb_dgp_status` = #{gbDgpStatus},</if>
            <if test="gbDgpWeek != null">`gb_dgp_week` = #{gbDgpWeek},</if>
            <if test="gbDgpMonth != null">`gb_dgp_month` = #{gbDgpMonth},</if>
            <if test="gbDgpYear != null">`gb_dgp_year` = #{gbDgpYear},</if>
            <if test="gbDgpPurTotal != null">`gb_dgp_pur_total` = #{gbDgpPurTotal},</if>
            <if test="gbDgpGoodsLowestTotal != null">`gb_dgp_goods_lowest_total` = #{gbDgpGoodsLowestTotal},</if>
            <if test="gbDgpGoodsHighestTotal != null">`gb_dgp_goods_highest_total` = #{gbDgpGoodsHighestTotal},</if>
            <if test="gbDgpPurWeight != null">`gb_dgp_pur_weight` = #{gbDgpPurWeight},</if>
            <if test="gbDgpPurNxDistributerId != null">`gb_dgp_pur_nx_distributer_id` = #{gbDgpPurNxDistributerId},</if>
            <if test="gbDgpPurWhatTotal != null">`gb_dgp_pur_what_total` = #{gbDgpPurWhatTotal}</if>
        </set>
        where gb_distributer_goods_price_id = #{gbDistributerGoodsPriceId}
    </update>

    <delete id="delete">
        delete
        from gb_distributer_goods_price
        where gb_distributer_goods_price_id = #{value}
    </delete>

    <delete id="deleteBatch">
        delete from gb_distributer_goods_price where gb_distributer_goods_price_id in
        <foreach item="gbDistributerGoodsPriceId" collection="array" open="(" separator="," close=")">
            #{gbDistributerGoodsPriceId}
        </foreach>
    </delete>

</mapper>