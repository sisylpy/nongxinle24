<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.nongxinle.dao.GbDepartmentGoodsStockDao">

    <select id="queryObject" resultType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">
        select *
        from gb_department_goods_stock
        where gb_department_goods_stock_id = #{value}
    </select>

    <select id="queryList" resultType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">
        select * from gb_department_goods_stock
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="queryTotal" resultType="int">
        select count(*)
        from gb_department_goods_stock
    </select>


    <resultMap id="fromDepStock" type="GbDepartmentGoodsStockEntity">
        <id property="gbDepartmentGoodsStockId" column="from_gb_department_goods_stock_id"/>
        <result property="gbDgsAfterProfitSubtotal" column="from_gb_dgs_sales_profit_subtotal"/>
        <result property="gbDgsSellingPrice" column="from_gb_dgs_selling_price"/>
        <result property="gbDgsGbDisGoodsId" column="from_gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDisGoodsFatherId" column="from_gb_dgs_gb_dis_goods_father_id"/>
        <result property="gbDgsGbDistributerId" column="from_gb_dgs_gb_distributer_id"/>
        <result property="gbDgsPrice" column="from_gb_dgs_price"/>
        <result property="gbDgsWeight" column="from_gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="from_gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="from_gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="from_gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="from_gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="from_gb_dgs_produce_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="from_gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="from_gb_dgs_department_father_id"/>
        <result property="gbDgsStatus" column="from_gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="from_gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="from_gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="from_gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="from_gb_dgs_date"/>
        <result property="gbDgsWarnFullTime" column="from_gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="from_gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="from_gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="from_gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="from_gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="from_gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="from_gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="from_gb_dgs_return_subtotal"/>
        <result property="gbDgsGbDepDisGoodsId" column="from_gb_dgs_gb_dep_dis_goods_id"/>
        <result property="gbDgsWarnTimeQuantumName" column="from_gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="from_gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="from_gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="from_gb_dgs_gb_price_goods_id"/>
    </resultMap>
    <resultMap id="gbDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
        <result property="gbDepartmentPrintName" column="gb_department_print_name"/>
    </resultMap>
    <resultMap id="fatherDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="orderFatherDep_gb_department_id"/>
        <result property="gbDepartmentName" column="orderFatherDep_gb_department_name"/>

    </resultMap>

    <resultMap id="orderDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="orderDep_gb_department_id"/>
        <result property="gbDepartmentName" column="orderDep_gb_department_name"/>
        <result property="gbDepartmentFatherId" column="orderDep_gb_department_father_id"/>
        <association property="fatherGbDepartmentEntity" resultMap="fatherDep"/>
    </resultMap>

    <resultMap id="applys" type="GbDepartmentOrdersEntity">
        <id property="gbDepartmentOrdersId" column="gb_department_orders_id"/>
        <result property="gbDoSellingPrice" column="gb_DO_selling_price"/>
        <result property="gbDoSellingSubtotal" column="gb_DO_selling_subtotal"/>
        <result property="gbDoNxGoodsId" column="gb_DO_nx_goods_id"/>
        <result property="gbDoOrderUserId" column="gb_DO_order_user_id"/>
        <result property="gbDoApplyDate" column="gb_DO_apply_date"/>
        <result property="gbDoApplyOnlyTime" column="gb_DO_apply_only_time"/>
        <result property="gbDoApplyFullTime" column="gb_DO_apply_full_time"/>
        <result property="gbDoArriveOnlyDate" column="gb_DO_arrive_only_date"/>
        <result property="gbDoArriveDate" column="gb_DO_arrive_date"/>
        <result property="gbDoArriveWhatDay" column="gb_DO_arrive_what_day"/>
        <result property="gbDoQuantity" column="gb_DO_quantity"/>
        <result property="gbDoStandard" column="gb_DO_standard"/>
        <result property="gbDoDsStandardScale" column="gb_DO_ds_standard_scale"/>
        <result property="gbDoDsStandardId" column="gb_DO_ds_standard_id"/>
        <result property="gbDoRemark" column="gb_DO_remark"/>
        <result property="gbDoStatus" column="gb_DO_status"/>
        <result property="gbDoWeight" column="gb_DO_weight"/>
        <result property="gbDoScaleWeight" column="gb_DO_scale_weight"/>
        <result property="gbDoScalePrice" column="gb_DO_scale_price"/>
        <result property="gbDoPrice" column="gb_DO_price"/>
        <result property="gbDoSubtotal" column="gb_DO_subtotal"/>
        <result property="gbDoBuyStatus" column="gb_DO_buy_status"/>
        <result property="gbDoNxGoodsFatherId" column="gb_DO_nx_goods_father_id"/>
        <result property="gbDoDepartmentFatherId" column="gb_DO_department_father_id"/>
        <result property="gbDoDisGoodsId" column="gb_DO_dis_goods_id"/>
        <result property="gbDoDepDisGoodsId" column="gb_DO_dep_dis_goods_id"/>
        <result property="gbDoDisGoodsFatherId" column="gb_DO_dis_goods_father_id"/>
        <result property="gbDoDepartmentId" column="gb_DO_department_id"/>
        <result property="gbDoDistributerId" column="gb_DO_distributer_id"/>
        <result property="gbDoBuyStatus" column="gb_DO_buy_status"/>
        <result property="gbDoGoodsType" column="gb_DO_goods_type"/>
        <result property="gbDoDgsrReturnId" column="gb_DO_dgsr_return_id"/>
        <result property="gbDoOperationTime" column="gb_DO_operation_time"/>
        <result property="gbDoIsAgent" column="gb_DO_is_agent"/>
        <result property="gbDoPurchaseGoodsId" column="gb_DO_purchase_goods_id"/>
        <result property="gbDoDepDisGoodsId" column="gb_DO_dep_dis_goods_id"/>
        <result property="gbDoGoodsType" column="gb_DO_goods_type"/>
        <result property="gbDoDgsrReturnId" column="gb_DO_dgsr_return_id"/>
        <result property="gbDoNxDepartmentOrderId" column="gb_DO_nx_department_order_id"/>
        <result property="gbDoNxDistributerId" column="gb_DO_distributer_id"/>
        <result property="gbDoNxDistributerGoodsId" column="gb_DO_nx_distributer_goods_id"/>
        <result property="gbDoToDepartmentId" column="gb_DO_to_department_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_receive_user_id"/>
        <result property="gbDoOrderType" column="gb_DO_order_type"/>
        <result property="gbDoBillId" column="gb_DO_bill_id"/>
        <result property="gbDoPurchaseUserId" column="gb_DO_purchase_user_id"/>
        <result property="gbDoPickUserId" column="gb_DO_pick_user_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_return_user_id"/>
        <result property="gbDoWeightTotalId" column="gb_DO_weight_total_id"/>
        <result property="gbDoWeightGoodsId" column="gb_DO_weight_goods_id"/>
        <result property="gbDoPriceDifferent" column="gb_DO_price_different"/>
        <association property="gbDepartmentUserEntity" resultMap="orderUser"/>
        <association property="pickerUserEntity" resultMap="pickerUser"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
        <association property="receiveUserEntity" resultMap="receUser"/>
        <association property="orderDepartment" resultMap="orderDep"/>
        <collection property="goodsStockEntityList" resultMap="depStock"/>
    </resultMap>

    <resultMap id="orderUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="gb_department_user_id"/>
		<result property="gbDuLoginTimes" column="gb_DU_login_times"/>
        <result property="gbDuCustomerService" column="gb_DU_customer_service"/>
        <result property="gbDuWxNickName" column="gb_DU_wx_nick_name"/>
        <result property="gbDuWxAvartraUrl" column="gb_DU_wx_avartra_url"/>
        <result property="gbDuUrlChange" column="gb_DU_url_change"/>
        <result property="gbDuPrintDeviceId" column="gb_DU_print_device_id"/>
        <result property="gbDuPrintBillDeviceId" column="gb_DU_print_bill_device_id"/>
    </resultMap>
    <resultMap id="pickerUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="pickerUser_gb_department_user_id"/>
        <result property="gbDuWxNickName" column="pickerUser_gb_DU_wx_nick_name"/>
        <result property="gbDuWxAvartraUrl" column="pickerUser_gb_DU_wx_avartra_url"/>
        <result property="gbDuUrlChange" column="pickerUser_gb_DU_url_change"/>
        <result property="gbDuPrintDeviceId" column="pickerUser_gb_DU_print_device_id"/>
        <result property="gbDuPrintBillDeviceId" column="pickerUser_gb_DU_print_bill_device_id"/>
    </resultMap>
    <resultMap id="receUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="recUser_gb_department_user_id"/>
        <result property="gbDuWxNickName" column="recUser_gb_DU_wx_nick_name"/>
    </resultMap>
    <resultMap id="stockUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="stockUser_gb_department_user_id"/>
        <result property="gbDuWxNickName" column="stockUser_gb_DU_wx_nick_name"/>
    </resultMap>

    <resultMap id="depStock" type="GbDepartmentGoodsStockEntity">
        <id property="gbDepartmentGoodsStockId" column="gb_department_goods_stock_id"/>
        <result property="gbDgsProduceSellingSubtotal" column="gb_dgs_produce_selling_subtotal"/>
        <result property="gbDgsNxDistributerId" column="gb_dgs_nx_distributer_id"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsAfterProfitSubtotal" column="gb_dgs_after_profit_subtotal"/>
        <result property="gbDgsBetweenPrice" column="gb_dgs_between_price"/>
        <result property="gbDgsProfitWeight" column="gb_dgs_profit_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsWasteWeight" column="gb_dgs_waste_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsRestWeightShowStandard" column="gb_dgs_rest_weight_show_standard"/>
        <result property="gbDgsRestWeightShowStandardName" column="gb_dgs_rest_weight_show_standard_name"/>
        <result property="gbDgsGbDisGoodsId" column="gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbDisGoodsFatherId" column="gb_dgs_gb_dis_goods_father_id"/>
        <result property="gbDgsGbDepDisGoodsId" column="gb_dgs_gb_dep_dis_goods_id"/>
        <result property="gbDgsPrice" column="gb_dgs_price"/>
        <result property="gbDgsWeight" column="gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="gb_dgs_produce_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="gb_dgs_gb_department_father_id"/>
        <result property="gbDgsGbFromDepartmentId" column="gb_dgs_gb_from_department_id"/>
        <result property="gbDgsStatus" column="gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="gb_dgs_date"/>
        <result property="gbDgsInventoryDate" column="gb_dgs_inventory_date"/>
        <result property="gbDgsInventoryFullTime" column="gb_dgs_inventory_full_time"/>
        <result property="gbDgsInventoryWeek" column="gb_dgs_inventory_week"/>
        <result property="gbDgsInventoryMonth" column="gb_dgs_inventory_month"/>
        <result property="gbDgsWarnFullTime" column="gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="gb_dgs_return_subtotal"/>
        <result property="gbDgsWarnTimeQuantumName" column="gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="gb_dgs_gb_price_goods_id"/>
        <result property="gbDgsGbPriceSubtotal" column="gb_dgs_gb_price_subtotal"/>
        <result property="gbDgsOutFullTime" column="gb_dgs_out_full_time"/>
        <association property="fromDepStockEntity" resultMap="fromDepStock"/>
        <association property="gbDepartmentEntity" resultMap="gbDep"/>
        <association property="stockUserEntity" resultMap="stockUser"/>
        <association property="gbDepartmentOrdersEntity" resultMap="applys"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoodsDetail"/>
        <collection property="goodsStockReduceEntityList" resultMap="reduce"/>
    </resultMap>

    <resultMap id="disGoods" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
		<result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
		<result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgGoodsType" column="gb_dg_goods_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="depStock"/>
    </resultMap>

    <resultMap id="disGoodsDetail" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
		<result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
		<result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
    </resultMap>

    <select id="queryGoodsStockByParams" resultMap="depStock">
        select * ,
        gdu.gb_department_user_id, gdu.gb_DU_admin,gdu.gb_DU_wx_avartra_url, gdu.gb_DU_wx_nick_name,
        recUser.gb_department_user_id 'recUser_gb_department_user_id',
        recUser.gb_DU_wx_nick_name 'recUser_gb_DU_wx_nick_name',
        pickerUser.gb_department_user_id 'pickerUser_gb_department_user_id',
        pickerUser.gb_DU_wx_nick_name 'pickerUser_gb_DU_wx_nick_name',
        stockUser.gb_department_user_id 'stockUser_gb_department_user_id',
        stockUser.gb_DU_wx_nick_name 'stockUser_gb_DU_wx_nick_name',

        fromgdgs.gb_department_goods_stock_id 'from_gb_department_goods_stock_id',
        fromgdgs.gb_dgs_gb_department_order_id 'from_gb_dgs_gb_department_order_id',
        fromgdgs.gb_dgs_gb_dis_goods_id 'from_gb_dgs_gb_dis_goods_id',
        fromgdgs.gb_dgs_gb_dis_goods_father_id 'from_gb_dgs_gb_dis_goods_father_id',
        fromgdgs.gb_dgs_gb_distributer_id 'from_gb_dgs_gb_distributer_id',
        fromgdgs.gb_dgs_gb_department_id 'from_gb_dgs_gb_department_id',
        fromgdgs.gb_dgs_price 'from_gb_dgs_price',
        fromgdgs.gb_dgs_weight 'from_gb_dgs_weight',
        fromgdgs.gb_dgs_price 'from_gb_dgs_price',
        fromgdgs.gb_dgs_subtotal 'from_gb_dgs_subtotal',
        fromgdgs.gb_dgs_rest_weight 'from_gb_dgs_rest_weight',
        fromgdgs.gb_dgs_rest_subtotal 'from_gb_dgs_rest_subtotal',
        fromgdgs.gb_dgs_status 'from_gb_dgs_status',
        fromgdgs.gb_dgs_gb_goods_stock_id 'from_gb_dgs_gb_goods_stock_id',
        fromgdgs.gb_dgs_receive_user_id 'from_gb_dgs_receive_user_id',
        fromgdgs.gb_dgs_date 'from_gb_dgs_date',
        fromgdgs.gb_dgs_gb_dep_dis_goods_id 'from_gb_dgs_gb_dep_dis_goods_id',
        fromgdgs.gb_dgs_selling_price 'from_gb_dgs_selling_price',
        fromgdgs.gb_dgs_selling_subtotal 'from_gb_dgs_selling_subtotal',
        orderDep.gb_department_id 'orderDep_gb_department_id',
        orderDep.gb_department_name 'orderDep_gb_department_name',
        orderDep.gb_department_father_id 'orderDep_gb_department_father_id' ,
        orderFatherDep.gb_department_id 'orderFatherDep_gb_department_id',
        orderFatherDep.gb_department_name 'orderFatherDep_gb_department_name'

        from gb_department_goods_stock as gdgs
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        left join gb_department_goods_stock as fromgdgs on fromgdgs.gb_department_goods_stock_id =
        gdgs.gb_dgs_gb_goods_stock_id
        left join gb_department_orders as dor on dor.gb_department_orders_id = gdgs.gb_dgs_gb_department_order_id
        left join gb_department_user as gdu on gdu.gb_department_user_id = dor.gb_DO_order_user_id
        left join gb_department_user as recUser on recUser.gb_department_user_id = dor.gb_DO_receive_user_id
        left join gb_department_user as stockUser on stockUser.gb_department_user_id = gdgs.gb_dgs_receive_user_id

        left join gb_department_user as pickerUser on pickerUser.gb_department_user_id = dor.gb_DO_pick_user_id
        left join gb_department as fromDep on fromDep.gb_department_id = dor.gb_DO_to_department_id
        left join gb_department as orderDep on orderDep.gb_department_id = dor.gb_DO_department_id
        left join gb_department as orderFatherDep on orderFatherDep.gb_department_id = dor.gb_DO_department_father_id
        <where>
            <if test="disId != null">
                and gdgs.gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="businessDisGoodsId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId} and gdgs.gb_dgs_gb_dis_goods_id = #{businessDisGoodsId}
                or gdgs.gb_dgs_gb_from_department_id = #{depId} and gdgs.gb_dgs_gb_dis_goods_id = #{businessDisGoodsId}
            </if>
            <if test="startTime != null">
                and gdgs.gb_dgs_full_time &gt;= #{startTime}
            </if>
            <if test="stopTime != null">
                and gdgs.gb_dgs_full_time &lt;= #{stopTime}
            </if>
            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="stockDepId != null">
                and gdgs.gb_dgs_gb_department_id = #{stockDepId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="disGoodsId != null">
                and gdgs.gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>

            <if test="depGoodsId != null">
                and gdgs.gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="orderId != null">
                and gdgs.gb_dgs_gb_department_order_id = #{orderId}
            </if>
            <if test="status != null">
                and gdgs.gb_dgs_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and gdgs.gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>
            <if test="startDate != null">
                and gdgs.gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gdgs.gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="equalOutDate != null">
                and gdgs.gb_dgs_out_date = #{equalOutDate}
            </if>


            <if test="wasteTime != null">
                and gdgs.gb_dgs_waste_full_time &lt; #{wasteTime}
            </if>
            <if test="warnTime != null">
                and gdgs.gb_dgs_warn_full_time &lt; #{warnTime}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
            <if test="dayuWasteTime != null">
                and gdgs.gb_dgs_waste_full_time &gt; #{dayuWasteTime}
            </if>
            <if test="depType != null">
                and orderFatherDep.gb_department_type = #{depType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
        order by orderFatherDep.gb_department_id , gdgs.gb_dgs_full_time

    </select>

    <select id="queryDisGoodsStockByParams" resultMap="disGoods">
        select * from gb_distributer_goods as dg
        left join gb_department_goods_stock as gdgs on gdgs.gb_dgs_gb_dis_goods_id = dg.gb_distributer_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="toDepId != null">
                gdgs.gb_dgs_gb_department_id = #{toDepId}
            </if>
            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>

            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_DGS_rest_weight &gt; #{restWeight}
            </if>
            <if test="loss != null">
                and gdgs.gb_DGS_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgs.gb_DGS_waste_weight &gt; #{waste}
            </if>
            <if test="return != null">
                and gdgs.gb_DGS_return_weight &gt; #{return}
            </if>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>

    </select>
    <select id="queryDisGoodsStockDetailByParams" resultMap="depStock">
        select * ,
        fromgdgs.gb_department_goods_stock_id 'from_gb_department_goods_stock_id',
        fromgdgs.gb_dgs_gb_department_order_id 'from_gb_dgs_gb_department_order_id',
        fromgdgs.gb_dgs_gb_dis_goods_id 'from_gb_dgs_gb_dis_goods_id',
        fromgdgs.gb_dgs_gb_distributer_id 'from_gb_dgs_gb_distributer_id',
        fromgdgs.gb_dgs_gb_department_id 'from_gb_dgs_gb_department_id',
        fromgdgs.gb_dgs_price 'from_gb_dgs_price',
        fromgdgs.gb_dgs_weight 'from_gb_dgs_weight',
        fromgdgs.gb_dgs_price 'from_gb_dgs_price',
        fromgdgs.gb_dgs_subtotal 'from_gb_dgs_subtotal',
        fromgdgs.gb_dgs_rest_weight 'from_gb_dgs_rest_weight',
        fromgdgs.gb_dgs_rest_subtotal 'from_gb_dgs_rest_subtotal',
        fromgdgs.gb_dgs_status 'from_gb_dgs_status',
        fromgdgs.gb_dgs_gb_goods_stock_id 'from_gb_dgs_gb_goods_stock_id',
        fromgdgs.gb_dgs_receive_user_id 'from_gb_dgs_receive_user_id',
        fromgdgs.gb_dgs_date 'from_gb_dgs_date'

        from gb_department_goods_stock as gdgs
        left join gb_distributer_goods as dg on gdgs.gb_dgs_gb_dis_goods_id = dg.gb_distributer_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_id
        left join gb_department_goods_stock as fromgdgs on fromgdgs.gb_department_goods_stock_id =
        gdgs.gb_dgs_gb_goods_stock_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="startTime != null">
                and gdgs.gb_dgs_full_time &gt;= #{startTime}
            </if>
            <if test="stopTime != null">
                and gdgs.gb_dgs_full_time &lt; #{stopTime}
            </if>
            <if test="startDate != null">
                and gdgs.gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gdgs.gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgs.gb_dgs_date &lt;= #{notDayuStopDate}
            </if>
            <if test="dayuStatus != null">
                gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="toDepId != null">
                gdgs.gb_dgs_gb_department_id = #{toDepId}
            </if>

            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>
            <if test="week != null">
                and gdgs.gb_dgs_inventory_week &lt;= #{week}
            </if>
            <if test="month != null">
                and gdgs.gb_dgs_inventory_month &lt;= #{month}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depGoodsId != null">
                and gdgs.gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="disGoodsId != null">
                and gdgs.gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

        </where>
    </select>
    <resultMap id="fatherGoodsWithDep" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="gb_dfg_father_goods_name"/>
        <collection property="gbDepartmentDisGoodsEntities" resultMap="depGoods"/>
    </resultMap>
    <resultMap id="depGoods" type="GbDepartmentDisGoodsEntity">
        <id property="gbDepartmentDisGoodsId" column="gb_department_dis_goods_id"/>
        <result property="gbDdgGbDisId" column="gb_DDG_gb_dis_id"/>
        <result property="gbDdgDisGoodsId" column="gb_DDG_dis_goods_id"/>
        <result property="gbDdgDisGoodsFatherId" column="gb_DDG_dis_goods_father_id"/>
        <result property="gbDdgDepGoodsName" column="gb_DDG_dep_goods_name"/>
        <result property="gbDdgDepGoodsStandardname" column="gb_DDG_dep_goods_standardname"/>
        <result property="gbDdgGoodsType" column="gb_DDG_goods_type"/>
        <result property="gbDdgDepartmentId" column="gb_DDG_department_id"/>
        <result property="gbDdgNxDistributerId" column="gb_DDG_nx_distributer_id"/>
        <result property="gbDdgNxDistributerGoodsId" column="gb_DDG_nx_distributer_goods_id"/>
        <result property="gbDdgGbDepartmentId" column="gb_DDG_gb_department_id"/>
        <result property="gbDdgGbSupplierId" column="gb_DDG_gb_supplier_id"/>
        <result property="gbDdgInventoryDate" column="gb_DDG_inventory_date"/>
        <result property="gbDdgInventoryFullTime" column="gb_DDG_inventory_full_time"/>
        <result property="gbDdgStockTotalSubtotal" column="gb_DDG_stock_total_subtotal"/>
        <result property="gbDdgStockTotalWeight" column="gb_DDG_stock_total_weight"/>
        <result property="gbDdgShowStandardId" column="gb_DDG_show_standard_id"/>
        <result property="gbDdgShowStandardName" column="gb_DDG_show_standard_name"/>
        <result property="gbDdgShowStandardWeight" column="gb_DDG_show_standard_weight"/>
        <result property="gbDdgShowStandardScale" column="gb_DDG_show_standard_scale"/>
        <result property="gbDdgSellingPrice" column="gb_DDG_selling_price"/>
        <result property="gbDdgOrderDate" column="gb_DDG_order_date"/>
        <result property="gbDdgOrderPrice" column="gb_DDG_order_price"/>
        <result property="gbDdgOrderQuantity" column="gb_DDG_order_quantity"/>
        <result property="gbDdgOrderRemark" column="gb_DDG_order_remark"/>
        <result property="gbDdgOrderStandard" column="gb_DDG_order_standard"/>
        <result property="gbDdgOrderWeight" column="gb_DDG_order_weight"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="depStock"/>
    </resultMap>

    <select id="queryDepGoodsStockByParams" resultMap="fatherGoodsWithDep">
        select * from gb_department_goods_stock as gdgs
        left join gb_department_dis_goods as ddg on ddg.gb_department_dis_goods_id = gdgs.gb_dgs_gb_dep_dis_goods_id
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = ddg.gb_DDG_dis_goods_id
        left join gb_distributer_father_goods as gdfg on gdfg.gb_distributer_father_goods_id =
        dg.gb_dg_dfg_goods_father_id
         left join gb_department_goods_stock_reduce as gdgsr on gdgsr.gb_dgsr_gb_goods_stock_id = gdgs.gb_department_goods_stock_id
                                                                              and gdgsr.gb_dgsr_type = 3
        <where>
            <if test="disId != null">
                and gdgs.gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="startTime != null">
                and gdgs.gb_dgs_full_time &gt;= #{startTime}
            </if>
            <if test="stopTime != null">
                and gdgs.gb_dgs_full_time &lt; #{stopTime}
            </if>
            <if test="startDate != null">
                and gdgs.gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gdgs.gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgs.gb_dgs_date &lt;= #{notDayuStopDate}
            </if>
            <if test="inventoryDate != null">
                and gdgs.gb_dgs_inventory_date &lt;= #{inventoryDate}
            </if>
            <if test="inventoryDateEqual != null">
                and gdgs.gb_dgs_inventory_date = #{inventoryDateEqual}
            </if>


            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="toDepId != null">
                and gdgs.gb_dgs_gb_department_id = #{toDepId}
            </if>
            <if test="depId != null">
                and gdgs.gb_DGS_gb_department_id = #{depId}
            </if>
            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_DGS_rest_weight &gt; #{restWeight}
            </if>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>

            <if test="equalWeek != null">
                and gdgs.gb_dgs_inventory_week = #{equalWeek}
            </if>
            <if test="equalMonth != null">
                and gdgs.gb_dgs_inventory_month = #{equalMonth}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>


    <resultMap id="fatherGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsSort" column="gb_dfg_father_goods_sort"/>
        <collection property="gbDistributerGoodsEntities" resultMap="disGoods"/>
    </resultMap>
    <resultMap id="fatherGoodsWithStock" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="gb_dfg_father_goods_color"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="stockWithDisGoods"/>
     </resultMap>

    <select id="getDepartmentDisGoodsStock" resultMap="fatherGoods">
        select * from gb_department_goods_stock as gdgs
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        left join gb_distributer_father_goods as gdgf on gdgf.gb_distributer_father_goods_id =
        gdgs.gb_dgs_gb_dis_goods_father_id

        <where>
            <if test="disId != null">
                and gdgs.gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="startTime != null">
                and gdgs.gb_dgs_full_time &gt;= #{startTime}
            </if>
            <if test="stopTime != null">
                and gdgs.gb_dgs_full_time &lt; #{stopTime}
            </if>
            <if test="startDate != null">
                and gdgs.gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gdgs.gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>

            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>

            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
    </select>
<!--    <select id="queryDepGoodsWasteTotal" resultType="java.lang.Double">-->
<!--        select sum(gb_dgs_waste_subtotal) from gb_department_goods_stock as gdgs-->
<!--        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id-->
<!--        <where>-->
<!--            <if test="disId != null">-->
<!--                and gb_dgs_gb_distributer_id = #{disId}-->
<!--            </if>-->

<!--            <if test="stopTime != null">-->
<!--                and gb_dgs_full_time &lt; #{stopTime}-->
<!--            </if>-->
<!--            <if test="startDate != null">-->
<!--                and gb_dgs_date &gt;= #{startDate}-->
<!--            </if>-->

<!--            <if test="stopDate != null">-->
<!--                and gb_dgs_date &lt;= #{stopDate}-->
<!--            </if>-->
<!--            <if test="date != null">-->
<!--                and gb_dgs_date = #{date}-->
<!--            </if>-->

<!--            <if test="depGoodsId != null">-->
<!--                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}-->
<!--            </if>-->
<!--            <if test="disGoodsId != null">-->
<!--                and gb_dgs_gb_dis_goods_id = #{disGoodsId}-->
<!--            </if>-->
<!--            <if test="disGoodsFatherId != null">-->
<!--                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
<!--            </if>-->
<!--            <if test="depId != null">-->
<!--                and gb_dgs_gb_department_id = #{depId}-->
<!--            </if>-->
<!--            <if test="depFatherId != null">-->
<!--                and gb_dgs_gb_department_father_id = #{depFatherId}-->
<!--            </if>-->
<!--            <if test="fromDepId != null">-->
<!--                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}-->
<!--            </if>-->
<!--            <if test="notEqualStockId != null">-->
<!--                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}-->
<!--            </if>-->
<!--            <if test="stockId != null">-->
<!--                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}-->
<!--            </if>-->
<!--            <if test="nxDisId != null">-->
<!--                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}-->
<!--            </if>-->
<!--            <if test="depFatherIdNotEqual != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}-->
<!--            </if>-->
<!--            <if test="status != null">-->
<!--                and gb_dgs_status &lt; #{status}-->
<!--            </if>-->
<!--            <if test="dayuStatus != null">-->
<!--                and gb_dgs_status &gt; #{dayuStatus}-->
<!--            </if>-->
<!--            <if test="inventoryType != null">-->
<!--                and dg.gb_dg_goods_inventory_type = #{inventoryType}-->
<!--            </if>-->
<!--            <if test="dayuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="xiaoyuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="depFatherIds != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id in-->
<!--                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="restWeight != null">-->
<!--                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}-->
<!--            </if>-->
<!--        </where>-->
<!--    </select>-->

    <select id="queryGoodsStockCount" resultType="java.lang.Integer">
        select count(*) from gb_department_goods_stock as gdgs
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="isSelf != null">
                and dg.gb_dg_is_self_control = #{isSelf}
            </if>

            <if test="disId != null">
                and gdgs.gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>

            <if test="status != null">
                and gdgs.gb_dgs_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and gdgs.gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>

            <if test="startDate != null">
                and gdgs.gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gdgs.gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="disGoodsId != null">
                and gdgs.gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gdgs.gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="freshTime != null">
                and gdgs.gb_dgs_waste_full_time &lt;= #{freshTime}
            </if>

            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>

            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>

            <if test="produceWeight != null">
                and gdgs.gb_dgs_produce_weight = #{produceWeight}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>

    </select>

    <select id="queryDepGoodsRestTotal" resultType="java.lang.Double">
        select sum(gb_dgs_rest_subtotal) from gb_department_goods_stock as gdgs
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id

        <where>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>

            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>

            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="depId != null">
                and gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="status != null">
                and gb_dgs_status &lt; #{status}
            </if>
            <if test="dayuStatus != null">
                and gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
<!--            <if test="disGoodsFatherId != null">-->
<!--                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
<!--            </if>-->
            <if test="depGoodsId != null">
                and gdgs.gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="freshTime != null">
                and gb_dgs_waste_full_time &lt;= #{freshTime}
            </if>
            <if test="dayuFreshTime != null">
                and gb_dgs_waste_full_time &gt; #{dayuFreshTime}
            </if>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <resultMap id="dep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentAttrName" column="gb_department_attr_name"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
        <result property="gbDepartmentPrintName" column="gb_department_print_name"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="depStock"/>
    </resultMap>

    <select id="queryDepGoodsTreeDepartments" resultMap="dep">
        select * from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>

            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="status != null">
                and gb_dgs_status &lt; #{status}
            </if>
            <if test="dayuStatus != null">
                and gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>

            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="settleId != null and settleId == -1">
                and gdgs.gb_dgs_dep_settle_id is null
            </if>
            <if test="fromSettleId != null and fromSettleId == -1">
                and gdgs.gb_dgs_from_dep_settle_id is null
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>


        </where>
    </select>

    <resultMap id="stockWithDisGoods" type="GbDepartmentGoodsStockEntity">

        <id property="gbDepartmentGoodsStockId" column="gb_department_goods_stock_id"/>
        <result property="gbDgsProduceSellingSubtotal" column="gb_dgs_produce_selling_subtotal"/>
        <result property="gbDgsNxDistributerId" column="gb_dgs_nx_distributer_id"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsAfterProfitSubtotal" column="gb_dgs_after_profit_subtotal"/>
        <result property="gbDgsBetweenPrice" column="gb_dgs_between_price"/>
        <result property="gbDgsProfitWeight" column="gb_dgs_profit_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsRestWeightShowStandard" column="gb_dgs_rest_weight_show_standard"/>
        <result property="gbDgsRestWeightShowStandardName" column="gb_dgs_rest_weight_show_standard_name"/>
        <result property="gbDgsGbDisGoodsId" column="gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbDisGoodsFatherId" column="gb_dgs_gb_dis_goods_father_id"/>
        <result property="gbDgsGbDepDisGoodsId" column="gb_dgs_gb_dep_dis_goods_id"/>
        <result property="gbDgsPrice" column="gb_dgs_price"/>
        <result property="gbDgsWeight" column="gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="gb_dgs_produce_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="gb_dgs_gb_department_father_id"/>
        <result property="gbDgsStatus" column="gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="gb_dgs_date"/>
        <result property="gbDgsInventoryDate" column="gb_dgs_inventory_date"/>
        <result property="gbDgsInventoryWeek" column="gb_dgs_inventory_week"/>
        <result property="gbDgsInventoryMonth" column="gb_dgs_inventory_month"/>
        <result property="gbDgsWarnFullTime" column="gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="gb_dgs_return_subtotal"/>
        <result property="gbDgsOutDate" column="gb_dgs_out_date"/>
        <result property="gbDgsOutFullTime" column="gb_dgs_out_full_time"/>
        <result property="gbDgsOutHour" column="gb_dgs_out_hour"/>
        <result property="gbDgsWarnTimeQuantumName" column="gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="gb_dgs_gb_price_subtotal"/>
        <result property="gbDgsGbPriceSubtotal" column="gb_dgs_gb_price_subtotal"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
    </resultMap>
    <select id="queryStockListByParams" resultMap="stockWithDisGoods">
        select *
        from gb_department_goods_stock as gdgs
                 left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        where gb_dgs_gb_department_father_id = #{depFatherId}
    </select>

    <select id="queryDepGoodsSubtotal" resultType="java.lang.Double">
        select sum(gb_dgs_subtotal) from gb_department_goods_stock as gdgs
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id

        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>

            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depId != null">
                and gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="status != null">
                and gb_dgs_status &lt; #{status}
            </if>
            <if test="dayuStatus != null">
                and gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="inventoryType != null">
                and dg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>

            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="settleId != null and settleId == -1">
                and gdgs.gb_dgs_dep_settle_id is null
            </if>
            <if test="fromSettleId != null and fromSettleId == -1">
                and gdgs.gb_dgs_from_dep_settle_id is null
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>


        </where>
    </select>

<!--    <select id="queryDepGoodsLossSubtotal" resultType="java.lang.Double">-->
<!--        select sum(gb_dgs_loss_subtotal) from gb_department_goods_stock as gdgs-->
<!--        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id-->

<!--        <where>-->
<!--            <if test="disId != null">-->
<!--                and gb_dgs_gb_distributer_id = #{disId}-->
<!--            </if>-->
<!--            <if test="fromDepId != null">-->
<!--                and gb_dgs_gb_from_department_id = #{fromDepId}-->
<!--            </if>-->
<!--            <if test="notEqualStockId != null">-->
<!--                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}-->
<!--            </if>-->
<!--            <if test="stockId != null">-->
<!--                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}-->
<!--            </if>-->
<!--            <if test="nxDisId != null">-->
<!--                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}-->
<!--            </if>-->
<!--            <if test="depFatherIdNotEqual != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}-->
<!--            </if>-->
<!--            <if test="depId != null">-->
<!--                and gb_dgs_gb_department_id = #{depId}-->
<!--            </if>-->
<!--            <if test="depFatherId != null">-->
<!--                and gb_dgs_gb_department_father_id = #{depFatherId}-->
<!--            </if>-->
<!--            <if test="status != null">-->
<!--                and gb_dgs_status &lt; #{status}-->
<!--            </if>-->
<!--            <if test="dayuStatus != null">-->
<!--                and gb_dgs_status &gt; #{dayuStatus}-->
<!--            </if>-->

<!--            <if test="depGoodsId != null">-->
<!--                and gdgs.gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}-->
<!--            </if>-->

<!--            <if test="startDate != null">-->
<!--                and gb_dgs_date &gt;= #{startDate}-->
<!--            </if>-->
<!--            <if test="stopDate != null">-->
<!--                and gb_dgs_date &lt;= #{stopDate}-->
<!--            </if>-->

<!--            <if test="disGoodsFatherId != null">-->
<!--                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
<!--            </if>-->
<!--            <if test="dayuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="xiaoyuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="depFatherIds != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id in-->
<!--                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="restWeight != null">-->
<!--                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}-->
<!--            </if>-->

<!--        </where>-->
<!--    </select>-->
    <select id="queryMinFullTimeForDayStock" resultType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">
        select min(gb_dgs_out_hour) as gb_dgs_out_hour from gb_department_goods_stock as gdgs

        <where>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="equalOutDate != null">
                and gb_dgs_out_date = #{equalOutDate}
            </if>
            <if test="dayuStatus != null">
                and gb_dgs_status &gt; #{dayuStatus}
            </if>

        </where>
    </select>
    <resultMap id="stockOrder" type="GbDepartmentOrdersEntity">
        <id property="gbDepartmentOrdersId" column="gb_department_orders_id"/>
        <result property="gbDoSellingPrice" column="gb_DO_selling_price"/>
        <result property="gbDoSellingSubtotal" column="gb_DO_selling_subtotal"/>
        <result property="gbDoNxGoodsId" column="gb_DO_nx_goods_id"/>
        <result property="gbDoOrderUserId" column="gb_DO_order_user_id"/>
        <result property="gbDoApplyDate" column="gb_DO_apply_date"/>
        <result property="gbDoApplyOnlyTime" column="gb_DO_apply_only_time"/>
        <result property="gbDoApplyFullTime" column="gb_DO_apply_full_time"/>
        <result property="gbDoArriveOnlyDate" column="gb_DO_arrive_only_date"/>
        <result property="gbDoArriveDate" column="gb_DO_arrive_date"/>
        <result property="gbDoArriveWhatDay" column="gb_DO_arrive_what_day"/>
        <result property="gbDoQuantity" column="gb_DO_quantity"/>
        <result property="gbDoStandard" column="gb_DO_standard"/>
        <result property="gbDoDsStandardScale" column="gb_DO_ds_standard_scale"/>
        <result property="gbDoDsStandardId" column="gb_DO_ds_standard_id"/>
        <result property="gbDoRemark" column="gb_DO_remark"/>
        <result property="gbDoStatus" column="gb_DO_status"/>
        <result property="gbDoWeight" column="gb_DO_weight"/>
        <result property="gbDoScaleWeight" column="gb_DO_scale_weight"/>
        <result property="gbDoScalePrice" column="gb_DO_scale_price"/>
        <result property="gbDoPrice" column="gb_DO_price"/>
        <result property="gbDoSubtotal" column="gb_DO_subtotal"/>
        <result property="gbDoBuyStatus" column="gb_DO_buy_status"/>
        <result property="gbDoNxGoodsFatherId" column="gb_DO_nx_goods_father_id"/>
        <result property="gbDoDepartmentFatherId" column="gb_DO_department_father_id"/>
        <result property="gbDoDisGoodsId" column="gb_DO_dis_goods_id"/>
        <result property="gbDoDepDisGoodsId" column="gb_DO_dep_dis_goods_id"/>
        <result property="gbDoDisGoodsFatherId" column="gb_DO_dis_goods_father_id"/>
        <result property="gbDoDepartmentId" column="gb_DO_department_id"/>
        <result property="gbDoDistributerId" column="gb_DO_distributer_id"/>
        <result property="gbDoBuyStatus" column="gb_DO_buy_status"/>
        <result property="gbDoGoodsType" column="gb_DO_goods_type"/>
        <result property="gbDoDgsrReturnId" column="gb_DO_dgsr_return_id"/>
        <result property="gbDoOperationTime" column="gb_DO_operation_time"/>
        <result property="gbDoIsAgent" column="gb_DO_is_agent"/>
        <result property="gbDoPurchaseGoodsId" column="gb_DO_purchase_goods_id"/>
        <result property="gbDoDepDisGoodsId" column="gb_DO_dep_dis_goods_id"/>
        <result property="gbDoGoodsType" column="gb_DO_goods_type"/>
        <result property="gbDoDgsrReturnId" column="gb_DO_dgsr_return_id"/>
        <result property="gbDoNxDepartmentOrderId" column="gb_DO_nx_department_order_id"/>
        <result property="gbDoNxDistributerId" column="gb_DO_distributer_id"/>
        <result property="gbDoNxDistributerGoodsId" column="gb_DO_nx_distributer_goods_id"/>
        <result property="gbDoToDepartmentId" column="gb_DO_to_department_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_receive_user_id"/>
        <result property="gbDoOrderType" column="gb_DO_order_type"/>
        <result property="gbDoBillId" column="gb_DO_bill_id"/>
        <result property="gbDoPurchaseUserId" column="gb_DO_purchase_user_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_return_user_id"/>
        <result property="gbDoWeightTotalId" column="gb_DO_weight_total_id"/>
        <result property="gbDoWeightGoodsId" column="gb_DO_weight_goods_id"/>
        <result property="gbDoPriceDifferent" column="gb_DO_price_different"/>
        <association property="gbDepartmentUserEntity" resultMap="orderUser"/>
        <association property="gbDepartmentEntity" resultMap="dep"/>
    </resultMap>

    <resultMap id="shelfStock" type="GbDepartmentGoodsStockEntity">
        <id property="gbDepartmentGoodsStockId" column="gb_department_goods_stock_id"/>
        <result property="gbDgsProduceSellingSubtotal" column="gb_dgs_produce_selling_subtotal"/>
        <result property="gbDgsNxDistributerId" column="gb_dgs_nx_distributer_id"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsAfterProfitSubtotal" column="gb_dgs_after_profit_subtotal"/>
        <result property="gbDgsBetweenPrice" column="gb_dgs_between_price"/>
        <result property="gbDgsProfitWeight" column="gb_dgs_profit_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsRestWeightShowStandard" column="gb_dgs_rest_weight_show_standard"/>
        <result property="gbDgsRestWeightShowStandardName" column="gb_dgs_rest_weight_show_standard_name"/>
        <result property="gbDgsGbDisGoodsId" column="gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbDisGoodsFatherId" column="gb_dgs_gb_dis_goods_father_id"/>
        <result property="gbDgsGbDepDisGoodsId" column="gb_dgs_gb_dep_dis_goods_id"/>
        <result property="gbDgsPrice" column="gb_dgs_price"/>
        <result property="gbDgsWeight" column="gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="gb_dgs_produce_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="gb_dgs_gb_department_father_id"/>
        <result property="gbDgsStatus" column="gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="gb_dgs_date"/>
        <result property="gbDgsInventoryDate" column="gb_dgs_inventory_date"/>
        <result property="gbDgsInventoryWeek" column="gb_dgs_inventory_week"/>
        <result property="gbDgsInventoryMonth" column="gb_dgs_inventory_month"/>
        <result property="gbDgsWarnFullTime" column="gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="gb_dgs_return_subtotal"/>
        <result property="gbDgsOutDate" column="gb_dgs_out_date"/>
        <result property="gbDgsOutFullTime" column="gb_dgs_out_full_time"/>
        <result property="gbDgsOutHour" column="gb_dgs_out_hour"/>
        <result property="gbDgsWarnTimeQuantumName" column="gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="gb_dgs_gb_price_subtotal"/>
        <result property="gbDgsGbPriceSubtotal" column="gb_dgs_gb_price_subtotal"/>
        <association property="gbDepartmentOrdersEntity" resultMap="stockOrder"/>
    </resultMap>

    <resultMap id="shelfDisGoods" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
		<result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
		<result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="shelfStock"/>
    </resultMap>
    <resultMap id="shelfGoods" type="GbDistributerGoodsShelfGoodsEntity">
        <id property="gbDistributerGoodsShelfGoodsId" column="gb_distributer_goods_shelf_goods_id"/>
        <result property="gbDgsgDisGoodsId" column="gb_DGSG_dis_goods_id"/>
        <result property="gbDgsgShelfId" column="gb_DGSG_shelf_id"/>
        <result property="gbDgsgSort" column="gb_DGSG_sort"/>
        <association property="gbDistributerGoodsEntity" resultMap="shelfDisGoods"/>
    </resultMap>
    <resultMap id="everyOutShelfGoods" type="GbDistributerGoodsShelfEntity">
        <id property="gbDistributerGoodsShelfId" column="gb_distributer_goods_shelf_id"/>
        <result property="gbDistributerGoodsShelfName" column="gb_distributer_goods_shelf_name"/>
        <result property="gbDistributerGoodsShelfDisId" column="gb_distributer_goods_shelf_dis_id"/>
        <result property="gbDistributerGoodsShelfSort" column="gb_distributer_goods_shelf_sort"/>
        <collection property="gbDisGoodsShelfGoodsEntities" resultMap="shelfGoods"/>
    </resultMap>


    <select id="queryEveryDayOutStockShelfGoods" resultMap="everyOutShelfGoods">
        select * from gb_distributer_goods_shelf as shelf
        left join gb_distributer_goods_shelf_goods as sg on sg.gb_DGSG_shelf_id = shelf.gb_distributer_goods_shelf_id
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = sg.gb_DGSG_dis_goods_id
        left join gb_department_goods_stock as gdgs on gdgs.gb_dgs_gb_dis_goods_id = dg.gb_distributer_goods_id
        left join gb_department_orders as dor on dor.gb_department_orders_id = gdgs.gb_dgs_gb_department_order_id
        left join gb_department as dep on dep.gb_department_id = dor.gb_DO_department_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="stockDepId != null">
                and gb_dgs_gb_department_father_id = #{stockDepId}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="startTime != null">
                and gdgs.gb_dgs_full_time &gt;= #{startTime}
            </if>
            <if test="stopTime != null">
                and gdgs.gb_dgs_full_time &lt; #{stopTime}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

        </where>
        order by shelf.gb_distributer_goods_shelf_sort, sg.gb_DGSG_sort , gb_dgs_out_hour, gb_DO_arrive_date
    </select>

    <select id="queryMaxFullTimeForDayStock" resultType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">
        select max(gb_dgs_out_hour) as gb_dgs_out_hour from gb_department_goods_stock
        <where>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="equalOutDate != null">
                and gb_dgs_out_date = #{equalOutDate}
            </if>
            <if test="dayuStatus != null">
                and gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>

    <resultMap id="grandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGrant_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGrant_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGrant_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsSort" column="ndfgGrant_gb_dfg_father_goods_sort"/>
        <collection property="fatherGoodsEntities" resultMap="fatherGoods"/>
    </resultMap>

    <resultMap id="grandGoodsWithStock" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGrant_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGrant_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGrant_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsSort" column="ndfgGrant_gb_dfg_father_goods_sort"/>
        <collection property="fatherGoodsEntities" resultMap="fatherGoodsWithStock"/>
    </resultMap>
    <resultMap id="greatGrandGoodsWithStock" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGreatGrand_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGreatGrand_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGreatGrand_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="ndfgGreatGrand_gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsSort" column="ndfgGreatGrand_gb_dfg_father_goods_sort"/>
        <collection property="fatherGoodsEntities" resultMap="grandGoodsWithStock"/>
    </resultMap>

    <resultMap id="greatGrandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGreatGrand_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGreatGrand_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGreatGrand_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="ndfgGreatGrand_gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsSort" column="ndfgGreatGrand_gb_dfg_father_goods_sort"/>
        <collection property="fatherGoodsEntities" resultMap="grandGoods"/>
    </resultMap>


    <select id="queryDepStockDisFatherGoodsFather" resultMap="greatGrandGoods">
        select * ,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGrant.gb_dfg_father_goods_sort 'ndfgGrant_gb_dfg_father_goods_sort',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_dfg_father_goods_sort 'ndfgGreatGrand_gb_dfg_father_goods_sort'
        from gb_department_goods_stock as gdgs
        left join gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgs.gb_dgs_gb_dis_goods_father_id
        left join gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id

        <where>
            <if test="isSelf != null">
                and gdg.gb_dg_is_self_control = #{isSelf}
            </if>
            <if test="disId != null">
                and gdgs.gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="settleId != null and settleId == -1">
                and gdgs.gb_dgs_dep_settle_id is null
            </if>

            <if test="disGoodsId != null">
                and gdgs.gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="startTime != null">
                and gdgs.gb_dgs_full_time &gt;= #{startTime}
            </if>
            <if test="stopTime != null">
                and gdgs.gb_dgs_full_time &lt; #{stopTime}
            </if>
            <if test="xiaoyuStopTime != null">
                and gb_dgs_full_time &lt; #{xiaoyuStopTime}
            </if>
            <if test="startDate != null">
                and gdgs.gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgs.gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="inventoryDate != null">
                and gdgs.gb_dgs_inventory_date &lt;= #{inventoryDate}
            </if>

            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>

            <if test="status != null">
                and gdgs.gb_dgs_status &lt; #{status}
            </if>

            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>

            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="isSelf != null">
                and gdg.gb_dg_is_self_control = #{isSelf}
            </if>
            <if test="inventoryType != null">
                and gdg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
        order by
        ndfgGreatGrand.gb_dfg_father_goods_sort,ndfgGrant.gb_dfg_father_goods_sort,ndfg.gb_dfg_father_goods_sort

    </select>


<!--    <select id="queryDepGoodsWasteList" resultType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">-->
<!--        select * from gb_department_goods_stock as gdgs-->
<!--        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id-->
<!--        <where>-->
<!--            <if test="disId != null">-->
<!--                and gb_dgs_gb_distributer_id = #{disId}-->
<!--            </if>-->
<!--            <if test="disGoodsId != null">-->
<!--                and gb_dgs_gb_dis_goods_id = #{disGoodsId}-->
<!--            </if>-->
<!--            <if test="disGoodsFatherId != null">-->
<!--                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
<!--            </if>-->
<!--            <if test="depId != null">-->
<!--                and gb_dgs_gb_department_id = #{depId}-->
<!--            </if>-->
<!--            <if test="depFatherId != null">-->
<!--                and gb_dgs_gb_department_father_id = #{depFatherId}-->
<!--            </if>-->

<!--            <if test="fromDepId != null">-->
<!--                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}-->
<!--            </if>-->
<!--            <if test="notEqualStockId != null">-->
<!--                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}-->
<!--            </if>-->
<!--            <if test="stockId != null">-->
<!--                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}-->
<!--            </if>-->
<!--            <if test="nxDisId != null">-->
<!--                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}-->
<!--            </if>-->
<!--            <if test="depFatherIdNotEqual != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}-->
<!--            </if>-->
<!--            <if test="depGoodsId != null">-->
<!--                and gdgs.gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}-->
<!--            </if>-->
<!--            <if test="startDate != null">-->
<!--                and gb_dgs_date &gt;= #{startDate}-->
<!--            </if>-->
<!--            <if test="stopDate != null">-->
<!--                and gb_dgs_date &lt;= #{stopDate}-->
<!--            </if>-->

<!--            <if test="status != null">-->
<!--                and gb_dgs_status &lt; #{status}-->
<!--            </if>-->
<!--            <if test="dayuStatus != null">-->
<!--                and gb_dgs_status &gt; #{dayuStatus}-->
<!--            </if>-->
<!--            <if test="inventoryType != null">-->
<!--                and dg.gb_dg_goods_inventory_type = #{inventoryType}-->
<!--            </if>-->
<!--            <if test="dayuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="xiaoyuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="depFatherIds != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id in-->
<!--                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="restWeight != null">-->
<!--                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}-->
<!--            </if>-->

<!--        </where>-->
<!--    </select>-->

    <resultMap id="depUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="gb_department_user_id"/>
		<result property="gbDuLoginTimes" column="gb_DU_login_times"/>
        <result property="gbDuCustomerService" column="gb_DU_customer_service"/>
        <result property="gbDuWxNickName" column="gb_DU_wx_nick_name"/>
        <result property="gbDuWxAvartraUrl" column="gb_DU_wx_avartra_url"/>
        <result property="gbDuUrlChange" column="gb_DU_url_change"/>
    </resultMap>
    <resultMap id="returnUser" type="GbDepartmentUserEntity">
        <id property="gbDepartmentUserId" column="return_gb_department_user_id"/>
        <result property="gbDuWxNickName" column="return_gb_DU_wx_nick_name"/>
        <result property="gbDuWxAvartraUrl" column="return_gb_DU_wx_avartra_url"/>
        <result property="gbDuUrlChange" column="return_gb_DU_url_change"/>
    </resultMap>
    <resultMap id="reduce" type="GbDepartmentGoodsStockReduceEntity">
        <id property="gbDepartmentGoodsStockReduceId" column="gb_department_goods_stock_reduce_id"/>
        <result property="gbDgsrStockNxDistribtuerId" column="gb_dgsr_stock_nx_distributer_id"/>
        <result property="gbDgsrProfitSubtotal" column="gb_dgsr_profit_subtotal"/>
        <result property="gbDgsrGbGoodsStockId" column="gb_dgsr_gb_goods_stock_id"/>
        <result property="gbDgsrProduceWeight" column="gb_dgsr_produce_weight"/>
        <result property="gbDgsrProduceSubtotal" column="gb_dgsr_produce_subtotal"/>
        <result property="gbDgsrWasteWeight" column="gb_dgsr_waste_weight"/>
        <result property="gbDgsrWasteSubtotal" column="gb_dgsr_waste_subtotal"/>
        <result property="gbDgsrLossWeight" column="gb_dgsr_loss_weight"/>
        <result property="gbDgsrLossSubtotal" column="gb_dgsr_loss_subtotal"/>
        <result property="gbDgsrDate" column="gb_dgsr_date"/>
        <result property="gbDgsrType" column="gb_dgsr_type"/>
        <result property="gbDgsrStatus" column="gb_dgsr_status"/>
        <result property="gbDgsrDoUserId" column="gb_dgsr_do_user_id"/>
        <result property="gbDgsrFullTime" column="gb_dgsr_full_time"/>
        <result property="gbDgsrGbDepartmentId" column="gb_dgsr_gb_department_id"/>
        <result property="gbDgsrGbDepartmentFatherId" column="gb_dgsr_gb_department_father_id"/>
        <result property="gbDgsrGbDisGoodsId" column="gb_dgsr_gb_dis_goods_id"/>
        <result property="gbDgsrMonth" column="gb_dgsr_month"/>
        <result property="gbDgsrWeek" column="gb_dgsr_week"/>
        <result property="gbDgsrGbDistributerId" column="gb_dgsr_gb_distributer_id"/>
        <result property="gbDgsrReturnWeight" column="gb_dgsr_return_weight"/>
        <result property="gbDgsrReturnSubtotal" column="gb_dgsr_return_subtotal"/>
        <association property="gbDepartmentUserEntity" resultMap="depUser"/>
    </resultMap>

    <resultMap id="stockWithReduce" type="GbDepartmentGoodsStockEntity">
        <id property="gbDepartmentGoodsStockId" column="gb_department_goods_stock_id"/>
        <result property="gbDgsProduceSellingSubtotal" column="gb_dgs_produce_selling_subtotal"/>
        <result property="gbDgsNxDistributerId" column="gb_dgs_nx_distributer_id"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsAfterProfitSubtotal" column="gb_dgs_after_profit_subtotal"/>
        <result property="gbDgsBetweenPrice" column="gb_dgs_between_price"/>
        <result property="gbDgsProfitWeight" column="gb_dgs_profit_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsRestWeightShowStandard" column="gb_dgs_rest_weight_show_standard"/>
        <result property="gbDgsRestWeightShowStandardName" column="gb_dgs_rest_weight_show_standard_name"/>
        <result property="gbDgsGbDisGoodsId" column="gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsPrice" column="gb_dgs_price"/>
        <result property="gbDgsWeight" column="gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="gb_dgs_produce_subtotal"/>
        <result property="gbDgsWasteWeight" column="gb_dgs_waste_weight"/>
        <result property="gbDgsWasteSubtotal" column="gb_dgs_waste_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="gb_dgs_department_father_id"/>
        <result property="gbDgsStatus" column="gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="gb_dgs_date"/>
        <result property="gbDgsWarnFullTime" column="gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="gb_dgs_return_subtotal"/>
        <result property="gbDgsWarnTimeQuantumName" column="gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="gb_dgs_gb_price_subtotal"/>
        <result property="gbDgsGbPriceSubtotal" column="gb_dgs_gb_price_subtotal"/>
        <collection property="goodsStockReduceEntityList" resultMap="reduce"/>
    </resultMap>


    <select id="queryGoodsStockWithReduceList" resultMap="stockWithReduce">
        select * from gb_department_goods_stock as gdgs
        left join gb_department_goods_stock_reduce as gdgsr on gdgsr.gb_dgsr_gb_goods_stock_id =
        gdgs.gb_department_goods_stock_id
        <where>

            <if test="reduceType != null">
                and gdgsr.gb_dgsr_type = #{reduceType}
            </if>
            <if test="reduceDate != null">
                and gdgsr.gb_dgsr_date = #{reduceDate}
            </if>
            <if test="reduceDepId != null">
                and gdgsr.gb_dgsr_gb_department_id = #{reduceDepId}
            </if>
            <if test="reduceGoodsId != null">
                and gdgsr.gb_dgsr_gb_dis_goods_id = #{reduceGoodsId}
            </if>

            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>


        </where>
        order by gdgs.gb_dgs_date DESC, gdgsr.gb_dgsr_full_time
    </select>

    <select id="queryDepGoodsRestWeightTotal" resultType="java.lang.Double">
        select sum(gb_dgs_rest_weight) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depId != null">
                and gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryGoodsStockTimeStamp" resultType="java.lang.Long">
        select SUM(gdgs.gb_dgs_time_stamp) from gb_department_goods_stock as gdgs

        <where>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>


            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsSellingSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_selling_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>


            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

        </where>
    </select>

    <select id="queryGoodsStockReduceByParams" resultMap="stockWithReduce">
        select * from gb_department_goods_stock as gdgs
        left join gb_department_goods_stock_reduce as gdgsr on gdgs.gb_department_goods_stock_id =
        gdgsr.gb_dgsr_gb_goods_stock_id
        left join gb_department_user as reduce_user on reduce_user.gb_department_user_id = gdgsr.gb_dgsr_do_user_id

        <where>
            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="status != null">
                and gdgs.gb_dgs_status &lt; #{status}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="disGoodsId != null">
                and gdgs.gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gdgs.gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>

            <if test="loss != null and loss == 1">
                and gdgs.gb_dgs_loss_weight > 0
            </if>
            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
        order by gdgs.gb_dgs_full_time DESC, gdgsr.gb_dgsr_full_time DESC
    </select>
    <select id="queryDepStockTreeFatherGoodsByParams" resultMap="greatGrandGoods">
        select * ,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name'
        from gb_department_goods_stock as gdgs
        left join gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgs.gb_dgs_gb_dis_goods_father_id
        left join gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id

        <where>
            <if test="disId != null">
                and gdgs.gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="depFatherId != null">
                and gdgs.gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
            <if test="loss != null">
                and gdgs.gb_dgs_loss_weight &gt; #{loss}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="settleId != null and settleId == -1">
                and gdgs.gb_dgs_dep_settle_id is null
            </if>

            <if test="disGoodsId != null">
                and gdgs.gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="startTime != null">
                and gdgs.gb_dgs_full_time &gt;= #{startTime}
            </if>
            <if test="stopTime != null">
                and gdgs.gb_dgs_full_time &lt; #{stopTime}
            </if>
            <if test="xiaoyuStopTime != null">
                and gb_dgs_full_time &lt; #{xiaoyuStopTime}
            </if>
            <if test="startDate != null">
                and gdgs.gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgs.gb_dgs_date &lt;= #{stopDate}
            </if>
            <if test="inventoryDate != null">
                and gdgs.gb_dgs_inventory_date &lt;= #{inventoryDate}
            </if>

            <if test="date != null">
                and gdgs.gb_dgs_date = #{date}
            </if>

            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="status != null">
                and gdgs.gb_dgs_status &lt; #{status}
            </if>
            <if test="fromDepId != null">
                and gdgs.gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>

            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depId != null">
                and gdgs.gb_dgs_gb_department_id = #{depId}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="isSelf != null">
                and gdg.gb_dg_is_self_control = #{isSelf}
            </if>
            <if test="inventoryType != null">
                and gdg.gb_dg_goods_inventory_type = #{inventoryType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
        order by
        ndfgGreatGrand.gb_dfg_father_goods_sort,ndfgGrant.gb_dfg_father_goods_sort,ndfg.gb_dfg_father_goods_sort

    </select>
    <select id="queryStockSellingPriceTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_selling_price) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

        </where>
    </select>
    <select id="queryStockPriceTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_price) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>


            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>

            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>

<!--    <select id="queryDepStockProduceWeightTotal" resultType="java.lang.Double">-->
<!--        select sum(gdgs.gb_dgs_produce_weight) from gb_department_goods_stock as gdgs-->
<!--        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id-->
<!--        <where>-->
<!--            <if test="disId != null">-->
<!--                and gb_dgs_gb_distributer_id = #{disId}-->
<!--            </if>-->
<!--            <if test="date != null">-->
<!--                and gb_dgs_date = #{date}-->
<!--            </if>-->
<!--            <if test="time != null">-->
<!--                and gb_dgs_full_time &gt;= #{startDate}-->
<!--            </if>-->
<!--            <if test="equalStatus != null">-->
<!--                and gb_dgs_status = #{equalStatus}-->
<!--            </if>-->
<!--            <if test="dayuStatus != null">-->
<!--                and gdgs.gb_dgs_status &gt; #{dayuStatus}-->
<!--            </if>-->

<!--            <if test="depFatherId != null">-->
<!--                and gb_dgs_gb_department_father_id = #{depFatherId}-->
<!--            </if>-->
<!--            <if test="disGoodsFatherId != null">-->
<!--                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
<!--            </if>-->
<!--            <if test="disGoodsId != null">-->
<!--                and gb_dgs_gb_dis_goods_id = #{disGoodsId}-->
<!--            </if>-->
<!--            <if test="disGoodsFatherId != null">-->
<!--                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
<!--            </if>-->
<!--            <if test="depGoodsId != null">-->
<!--                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}-->
<!--            </if>-->
<!--            <if test="fromDepId != null">-->
<!--                and gb_dgs_gb_from_department_id = #{fromDepId}-->
<!--            </if>-->
<!--            <if test="notEqualStockId != null">-->
<!--                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}-->
<!--            </if>-->
<!--            <if test="stockId != null">-->
<!--                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}-->
<!--            </if>-->
<!--            <if test="nxDisId != null">-->
<!--                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}-->
<!--            </if>-->
<!--            <if test="depFatherIdNotEqual != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}-->
<!--            </if>-->

<!--            <if test="startDate != null">-->
<!--                and gb_dgs_date &gt;= #{startDate}-->
<!--            </if>-->
<!--            <if test="stopDate != null">-->
<!--                and gb_dgs_date &lt;= #{stopDate}-->
<!--            </if>-->

<!--            <if test="depType != null">-->
<!--                and gd.gb_department_type = #{depType}-->
<!--            </if>-->
<!--            <if test="orderDepType != null">-->
<!--                and gd.gb_department_type = #{orderDepType}-->
<!--            </if>-->
<!--            <if test="dayuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="xiaoyuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="depFatherIds != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id in-->
<!--                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="restWeight != null">-->
<!--                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}-->
<!--            </if>-->

<!--        </where>-->
<!--    </select>-->
    <!--    <select id="queryGoodsStockWeightTotal" resultType="java.lang.Double">-->
    <!--        select sum(gb_dgs_weight) from gb_department_goods_stock as gdgs-->
    <!--        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id-->
    <!--        <where>-->
    <!--            <if test="disId != null">-->
    <!--                and gb_dgs_gb_distributer_id  = #{disId}-->
    <!--            </if>-->
    <!--            <if test="date != null">-->
    <!--                and gb_dgs_date = #{date}-->
    <!--            </if>-->
    <!--            <if test="time != null">-->
    <!--                and gb_dgs_full_time  &gt;= #{startDate}-->
    <!--            </if>-->

    <!--            <if test="depFatherId != null">-->
    <!--                and gb_dgs_gb_department_father_id = #{depFatherId}-->
    <!--            </if>-->
    <!--            <if test="disGoodsId != null">-->
    <!--                and gb_dgs_gb_dis_goods_id = #{disGoodsId}-->
    <!--            </if>-->
    <!--            <if test="disGoodsFatherId != null">-->
    <!--                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
    <!--            </if>-->
    <!--            <if test="depGoodsId != null">-->
    <!--                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}-->
    <!--            </if>-->
    <!--            <if test="fromDepId != null">-->
    <!--                and gb_dgs_gb_from_department_id = #{fromDepId}-->
    <!--            </if>-->
    <!--            <if test="nxDisId != null">-->
    <!--                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}-->
    <!--            </if>-->

    <!--            <if test="depFatherIdNotEqual != null">-->
    <!--                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}-->
    <!--            </if>-->
    <!--            <if test="startDate != null">-->
    <!--                and gb_dgs_date  &gt;= #{startDate}-->
    <!--            </if>-->
    <!--            <if test="stopDate != null">-->
    <!--                and gb_dgs_date  &lt;=  #{stopDate}-->
    <!--            </if>-->

    <!--            <if test="dayuPriceSubtotal != null">-->
    <!--                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}-->
    <!--            </if>-->
    <!--            <if test="xiaoyuPriceSubtotal != null">-->
    <!--                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}-->
    <!--            </if>-->

    <!--            <if test="depFatherIds != null">-->
    <!--                and gdgs.gb_dgs_gb_department_father_id in-->
    <!--                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">-->
    <!--                    #{id}-->
    <!--                </foreach>-->
    <!--            </if>-->

    <!--            <if test="restWeight != null">-->
    <!--                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}-->
    <!--            </if>-->
    <!--        </where>-->
    <!--    </select>-->
    <select id="queryDepStockWeightTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_weight) from gb_department_goods_stock as gdgs
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="isSelf != null">
                and dg.gb_dg_is_self_control = #{isSelf}
            </if>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depId != null">
                and gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgs.gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="fromStockId != null">
                and gb_dgs_gb_goods_stock_id = #{fromStockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

        </where>
    </select>
    <select id="queryDepStockLossWeightTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_loss_weight) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
            <if test="loss != null">
                and gdgs.gb_dgs_loss_weight &gt; #{loss}
            </if>
        </where>
    </select>
    <select id="queryDepStockWasteWeightTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_waste_weight) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>


            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>

        </where>
    </select>
    <select id="queryDepStockRestWeightTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_rest_weight) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>

            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>

    <resultMap id="depWithDepGoods" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentAttrName" column="gb_department_attr_name"/>
        <result property="gbDepartmentDisId" column="gb_department_dis_id"/>
        <result property="gbDepartmentSubAmount" column="gb_department_sub_amount"/>
        <result property="gbDepartmentIsGroupDep" column="gb_department_is_group_dep"/>
        <result property="gbDepartmentSubAmount" column="gb_department_sub_amount"/>
        <result property="gbDepartmentFatherId" column="gb_department_father_id"/>
        <result property="gbDepartmentSettleType" column="gb_department_settle_type"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
        <result property="gbDepartmentPrintName" column="gb_department_print_name"/>
        <association property="gbDepartmentDisGoodsEntity" resultMap="depGoods"/>
    </resultMap>
    <select id="queryWhichDepHasStock" resultMap="depWithDepGoods">
        select * from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_id
        left join gb_department_dis_goods as gddg on gddg.gb_department_dis_goods_id = gdgs.gb_dgs_gb_dep_dis_goods_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>

            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>


            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="produceWeight != null">
                and gdgs.gb_dgs_produce_weight = #{produceWeight}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryStockCostRateTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_cost_rate) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryGoodsPriceTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_gb_price_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryGoodsPriceScale" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_gb_price_subtotal_scale) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>

<!--    <select id="queryDepStockProduceSubtotal" resultType="java.lang.Double">-->
<!--        select sum(gdgs.gb_dgs_produce_subtotal) from gb_department_goods_stock as gdgs-->
<!--        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id-->
<!--        <where>-->
<!--            <if test="disId != null">-->
<!--                and gb_dgs_gb_distributer_id = #{disId}-->
<!--            </if>-->
<!--            <if test="date != null">-->
<!--                and gb_dgs_date = #{date}-->
<!--            </if>-->
<!--            <if test="time != null">-->
<!--                and gb_dgs_full_time &gt;= #{startDate}-->
<!--            </if>-->
<!--            <if test="equalStatus != null">-->
<!--                and gb_dgs_status = #{equalStatus}-->
<!--            </if>-->
<!--            <if test="dayuStatus != null">-->
<!--                and gdgs.gb_dgs_status &gt; #{dayuStatus}-->
<!--            </if>-->
<!--            <if test="depFatherId != null">-->
<!--                and gb_dgs_gb_department_father_id = #{depFatherId}-->
<!--            </if>-->
<!--            <if test="disGoodsId != null">-->
<!--                and gb_dgs_gb_dis_goods_id = #{disGoodsId}-->
<!--            </if>-->
<!--            <if test="disGoodsFatherId != null">-->
<!--                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}-->
<!--            </if>-->
<!--            <if test="depGoodsId != null">-->
<!--                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}-->
<!--            </if>-->
<!--            <if test="fromDepId != null">-->
<!--                and gb_dgs_gb_from_department_id = #{fromDepId}-->
<!--            </if>-->
<!--            <if test="notEqualStockId != null">-->
<!--                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}-->
<!--            </if>-->
<!--            <if test="stockId != null">-->
<!--                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}-->
<!--            </if>-->
<!--            <if test="nxDisId != null">-->
<!--                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}-->
<!--            </if>-->
<!--            <if test="depFatherIdNotEqual != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}-->
<!--            </if>-->

<!--            <if test="startDate != null">-->
<!--                and gb_dgs_date &gt;= #{startDate}-->
<!--            </if>-->
<!--            <if test="stopDate != null">-->
<!--                and gb_dgs_date &lt;= #{stopDate}-->
<!--            </if>-->

<!--            <if test="depType != null">-->
<!--                and gd.gb_department_type = #{depType}-->
<!--            </if>-->
<!--            <if test="orderDepType != null">-->
<!--                and gd.gb_department_type = #{orderDepType}-->
<!--            </if>-->
<!--            <if test="dayuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="xiaoyuPriceSubtotal != null">-->
<!--                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}-->
<!--            </if>-->
<!--            <if test="depFatherIds != null">-->
<!--                and gdgs.gb_dgs_gb_department_father_id in-->
<!--                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="restWeight != null">-->
<!--                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}-->
<!--            </if>-->
<!--        </where>-->
<!--    </select>-->
    <select id="queryDepStockWasteSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_waste_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockLossSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_loss_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockRestSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_rest_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>

    <select id="queryDepStockMaxDgsPrice" resultType="java.lang.String">
        select MAX(gb_dgs_price) from gb_department_goods_stock as gdgs
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>
            <if test="depId != null">
                and gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockMinDgsPrice" resultType="java.lang.String">
        select MIN(gb_dgs_price) from gb_department_goods_stock as gdgs
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gb_dgs_gb_department_id = #{depId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockProfitSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_profit_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockAfterProfitSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_after_profit_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockProduceSellingSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_produce_selling_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockListByParams" resultType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">
        select * from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryReturnStockItemByOrderId" resultType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">
        select *
        from gb_department_goods_stock
        where gb_dgs_gb_department_order_id = #{gbDepartmentOrdersId}
    </select>
    <select id="queryDepStockReturnSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_return_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockReturnWeightTotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_return_weight) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <resultMap id="disGoodsWithDepGoods" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
		<result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgDistributerId" column="gb_dg_distributer_id"/>
		<result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
		<result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgGoodsType" column="gb_dg_goods_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>
        <association property="gbDepartmentDisGoodsEntity" resultMap="depGoods"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="depStock"/>
    </resultMap>
    <select id="queryDisGoodsWithFromDepGoods" resultMap="disGoodsWithDepGoods">
        select * from gb_department_goods_stock as gdgs
            left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgs.gb_dgs_gb_dis_goods_id
            left join gb_department_dis_goods as gddg on gddg.gb_DDG_dis_goods_id = gdg.gb_distributer_goods_id
             and gddg.gb_DDG_department_id = #{fromDepId}
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gdgs.gb_dgs_gb_goods_stock_id = #{stockId}
            </if>
            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>
    <select id="queryDepStockSubtotal" resultType="java.lang.Double">
        select sum(gdgs.gb_dgs_subtotal) from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        <where>
            <if test="disId != null">
                and gb_dgs_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gb_dgs_date = #{date}
            </if>
            <if test="time != null">
                and gb_dgs_full_time &gt;= #{startDate}
            </if>
            <if test="equalStatus != null">
                and gb_dgs_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and gdgs.gb_dgs_status &gt; #{dayuStatus}
            </if>
            <if test="depFatherId != null">
                and gb_dgs_gb_department_father_id = #{depFatherId}
            </if>
            <if test="disGoodsId != null">
                and gb_dgs_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="depGoodsId != null">
                and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="fromDepId != null">
                and gb_dgs_gb_from_department_id = #{fromDepId}
            </if>
            <if test="notEqualStockId != null">
                and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
            </if>
            <if test="stockId != null">
                and gb_dgs_gb_goods_stock_id = #{stockId}
            </if>

            <if test="nxDisId != null">
                and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIdNotEqual != null">
                and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
            </if>

            <if test="startDate != null">
                and gb_dgs_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gb_dgs_date &lt;= #{stopDate}
            </if>

            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="orderDepType != null">
                and gd.gb_department_type = #{orderDepType}
            </if>
            <if test="dayuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
            </if>
            <if test="xiaoyuPriceSubtotal != null">
                and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
            </if>
            <if test="depFatherIds != null">
                and gdgs.gb_dgs_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="restWeight != null">
                and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
            </if>
        </where>
    </select>


    <resultMap id="depWithGreatGoods" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentAttrName" column="gb_department_attr_name"/>
        <result property="gbDepartmentDisId" column="gb_department_dis_id"/>
        <result property="gbDepartmentSubAmount" column="gb_department_sub_amount"/>
        <result property="gbDepartmentIsGroupDep" column="gb_department_is_group_dep"/>
        <result property="gbDepartmentSubAmount" column="gb_department_sub_amount"/>
        <result property="gbDepartmentFatherId" column="gb_department_father_id"/>
        <result property="gbDepartmentSettleType" column="gb_department_settle_type"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
        <result property="gbDepartmentPrintName" column="gb_department_print_name"/>
        <collection property="fatherGoodsEntities" resultMap="greatGrandGoodsWithStock"/>

    </resultMap>
    <select id="queryStockDepWithFatherGoods" resultMap="depWithGreatGoods">
        select * ,
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_dfg_father_goods_sort 'ndfgGreatGrand_gb_dfg_father_goods_sort',
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name'
               from gb_department_goods_stock as gdgs
        left join gb_department as gd on gd.gb_department_id = gdgs.gb_dgs_gb_department_father_id
        left join gb_distributer_father_goods as gdfg on gdfg.gb_distributer_father_goods_id = gdgs.gb_dgs_gb_dis_goods_father_id
         left join  gb_distributer_father_goods  as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id = gdfg.gb_dfg_fathers_father_id
         left join  gb_distributer_father_goods  as ndfgGreatGrand on ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        <where>
        <if test="disId != null">
            and gb_dgs_gb_distributer_id = #{disId}
        </if>
        <if test="date != null">
            and gb_dgs_date = #{date}
        </if>
        <if test="time != null">
            and gb_dgs_full_time &gt;= #{startDate}
        </if>
        <if test="equalStatus != null">
            and gb_dgs_status = #{equalStatus}
        </if>
        <if test="dayuStatus != null">
            and gdgs.gb_dgs_status &gt; #{dayuStatus}
        </if>
        <if test="depFatherId != null">
            and gb_dgs_gb_department_father_id = #{depFatherId}
        </if>
        <if test="disGoodsId != null">
            and gb_dgs_gb_dis_goods_id = #{disGoodsId}
        </if>
        <if test="disGoodsFatherId != null">
            and gb_dgs_gb_dis_goods_father_id = #{disGoodsFatherId}
        </if>
        <if test="depGoodsId != null">
            and gb_dgs_gb_dep_dis_goods_id = #{depGoodsId}
        </if>
        <if test="fromDepId != null">
            and gb_dgs_gb_from_department_id = #{fromDepId}
        </if>
        <if test="notEqualStockId != null">
            and gb_dgs_gb_goods_stock_id != #{notEqualStockId}
        </if>
        <if test="stockId != null">
            and gb_dgs_gb_goods_stock_id = #{stockId}
        </if>

        <if test="nxDisId != null">
            and gdgs.gb_dgs_nx_distributer_id = #{nxDisId}
        </if>
        <if test="depFatherIdNotEqual != null">
            and gdgs.gb_dgs_gb_department_father_id != #{depFatherIdNotEqual}
        </if>

        <if test="startDate != null">
            and gb_dgs_date &gt;= #{startDate}
        </if>
        <if test="stopDate != null">
            and gb_dgs_date &lt;= #{stopDate}
        </if>

        <if test="depType != null">
            and gd.gb_department_type = #{depType}
        </if>
        <if test="orderDepType != null">
            and gd.gb_department_type = #{orderDepType}
        </if>
        <if test="dayuPriceSubtotal != null">
            and gdgs.gb_dgs_gb_price_subtotal &gt; #{dayuPriceSubtotal}
        </if>
        <if test="xiaoyuPriceSubtotal != null">
            and gdgs.gb_dgs_gb_price_subtotal &lt; #{xiaoyuPriceSubtotal}
        </if>
        <if test="depFatherIds != null">
            and gdgs.gb_dgs_gb_department_father_id in
            <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                #{id}
            </foreach>
        </if>
        <if test="restWeight != null">
            and gdgs.gb_dgs_rest_weight &gt; #{restWeight}
        </if>
        </where>

    </select>


    <insert id="save" parameterType="com.nongxinle.entity.GbDepartmentGoodsStockEntity" useGeneratedKeys="true"
            keyProperty="gbDepartmentGoodsStockId">
        insert into gb_department_goods_stock
        (`gb_department_goods_stock_id`,
         `gb_dgs_gb_distributer_id`,
         `gb_dgs_gb_department_id`,
         `gb_dgs_gb_department_father_id`,
         `gb_dgs_gb_dis_goods_id`,
         `gb_dgs_gb_dep_dis_goods_id`,
         `gb_dgs_gb_department_order_id`,
         `gb_dgs_weight`,
         `gb_dgs_rest_weight`,
         `gb_dgs_date`,
         `gb_dgs_time_stamp`,
         `gb_dgs_week`,
         `gb_dgs_month`,
         `gb_dgs_year`,
         `gb_dgs_receive_user_id`,
         `gb_dgs_status`,
         `gb_dgs_gb_pur_goods_id`,
         `gb_dgs_price`,
         `gb_dgs_subtotal`,
         `gb_dgs_rest_subtotal`,
         `gb_dgs_gb_goods_stock_id`,
         `gb_dgs_gb_from_department_id`,
         `gb_dgs_inventory_date`,
         `gb_dgs_inventory_week`,
         `gb_dgs_inventory_month`,
         `gb_dgs_inventory_year`,
         `gb_dgs_gb_dis_goods_father_id`,
         `gb_dgs_full_time`,
         `gb_dgs_warn_full_time`,
         `gb_dgs_waste_full_time`,
         `gb_dgs_do_waste_full_time`,
         `gb_dgs_loss_weight`,
         `gb_dgs_loss_subtotal`,
         `gb_dgs_dep_settle_id`,
         `gb_dgs_return_weight`,
         `gb_dgs_return_subtotal`,
         `gb_dgs_out_date`,
         `gb_dgs_out_full_time`,
         `gb_dgs_out_hour`,
         `gb_dgs_from_dep_settle_id`,
         `gb_dgs_inventory_full_time`,
         `gb_dgs_warn_time_quantum_name`,
         `gb_dgs_waste_time_quantum_name`,
         `gb_dgs_produce_weight`,
         `gb_dgs_produce_subtotal`,
         `gb_dgs_gb_price_goods_id`,
         `gb_dgs_gb_price_subtotal`,
         `gb_dgs_gb_price_subtotal_scale`,
         `gb_dgs_rest_weight_show_standard`,
         `gb_dgs_rest_weight_show_standard_name`,
         `gb_dgs_between_price`,
         `gb_dgs_profit_weight`,
         `gb_dgs_profit_subtotal`,
         `gb_dgs_selling_price`,
         `gb_dgs_selling_subtotal`,
         `gb_dgs_waste_weight`,
         `gb_dgs_waste_subtotal`,
         `gb_dgs_weight_goods_id`,
         `gb_dgs_after_profit_subtotal`,
         `gb_dgs_cost_rate`,
         `gb_dgs_nx_distributer_id`,
         `gb_dgs_produce_selling_subtotal`)
        values (#{gbDepartmentGoodsStockId},
                #{gbDgsGbDistributerId},
                #{gbDgsGbDepartmentId},
                #{gbDgsGbDepartmentFatherId},
                #{gbDgsGbDisGoodsId},
                #{gbDgsGbDepDisGoodsId},
                #{gbDgsGbDepartmentOrderId},
                #{gbDgsWeight},
                #{gbDgsRestWeight},
                #{gbDgsDate},
                #{gbDgsTimeStamp},
                #{gbDgsWeek},
                #{gbDgsMonth},
                #{gbDgsYear},
                #{gbDgsReceiveUserId},
                #{gbDgsStatus},
                #{gbDgsGbPurGoodsId},
                #{gbDgsPrice},
                #{gbDgsSubtotal},
                #{gbDgsRestSubtotal},
                #{gbDgsGbGoodsStockId},
                #{gbDgsGbFromDepartmentId},
                #{gbDgsInventoryDate},
                #{gbDgsInventoryWeek},
                #{gbDgsInventoryMonth},
                #{gbDgsInventoryYear},
                #{gbDgsGbDisGoodsFatherId},
                #{gbDgsFullTime},
                #{gbDgsWarnFullTime},
                #{gbDgsWasteFullTime},
                #{gbDgsDoWasteFullTime},
                #{gbDgsLossWeight},
                #{gbDgsLossSubtotal},
                #{gbDgsDepSettleId},
                #{gbDgsReturnWeight},
                #{gbDgsReturnSubtotal},
                #{gbDgsOutDate},
                #{gbDgsOutFullTime},
                #{gbDgsOutHour},
                #{gbDgsFromDepSettleId},
                #{gbDgsInventoryFullTime},
                #{gbDgsWarnTimeQuantumName},
                #{gbDgsWasteTimeQuantumName},
                #{gbDgsProduceWeight},
                #{gbDgsProduceSubtotal},
                #{gbDgsGbPriceGoodsId},
                #{gbDgsGbPriceSubtotal},
                #{gbDgsGbPriceSubtotalScale},
                #{gbDgsRestWeightShowStandard},
                #{gbDgsRestWeightShowStandardName},
                #{gbDgsBetweenPrice},
                #{gbDgsProfitWeight},
                #{gbDgsProfitSubtotal},
                #{gbDgsSellingPrice},
                #{gbDgsSellingSubtotal},
                #{gbDgsWasteWeight},
                #{gbDgsWasteSubtotal},
                #{gbDgsWeightGoodsId},
                #{gbDgsAfterProfitSubtotal},
                #{gbDgsCostRate},
                #{gbDgsNxDistributerId},
                #{gbDgsProduceSellingSubtotal})
    </insert>

    <update id="update" parameterType="com.nongxinle.entity.GbDepartmentGoodsStockEntity">
        update gb_department_goods_stock
        <set>
            <if test="gbDgsGbDistributerId != null">`gb_dgs_gb_distributer_id` = #{gbDgsGbDistributerId},</if>
            <if test="gbDgsGbDepartmentId != null">`gb_dgs_gb_department_id` = #{gbDgsGbDepartmentId},</if>
            <if test="gbDgsGbDepartmentFatherId != null">`gb_dgs_gb_department_father_id` =
                #{gbDgsGbDepartmentFatherId},
            </if>
            <if test="gbDgsGbDisGoodsId != null">`gb_dgs_gb_dis_goods_id` = #{gbDgsGbDisGoodsId},</if>
            <if test="gbDgsGbDisGoodsFatherId != null">`gb_dgs_gb_dis_goods_father_id` = #{gbDgsGbDisGoodsFatherId},
            </if>
            <if test="gbDgsGbDepDisGoodsId != null">`gb_dgs_gb_dep_dis_goods_id` = #{gbDgsGbDepDisGoodsId},</if>
            <if test="gbDgsGbDepartmentOrderId != null">`gb_dgs_gb_department_order_id` = #{gbDgsGbDepartmentOrderId},
            </if>
            <if test="gbDgsWeight != null">`gb_dgs_weight` = #{gbDgsWeight},</if>
            <if test="gbDgsRestWeight != null">`gb_dgs_rest_weight` = #{gbDgsRestWeight},</if>
            <if test="gbDgsDate != null">`gb_dgs_date` = #{gbDgsDate},</if>
            <if test="gbDgsTimeStamp != null">`gb_dgs_time_stamp` = #{gbDgsTimeStamp},</if>
            <if test="gbDgsWeek != null">`gb_dgs_week` = #{gbDgsWeek},</if>
            <if test="gbDgsMonth != null">`gb_dgs_month` = #{gbDgsMonth},</if>
            <if test="gbDgsYear != null">`gb_dgs_year` = #{gbDgsYear},</if>
            <if test="gbDgsReceiveUserId != null">`gb_dgs_receive_user_id` = #{gbDgsReceiveUserId},</if>
            <if test="gbDgsStatus != null">`gb_dgs_status` = #{gbDgsStatus},</if>
            <if test="gbDgsGbPurGoodsId != null">`gb_dgs_gb_pur_goods_id` = #{gbDgsGbPurGoodsId},</if>
            <if test="gbDgsPrice != null">`gb_dgs_price` = #{gbDgsPrice},</if>
            <if test="gbDgsSubtotal != null">`gb_dgs_subtotal` = #{gbDgsSubtotal},</if>
            <if test="gbDgsGbGoodsStockId != null">`gb_dgs_gb_goods_stock_id` = #{gbDgsGbGoodsStockId},</if>
            <if test="gbDgsGbFromDepartmentId != null">`gb_dgs_gb_from_department_id` = #{gbDgsGbFromDepartmentId},</if>
            <if test="gbDgsInventoryDate != null">`gb_dgs_inventory_date` = #{gbDgsInventoryDate},</if>
            <if test="gbDgsInventoryWeek != null">`gb_dgs_inventory_week` = #{gbDgsInventoryWeek},</if>
            <if test="gbDgsInventoryMonth != null">`gb_dgs_inventory_month` = #{gbDgsInventoryMonth},</if>
            <if test="gbDgsInventoryYear != null">`gb_dgs_inventory_year` = #{gbDgsInventoryYear},</if>
            <if test="gbDgsFullTime != null">`gb_dgs_full_time` = #{gbDgsFullTime},</if>
            <if test="gbDgsWarnFullTime != null">`gb_dgs_warn_full_time` = #{gbDgsWarnFullTime},</if>
            <if test="gbDgsWasteFullTime != null">`gb_dgs_waste_full_time` = #{gbDgsWasteFullTime},</if>
            <if test="gbDgsDoWasteFullTime != null">`gb_dgs_do_waste_full_time` = #{gbDgsDoWasteFullTime},</if>
            <if test="gbDgsLossWeight != null">`gb_dgs_loss_weight` = #{gbDgsLossWeight},</if>
            <if test="gbDgsLossSubtotal != null">`gb_dgs_loss_subtotal` = #{gbDgsLossSubtotal},</if>
            <if test="gbDgsDepSettleId != null">`gb_dgs_dep_settle_id` = #{gbDgsDepSettleId},</if>
            <if test="gbDgsReturnWeight != null">`gb_dgs_return_weight` = #{gbDgsReturnWeight},</if>
            <if test="gbDgsReturnSubtotal != null">`gb_dgs_return_subtotal` = #{gbDgsReturnSubtotal},</if>
            <if test="gbDgsOutDate != null">`gb_dgs_out_date` = #{gbDgsOutDate},</if>
            <if test="gbDgsOutFullTime != null">`gb_dgs_out_full_time` = #{gbDgsOutFullTime},</if>
            <if test="gbDgsOutHour != null">`gb_dgs_out_hour` = #{gbDgsOutHour},</if>
            <if test="gbDgsFromDepSettleId != null">`gb_dgs_from_dep_settle_id` = #{gbDgsFromDepSettleId},</if>
            <if test="gbDgsInventoryFullTime != null">`gb_dgs_inventory_full_time` = #{gbDgsInventoryFullTime},</if>
            <if test="gbDgsWarnTimeQuantumName != null">`gb_dgs_warn_time_quantum_name` = #{gbDgsWarnTimeQuantumName},
            </if>
            <if test="gbDgsWasteTimeQuantumName != null">`gb_dgs_waste_time_quantum_name` =
                #{gbDgsWasteTimeQuantumName},
            </if>
            <if test="gbDgsProduceWeight != null">`gb_dgs_produce_weight` = #{gbDgsProduceWeight},</if>
            <if test="gbDgsProduceSubtotal != null">`gb_dgs_produce_subtotal` = #{gbDgsProduceSubtotal},</if>
            <if test="gbDgsGbPriceGoodsId != null">`gb_dgs_gb_price_goods_id` = #{gbDgsGbPriceGoodsId},</if>
            <if test="gbDgsGbPriceSubtotal != null">`gb_dgs_gb_price_subtotal` = #{gbDgsGbPriceSubtotal},</if>
            <if test="gbDgsGbPriceSubtotalScale != null">`gb_dgs_gb_price_subtotal_scale` =
                #{gbDgsGbPriceSubtotalScale},
            </if>
            <if test="gbDgsRestWeightShowStandard != '-99'">`gb_dgs_rest_weight_show_standard` =
                #{gbDgsRestWeightShowStandard},
            </if>
            <if test="gbDgsRestWeightShowStandardName != '-99'">`gb_dgs_rest_weight_show_standard_name` =
                #{gbDgsRestWeightShowStandardName},
            </if>
            <if test="gbDgsBetweenPrice != null">`gb_dgs_between_price` = #{gbDgsBetweenPrice},</if>
            <if test="gbDgsProfitWeight != null">`gb_dgs_profit_weight` = #{gbDgsProfitWeight},</if>
            <if test="gbDgsProfitSubtotal != null">`gb_dgs_profit_subtotal` = #{gbDgsProfitSubtotal},</if>
            <if test="gbDgsSellingPrice != null">`gb_dgs_selling_price` = #{gbDgsSellingPrice},</if>
            <if test="gbDgsSellingSubtotal != null">`gb_dgs_selling_subtotal` = #{gbDgsSellingSubtotal},</if>
            <if test="gbDgsWasteWeight != null">`gb_dgs_waste_weight` = #{gbDgsWasteWeight},</if>
            <if test="gbDgsWasteSubtotal != null">`gb_dgs_waste_subtotal` = #{gbDgsWasteSubtotal},</if>
            <if test="gbDgsWeightGoodsId != null">`gb_dgs_weight_goods_id` = #{gbDgsWeightGoodsId},</if>
            <if test="gbDgsAfterProfitSubtotal != null">`gb_dgs_after_profit_subtotal` = #{gbDgsAfterProfitSubtotal},
            </if>
            <if test="gbDgsCostRate != null">`gb_dgs_cost_rate` = #{gbDgsCostRate},</if>
            <if test="gbDgsNxDistributerId != null">`gb_dgs_nx_distributer_id` = #{gbDgsNxDistributerId},</if>
            <if test="gbDgsProduceSellingSubtotal != null">`gb_dgs_produce_selling_subtotal` =
                #{gbDgsProduceSellingSubtotal},
            </if>
            <if test="gbDgsRestSubtotal != null">`gb_dgs_rest_subtotal` = #{gbDgsRestSubtotal}</if>
        </set>
        where gb_department_goods_stock_id = #{gbDepartmentGoodsStockId}
    </update>

    <delete id="delete">
        delete
        from gb_department_goods_stock
        where gb_department_goods_stock_id = #{value}
    </delete>

    <delete id="deleteBatch">
        delete from gb_department_goods_stock where gb_department_goods_stock_id in
        <foreach item="gbDepartmentGoodsStock" collection="array" open="(" separator="," close=")">
            #{gbDepartmentGoodsStockId}
        </foreach>
    </delete>

</mapper>