<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.nongxinle.dao.NxDepartmentOrdersDao">

    <select id="disGetUnPlanPurchaseApplys" resultMap="unPlanPurchaseOrdersDisFatherGoods">
        select
        dor.nx_department_orders_id,
        dor.nx_DO_nx_goods_id,
        dor.nx_DO_order_user_id,
        dor.nx_DO_apply_date,
        dor.nx_DO_apply_only_time,
        dor.nx_DO_quantity,
        dor.nx_DO_standard,
        dor.nx_DO_remark,
        dor.nx_DO_status,
        dor.nx_DO_purchase_status,
        dor.nx_DO_weight,
        dor.nx_DO_price,
        dor.nx_DO_subtotal,
        dor.nx_DO_apply_full_time,
        dor.nx_DO_arrive_only_date,
        dor.nx_DO_nx_goods_father_id,
        dor.nx_DO_dis_goods_id,
        dor.nx_DO_dep_dis_goods_price,
        dor.nx_DO_department_id,
        dor.nx_DO_distributer_id,
        dor.nx_DO_is_agent,
        dor.nx_DO_purchase_goods_id,
        dor.nx_DO_dep_dis_goods_id,
        dor.nx_DO_gb_department_id,
        dor.nx_DO_gb_department_father_id,
        dor.nx_DO_nx_comm_restraunt_id,
        dor.nx_DO_nx_comm_restraunt_id,
        dor.nx_DO_nx_community_id,
        dor.nx_DO_nx_restraunt_order_id,
        dor.nx_DO_cost_price,
        dor.nx_DO_cost_price_update,
        dor.nx_DO_cost_price_level,
        dor.nx_DO_purchase_status,

        newDor.nx_department_orders_id 'newDor_nx_department_orders_id',
        newDor.nx_DO_quantity 'newDor_nx_DO_quantity',
        newDor.nx_DO_standard 'newDor_nx_DO_standard',
        newDor.nx_DO_remark 'newDor_nx_DO_remark',
        newDor.nx_DO_status 'newDor_nx_DO_status',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',
        newDor.nx_DO_weight 'newDor_nx_DO_weight',
        newDor.nx_DO_price 'newDor_nx_DO_price',
        newDor.nx_DO_subtotal 'newDor_nx_DO_subtotal',
        newDor.nx_DO_dis_goods_id 'newDor_nx_DO_dis_goods_id',

        newDor.nx_DO_dis_goods_grand_id 'newDor_nx_DO_dis_goods_grand_id',
        newDor.nx_DO_dis_goods_father_id 'newDor_nx_DO_dis_goods_father_id',
        newDor.nx_DO_dep_dis_goods_price 'newDor_nx_DO_dep_dis_goods_price',
        newDor.nx_DO_department_id 'newDor_nx_DO_department_id',
        newDor.nx_DO_distributer_id 'newDor_nx_DO_distributer_id',
        newDor.nx_DO_is_agent 'newDor_nx_DO_is_agent',
        newDor.nx_DO_purchase_goods_id 'newDor_nx_DO_purchase_goods_id',
        newDor.nx_DO_gb_department_order_id 'newDor_nx_DO_gb_department_order_id',
        newDor.nx_DO_gb_department_id 'newDor_nx_DO_gb_department_id',
        newDor.nx_DO_gb_department_father_id 'newDor_nx_DO_gb_department_father_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_community_id 'newDor_nx_DO_nx_community_id',
        newDor.nx_DO_nx_restraunt_order_id 'newDor_nx_DO_nx_restraunt_order_id',

        newDor.nx_DO_cost_price 'newDor_nx_DO_cost_price',
        newDor.nx_DO_cost_price_update 'newDor_nx_DO_cost_price_update',
        newDor.nx_DO_cost_price_level 'newDor_nx_DO_cost_price_level',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',

        dfg.nx_distributer_father_goods_id,
        dfg.nx_dfg_father_goods_name,
        dg.nx_distributer_goods_id,
        dg.nx_dg_goods_name,
        dg.nx_dg_goods_brand,
        dg.nx_dg_goods_detail,
        dg.nx_dg_goods_place,
        dg.nx_dg_goods_standardname,
        dg.nx_dg_goods_standard_weight,
        dg.nx_dg_nx_goods_father_color,
        dg.nx_dg_buying_price_is_grade,
        dg.nx_dg_buying_price,
        dg.nx_dg_buying_price_one,
        dg.nx_dg_buying_price_one_update,
        dg.nx_dg_buying_price_two,
        dg.nx_dg_buying_price_two_update,
        dg.nx_dg_buying_price_three,
        dg.nx_dg_buying_price_three_update,
        dg.nx_dg_buying_price_update,

        ds.nx_department_id 'nx_department_id',
        ds.nx_department_name 'nx_department_name',
        ds.nx_department_attr_name 'nx_department_attr_name',
        ds.nx_department_type 'nx_department_type',
        ds.nx_department_father_id 'nx_department_father_id',
        ds.nx_department_is_group_dep 'nx_department_is_group_dep',
        df.nx_department_id 'dd_nx_department_id',
        df.nx_department_name 'dd_nx_department_name',
        df.nx_department_attr_name 'dd_nx_department_attr_name',

        nds.nx_department_id 'nds_nx_department_id',
        nds.nx_department_name 'nds_nx_department_name',
        nds.nx_department_attr_name 'nds_nx_department_attr_name',
        nds.nx_department_type 'nds_nx_department_type',
        nds.nx_department_father_id 'nds_nx_department_father_id',
        nds.nx_department_is_group_dep 'nds_nx_department_is_group_dep',
        ndf.nx_department_id 'ndf_dd_nx_department_id',
        ndf.nx_department_name 'ndf_dd_nx_department_name',
        ndf.nx_department_attr_name 'ndf_dd_nx_department_attr_name',

        nr.nx_restraunt_id,
        nr.nx_restraunt_attr_name,
        nr.nx_restraunt_name,

        ngds.gb_department_id 'nds_gb_department_id',
        ngds.gb_department_name 'nds_gb_department_name',
        ngds.gb_department_attr_name 'nds_gb_department_attr_name',
        ngds.gb_department_type 'nds_gb_department_type',
        ngds.gb_department_father_id 'nds_gb_department_father_id',
        ngds.gb_department_is_group_dep 'nds_gb_department_is_group_dep',
        ngdf.gb_department_id 'ndf_dd_gb_department_id',
        ngdf.gb_department_name 'ndf_dd_gb_department_name',
        ngdf.gb_department_attr_name 'ndf_dd_gb_department_attr_name',
        gds.gb_department_id 'gb_department_id',
        gds.gb_department_name 'gb_department_name',
        gds.gb_department_attr_name 'gb_department_attr_name',
        gds.gb_department_type 'gb_department_type',
        gds.gb_department_father_id 'gb_department_father_id',
        gds.gb_department_is_group_dep 'gb_department_is_group_dep',
        gdf.gb_department_id 'dd_gb_department_id',
        gdf.gb_department_name 'dd_gb_department_name',
        gdf.gb_department_attr_name 'dd_gb_department_attr_name',

        ndnr.nx_restraunt_id 'ndnr_nx_restraunt_id',
        ndnr.nx_restraunt_attr_name 'ndnr_nx_restraunt_attr_name',

        dpg.nx_distributer_purchase_goods_id,
        dpg.nx_DPG_dis_goods_id,
        dpg.nx_DPG_quantity,
        dpg.nx_DPG_status,
        dpg.nx_DPG_orders_amount,
        dpg.nx_DPG_time,
        dpg.nx_DPG_apply_date,
        dpg.nx_DPG_purchase_date,
        dpg.nx_DPG_cost_level,
        dpg.nx_DPG_buy_price,
        purDor.nx_department_orders_id 'purDor_nx_department_orders_id',
        purDor.nx_DO_purchase_goods_id 'purDor_nx_DO_purchase_goods_id',
        purDor.nx_DO_department_id 'purDor_nx_DO_department_id',
        purDor.nx_DO_department_father_id 'purDor_nx_DO_department_father_id',
        purDor.nx_DO_quantity 'purDor_nx_DO_quantity',
        purDor.nx_DO_standard 'purDor_nx_DO_standard',
        purDor.nx_DO_status 'purDor_nx_DO_status',
        purDor.nx_DO_weight 'purDor_nx_DO_weight',
        purDor.nx_DO_price 'purDor_nx_DO_price',
        purDor.nx_DO_subtotal 'purDor_nx_DO_subtotal',
        purDor.nx_DO_gb_department_order_id 'purDor_nx_DO_gb_department_order_id',
        purDor.nx_DO_gb_department_id 'purDor_nx_DO_gb_department_id',
        purDor.nx_DO_gb_department_father_id 'purDor_nx_DO_gb_department_father_id',
        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',
        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',
        purDor.nx_DO_nx_community_id 'purDor_nx_DO_nx_community_id',
        purDor.nx_DO_nx_restraunt_order_id 'purDor_nx_DO_nx_restraunt_order_id',

        needNotDor.nx_department_orders_id 'needNotDor_nx_department_orders_id',
        needNotDor.nx_DO_remark 'needNotDor_nx_DO_remark',
        needNotDor.nx_DO_status 'needNotDor_nx_DO_status',
        needNotDor.nx_department_orders_id 'needNotDor_nx_department_id',
        needNotDor.nx_DO_purchase_goods_id 'needNotDor_nx_Do_purchase_goods_id',
        needNotDor.nx_DO_department_id 'needNotDor_nx_DO_department_id',
        needNotDor.nx_DO_department_father_id 'needNotDor_nx_DO_department_father_id',
        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_father_id',
        needNotDor.nx_DO_quantity 'needNotDor_nx_DO_quantity',
        needNotDor.nx_DO_standard 'needNotDor_nx_DO_standard',
        needNotDor.nx_DO_weight 'needNotDor_nx_DO_weight',
        needNotDor.nx_DO_price 'needNotDor_nx_DO_price',
        needNotDor.nx_DO_subtotal 'needNotDor_nx_DO_subtotal',
        needNotDor.nx_DO_dis_goods_id 'needNotDor_nx_DO_dis_goods_id',
        needNotDor.nx_DO_purchase_status 'needNotDor_nx_DO_purchase_status',
        needNotDor.nx_DO_cost_price 'needNotDor_nx_DO_cost_price',
        needNotDor.nx_DO_cost_price_level 'needNotDor_nx_DO_cost_price_level',
        needNotDor.nx_DO_cost_price_update 'needNotDor_nx_DO_cost_price_update',

        needNotDor.nx_DO_dep_dis_goods_price 'needNotDor_nx_DO_dep_dis_goods_price',
        needNotDor.nx_DO_distributer_id 'needNotDor_nx_DO_distributer_id',

        needNotDor.nx_DO_gb_department_order_id 'needNotDor_nx_DO_gb_department_order_id',
        needNotDor.nx_DO_gb_department_id 'needNotDor_nx_DO_gb_department_id',
        needNotDor.nx_DO_gb_department_father_id 'needNotDor_nx_DO_gb_department_father_id',
        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_id',
        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_id',
        needNotDor.nx_DO_nx_community_id 'needNotDor_nx_DO_nx_community_id',
        needNotDor.nx_DO_nx_restraunt_order_id 'needNotDor_nx_DO_nx_restraunt_order_id',


        purDs.nx_department_id 'purDs_nx_department_id',
        purDs.nx_department_father_id 'purDs_nx_department_father_id',
        purDs.nx_department_name 'purDs_nx_department_name',
        purDs.nx_department_attr_name 'purDs_nx_department_attr_name',
        purDf.nx_department_id 'purDf_nx_department_id',
        purDf.nx_department_name 'purDf_nx_department_name',
        purDf.nx_department_attr_name 'purDf_nx_department_attr_name',
        purGbDs.gb_department_id 'purGbDs_gb_department_id',
        purGbDs.gb_department_name 'purGbDs_gb_department_name',
        purGbDf.gb_department_id 'purGbDf_gb_department_id',
        purGbDf.gb_department_name 'purGbDf_gb_department_name',
        purGbDf.gb_department_attr_name 'purGbDf_gb_department_attr_name',
        purNr.nx_restraunt_id 'purNr_nx_restraunt_id',
        purNr.nx_restraunt_name 'purNr_nx_restraunt_name',
        purNr.nx_restraunt_attr_name 'purNr_nx_restraunt_attr_name',

        dpgOrder.nx_distributer_purchase_goods_id 'order_nx_distributer_purchase_goods_id',
        dpgOrder.nx_DPG_distributer_id 'order_nx_DPG_distributer_id',
        dpgOrder.nx_DPG_cost_level 'order_nx_DPG_cost_level',
        dpgOrder.nx_DPG_status 'order_nx_DPG_status',
        dpgOrder.nx_DPG_dis_goods_id 'order_nx_DPG_dis_goods_id',
        dpgOrder.nx_DPG_orders_amount 'order_nx_DPG_orders_amount'

        from nx_department_orders as dor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_purchase_goods as dpg on dpg.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and dpg.nx_DPG_orders_amount is null

        left join nx_distributer_father_goods as dfg on dfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_father_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        dfg.nx_dfg_fathers_father_id


        left join nx_department_orders as newDor on newDor.nx_DO_dis_goods_id = dg.nx_distributer_goods_id
        and newDor.nx_DO_purchase_status = 0
        left join nx_department_orders as needNotDor on needNotDor.nx_DO_dis_goods_id = dg.nx_distributer_goods_id
        and needNotDor.nx_DO_purchase_goods_id = -1 and needNotDor.nx_DO_status &lt; 3

        left join nx_distributer_purchase_goods as dpgOrder on dpgOrder.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and dpgOrder.nx_DPG_orders_amount is not null and dpgOrder.nx_DPG_status &lt; 4
        left join nx_department_orders as purDor on purDor.nx_DO_purchase_goods_id =
        dpgOrder.nx_distributer_purchase_goods_id
        and purDor.nx_DO_status &lt; 3

        left join nx_department as ds on ds.nx_department_id = newDor.nx_DO_department_id
        left join nx_department as df on df.nx_department_id = ds.nx_department_father_id
        left join gb_department as gds on gds.gb_department_id = newDor.nx_DO_gb_department_id
        left join gb_department as gdf on gdf.gb_department_id = newDor.nx_DO_gb_department_father_id
        left join nx_restraunt as nr on nr.nx_restraunt_id = newDor.nx_DO_nx_comm_restraunt_id
        left join nx_department as nds on nds.nx_department_id = needNotDor.nx_DO_department_id
        left join nx_department as ndf on ndf.nx_department_id = nds.nx_department_father_id
        left join gb_department as ngds on ngds.gb_department_id = needNotDor.nx_DO_gb_department_id
        left join gb_department as ngdf on ngdf.gb_department_id = needNotDor.nx_DO_gb_department_father_id
        left join nx_restraunt as ndnr on ndnr.nx_restraunt_id = needNotDor.nx_DO_nx_comm_restraunt_id
        left join nx_department as purDs on purDs.nx_department_id = purDor.nx_DO_department_id
        left join nx_department as purDf on purDf.nx_department_id = purDor.nx_DO_department_father_id
        left join gb_department as purGbDs on purGbDs.gb_department_id = purDor.nx_DO_gb_department_id
        left join gb_department as purGbDf on purGbDf.gb_department_id = purDor.nx_DO_gb_department_father_id
        left join nx_restraunt as purNr on purNr.nx_restraunt_id = purDor.nx_DO_nx_comm_restraunt_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>

            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null">
                and dor.nx_DO_purchase_goods_id = #{purType}
            </if>

        </where>
        order by great.nx_dfg_father_goods_sort, dfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort, ds.nx_department_id,
        df.nx_department_id,
        nds.nx_department_id,ndf.nx_department_id,nr.nx_restraunt_id, ngds.gb_department_id,ngdf.gb_department_id,
        gds.gb_department_id,gdf.gb_department_id, ndnr.nx_restraunt_id,purDs.nx_department_id,
        purGbDs.gb_department_id, purGbDf.gb_department_id,purNr.nx_restraunt_id
    </select>


    <select id="queryDisOrdersByParams" resultMap="applys">
        select * from nx_department_orders as dor
        left join nx_department_dis_goods as ddg on ddg.nx_department_dis_goods_id = dor.nx_DO_dep_dis_goods_id
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_father_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id
        left join nx_department_user as du on du.nx_department_user_id = dor.nx_DO_order_user_id
        left join nx_distributer_standard as ds on ds.nx_DS_dis_goods_id = dg.nx_distributer_goods_id
        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_distributer_purchase_goods_id =
        dor.nx_DO_purchase_goods_id
        left join nx_distributer_user as ndu on ndu.nx_distributer_user_id = dor.nx_DO_is_agent

        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="depFatherId != null">
                and dor.nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and dor.nx_DO_department_id = #{depId}
            </if>
            <if test="todayOrder != null">
                and dor.nx_DO_today_order &gt;  #{todayOrder}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and dor.nx_DO_status &gt;  #{dayuStatus}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="onlyDate != null">
                and dor.nx_DO_arrive_only_date &gt; #{onlyDate}
            </if>

            <if test="applyDate != null">
                and dor.nx_DO_apply_date &gt; #{applyDate}
            </if>
            <if test="arriveDateDayu != null">
                and dor.nx_DO_apply_date &gt; #{arriveDateDayu}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="userId != null">
                and dor.nx_DO_order_user_id = #{userId}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGrandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{disGrandId}
            </if>
            <if test="depDisGoodsId != null">
                and dor.nx_DO_dep_dis_goods_id = #{depDisGoodsId}
            </if>
            <if test="nxGoodsId != null">
                and dor.nx_DO_nx_goods_id = #{nxGoodsId}
            </if>

            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="purGoodsId != null ">
                and dor.nx_DO_purchase_goods_id = #{purGoodsId}
            </if>
            <if test="purchaseAuto != null">
                and dg.nx_dg_purchase_auto = #{purchaseAuto}
            </if>
            <if test="billId != null">
                and dor.nx_DO_bill_id = #{billId}
            </if>
            <if test="weightId != null and weightId != -1">
                and dor.nx_DO_weight_id = #{weightId}
            </if>
            <if test="weightId != null and weightId == -1">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="inputType != null">
                and ndpg.nx_DPG_input_type = #{inputType}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>

            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id &gt; 0
            </if>

            <if test="costPrice != null and costPrice == 1">
                and dor.nx_DO_cost_price is not null and dor.nx_DO_cost_price &gt; 0
            </if>
        </where>

        <if test="orderBy != null and orderBy == 'time'">
            order by dor.nx_DO_today_order
        </if>

        <if test="orderBy == null">
            order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort
        </if>

    </select>

    <select id="queryDistributerTodayDepartments" resultMap="fatherDep">
        select *,
        ds.nx_department_id 'ds_nx_department_id',
        ds.nx_department_name 'ds_nx_department_name',
        ds.nx_department_type 'ds_nx_department_type',
        ds.nx_department_father_id 'ds_nx_department_father_id',
        ds.nx_department_is_group_dep 'ds_nx_department_is_group_dep',
        ds.nx_department_settle_type 'ds_nx_department_settle_type',
        ds.nx_department_attr_name 'ds_nx_department_attr_name',
        ndpg.nx_DPG_distributer_id,
        ndpg.nx_DPG_status,
        ndpg.nx_DPG_quantity,
        ndpg.nx_DPG_orders_amount,
        ndpg.nx_DPG_buy_price,
        ndpg.nx_DPG_batch_id,
        ndpg.nx_DPG_nx_weight_id,
        dorDpg.nx_distributer_purchase_goods_id 'dorDpg_nx_distributer_purchase_goods_id',
        dorDpg.nx_DPG_quantity 'dorDpg_nx_DPG_quantity',
        dorDpg.nx_DPG_status 'dorDpg_nx_DPG_status',
        dorDpg.nx_DPG_nx_weight_id 'dorDpg_nx_DPG_weight_id',
        dorDpg.nx_DPG_batch_id 'dorDpg_nx_DPG_batch_id'
        from nx_department_orders as dor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_father_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id
        left join nx_department_user as du on du.nx_department_user_id = dor.nx_DO_order_user_id
        left join nongxinle.nx_department as df on df.nx_department_id = dor.nx_DO_department_father_id
        left join nx_department as ds on ds.nx_department_id = dor.nx_DO_department_id

        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and ndpg.nx_DPG_status &lt; 4
        left join nx_distributer_purchase_goods as dorDpg on dorDpg.nx_distributer_purchase_goods_id =
        dor.nx_DO_purchase_goods_id
        <where>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_Date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>

            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id &gt; 0
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status= #{equalPurStatus}
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="purGoodsId != null and purGoodsId == 1">
                and nx_DO_purchase_goods_id is not null and nx_DO_purchase_goods_id != -1
            </if>
            <if test="purGoodsId != null and purGoodsId == 0">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purGoodsId != null and purGoodsId == -1">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="hasWeight != null and hasWeight == 1">
                and nx_DO_weight is not null
            </if>
            <if test="hasWeight != null and hasWeight == -1">
                and nx_DO_weight is null
            </if>
            <if test="hasPrice != null and hasPrice == 1">
                and nx_DO_price is not null
            </if>
            <if test="hasPrice != null and hasPrice == -1">
                and nx_DO_price is null
            </if>
            and dor.nx_DO_gb_department_id = -1
        </where>
        order by ds.nx_department_id , great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort,
        dg.nx_dg_goods_sort,
        ndpg.nx_distributer_purchase_goods_id
    </select>


    <select id="queryObject" resultMap="applys">
        select *
        from nx_department_orders as dor
                 left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        where nx_department_orders_id = #{value}

    </select>

    <select id="queryList" resultType="com.nongxinle.entity.NxDepartmentOrdersEntity">
        select * from nx_department_orders
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="queryTotal" resultType="int">
        select count(*)
        from nx_department_orders
    </select>

    <resultMap id="nxGoods" type="NxGoodsEntity">
        <id property="nxGoodsId" column="nx_goods_id"/>
        <result property="nxGoodsIsHidden" column="nx_goods_is_hidden"/>
        <result property="nxGoodsIsHidden" column="nx_goods_is_hidden"/>
		<result property="nxGoodsSonsSort" column="nx_goods_sons_sort"/>
        <result property="nxGoodsGrandId" column="nx_goods_grand_id"/>
        <result property="nxGoodsIsOldestSon" column="nx_goods_is_oldest_son"/>
        <result property="nxGoodsLevel" column="nx_goods_level"/>
        <result property="nxGoodsLevel" column="nx_goods_level"/>
        <result property="nxGoodsName" column="nx_goods_name"/>
        <result property="nxGoodsDetail" column="nx_goods_detail"/>
        <result property="nxGoodsFile" column="nx_goods_file"/>
        <result property="nxGoodsFileBig" column="nx_goods_file_big"/>
        <result property="nxGoodsFileBig" column="nx_goods_file_big"/>
        <result property="nxGoodsStandardname" column="nx_goods_standardname"/>
        <result property="nxGoodsFatherId" column="nx_goods_father_id"/>
        <result property="nxGoodsStandardAmount" column="nx_goods_standard_amount"/>
        <result property="nxGoodsPinyin" column="nx_goods_pinyin"/>
        <result property="nxGoodsPy" column="nx_goods_py"/>
    </resultMap>

    <resultMap id="orderUser" type="NxDepartmentUserEntity">
        <id property="nxDepartmentUserId" column="nx_department_user_id"/>
        <result property="nxDuLoginTimes" column="nx_DU_login_times"/>
        <result property="nxDuWxNickName" column="nx_DU_wx_nick_name"/>
        <result property="nxDuWxAvartraUrl" column="nx_DU_wx_avartra_url"/>
        <result property="nxDuUrlChange" column="nx_DU_url_change"/>
    </resultMap>

    <resultMap id="fatherDepartment" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="dd_nx_department_id"/>
        <result property="nxDepartmentName" column="dd_nx_department_name"/>
        <result property="nxDepartmentAttrName" column="dd_nx_department_attr_name"/>
        <result property="nxDepartmentType" column="dd_nx_department_type"/>
        <result property="nxDepartmentSettleType" column="dd_nx_department_settle_type"/>
        <result property="nxDepartmentFilePath" column="dd_nx_department_file_path"/>
        <result property="nxDepartmentFatherId" column="dd_nx_department_father_id"/>
        <result property="nxDepartmentIsGroupDep" column="dd_nx_department_is_group_dep"/>
    </resultMap>
    <resultMap id="fatherDepartmentGb" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="dd_gb_department_id"/>
        <result property="gbDepartmentName" column="dd_gb_department_name"/>
        <result property="gbDepartmentAttrName" column="dd_gb_department_attr_name"/>
        <result property="gbDepartmentType" column="dd_gb_department_type"/>
        <result property="gbDepartmentSettleType" column="dd_gb_department_settle_type"/>
        <result property="gbDepartmentFilePath" column="dd_gb_department_file_path"/>
        <result property="gbDepartmentFatherId" column="dd_gb_department_father_id"/>
        <result property="gbDepartmentIsGroupDep" column="dd_gb_department_is_group_dep"/>
    </resultMap>

    <resultMap id="orderGbDepartment" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentSettleType" column="gb_department_settle_type"/>
        <result property="gbDepartmentFatherId" column="gb_department_father_id"/>
        <result property="gbDepartmentFilePath" column="gb_department_file_path"/>
        <result property="gbDepartmentIsGroupDep" column="gb_department_is_group_dep"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
        <association property="fatherGbDepartmentEntity" resultMap="fatherDepartmentGb"/>
    </resultMap>

    <resultMap id="orderDepartment" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="nx_department_id"/>
        <result property="nxDepartmentPromotionGoodsId" column="nx_department_promotion_goods_id"/>
        <result property="nxDepartmentPrintName" column="nx_department_print_name"/>
        <result property="nxDepartmentType" column="nx_department_type"/>
        <result property="nxDepartmentName" column="nx_department_name"/>
        <result property="nxDepartmentAttrName" column="nx_department_attr_name"/>
        <result property="nxDepartmentType" column="nx_department_type"/>
        <result property="nxDepartmentSettleType" column="nx_department_settle_type"/>
        <result property="nxDepartmentFatherId" column="nx_department_father_id"/>
        <result property="nxDepartmentFilePath" column="nx_department_file_path"/>
        <result property="nxDepartmentIsGroupDep" column="nx_department_is_group_dep"/>
        <association property="fatherDepartmentEntity" resultMap="fatherDepartment"/>
    </resultMap>

    <resultMap id="depStandard" type="NxDepartmentStandardEntity">
        <id property="nxDepartmentStandardId" column="nx_department_standard_id"/>
        <result property="nxDdsStandardName" column="nx_DDS_standard_name"/>
    </resultMap>
    <resultMap id="depDisGoods" type="NxDepartmentDisGoodsEntity">
        <id property="nxDepartmentDisGoodsId" column="nx_department_dis_goods_id"/>
        <result property="nxDdgDisGoodsGrandId" column="nx_DDG_dis_goods_grand_id"/>
        <result property="nxDdgDepGoodsName" column="nx_DDG_dep_goods_name"/>
        <result property="nxDdgDepGoodsStandardname" column="nx_DDG_dep_goods_standardname"/>
        <result property="nxDdgDepGoodsBrand" column="nx_DDG_dep_goods_brand"/>
        <result property="nxDdgDepGoodsDetail" column="nx_DDG_dep_goods_detail"/>
        <result property="nxDdgDepGoodsPlace" column="nx_DDG_dep_goods_place"/>
        <result property="nxDdgDisGoodsId" column="nx_DDG_dis_goods_id"/>
        <result property="nxDdgOrderPrice" column="nx_DDG_order_price"/>
        <result property="nxDdgOrderDate" column="nx_DDG_order_date"/>
        <result property="nxDdgOrderQuantity" column="nx_DDG_order_quantity"/>
        <result property="nxDdgOrderStandard" column="nx_DDG_order_standard"/>
        <result property="nxDdgOrderCostPrice" column="nx_DDG_order_cost_price"/>
        <result property="nxDdgDepartmentFatherId" column="nx_DDG_department_father_id"/>
        <result property="nxDdgDepartmentId" column="nx_DDG_department_id"/>
        <!--        <association property="nxDistributerGoodsEntity" resultMap="disGoods"/>-->
        <collection property="nxDepStandardEntities" resultMap="depStandard"/>

    </resultMap>
    <resultMap id="inDepGoods" type="NxDepartmentIndependentGoodsEntity">
        <id property="nxDepartmentIndependentGoodsId" column="nx_department_independent_goods_id"/>
        <result property="nxDigGoodsName" column="nx_DIG_goods_name"/>
        <result property="nxDigGoodsStandardname" column="nx_DIG_goods_standardname"/>
    </resultMap>

    <resultMap id="disStandards" type="NxDistributerStandardEntity">
        <id property="nxDistributerStandardId" column="nx_distributer_standard_id"/>
        <result property="nxDsStandardName" column="nx_DS_standard_name"/>
    </resultMap>

    <resultMap id="disGoods" type="NxDistributerGoodsEntity">
       <id property="nxDistributerGoodsId" column="nx_distributer_goods_id"/>
        <result property="nxDgWillPriceOneWeight" column="nx_dg_will_price_one_weight"/>
        <result property="nxDgWillPriceTwoWeight" column="nx_dg_will_price_two_weight"/>
        <result property="nxDgWillPriceThreeWeight" column="nx_dg_will_price_three_weight"/>
		<result property="nxDgGoodsStatus" column="nx_dg_goods_status"/>
		<result property="nxDgWillPriceOne" column="nx_dg_will_price_one"/>
        <result property="nxDgWillPriceTwo" column="nx_dg_will_price_two"/>
		<result property="nxDgWillPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
		<result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
		<result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgGoodsSonsSort" column="nx_dg_goods_sons_sort"/>
		<result property="nxDgPurchaseAuto" column="nx_dg_purchase_auto"/>
        <result property="nxDgGoodsSort" column="nx_dg_goods_sort"/>
        <result property="nxDgWillPrice" column="nx_dg_will_price"/>
        <result property="nxDgPriceFirstDay" column="nx_dg_price_first_day"/>
        <result property="nxDgPriceSecondDay" column="nx_dg_price_second_day"/>
        <result property="nxDgPriceThirdDay" column="nx_dg_price_third_day"/>
        <result property="nxDgDfgGoodsGrandId" column="nx_dg_dfg_goods_grand_id"/>
        <result property="nxDgDfgGoodsFatherId" column="nx_dg_dfg_goods_father_id"/>
        <result property="nxDgGoodsFile" column="nx_dg_goods_file"/>
        <result property="nxDgGoodsFileLarge" column="nx_dg_goods_file_large"/>
        <result property="nxDgGoodsName" column="nx_dg_goods_name"/>
        <result property="nxDgGoodsStandardname" column="nx_dg_goods_standardname"/>
        <result property="nxDgGoodsStandardWeight" column="nx_dg_goods_standard_weight"/>
        <result property="nxDgGoodsBrand" column="nx_dg_goods_brand"/>
        <result property="nxDgGoodsDetail" column="nx_dg_goods_detail"/>
        <result property="nxDgGoodsPlace" column="nx_dg_goods_place"/>
        <result property="nxDgGoodsPy" column="nx_dg_goods_py"/>
        <result property="nxDgPurchaseAuto" column="nx_dg_purchase_auto"/>
        <result property="nxDgNxGoodsFatherColor" column="nx_dg_nx_goods_father_color"/>
        <result property="nxDgDfgGoodsFatherId" column="nx_dg_dfg_goods_father_id"/>
        <result property="nxDgPurchaseAuto" column="nx_dg_purchase_auto"/>
        <result property="nxDgBuyingPrice" column="nx_dg_buying_price"/>
        <result property="nxDgPriceProfitOne" column="nx_dg_price_profit_one"/>
        <result property="nxDgPriceProfitTwo" column="nx_dg_price_profit_two"/>
        <result property="nxDgPriceProfitThree" column="nx_dg_price_profit_three"/>
        <result property="nxDgSupplierId" column="nx_dg_supplier_id"/>
       <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <result property="nxDgBuyingPriceIsGrade" column="nx_dg_buying_price_is_grade"/>
        <result property="nxDgBuyingPriceOne" column="nx_dg_buying_price_one"/>
        <result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
        <result property="nxDgBuyingPriceTwo" column="nx_dg_buying_price_two"/>
        <result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
        <result property="nxDgBuyingPriceThree" column="nx_dg_buying_price_three"/>
        <result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <collection property="unPurGoodsDisGoodsList" resultMap="onlyPurGoods"/>
        <collection property="nxDistributerStandardEntities" resultMap="disStandards"/>
    </resultMap>

    <resultMap id="orderPurGoods" type="NxDistributerPurchaseGoodsEntity">
        <id property="nxDistributerPurchaseGoodsId" column="dorDpg_nx_distributer_purchase_goods_id"/>
        <result property="nxDpgDisGoodsId" column="dorDpg_nx_DPG_dis_goods_id"/>
        <result property="nxDpgDisGoodsFatherId" column="dorDpg_nx_DPG_dis_goods_father_id"/>
        <result property="nxDpgQuantity" column="dorDpg_nx_DPG_quantity"/>
        <result property="nxDpgStandard" column="dorDpg_nx_DPG_standard"/>
        <result property="nxDpgBuyUserId" column="dorDpg_nx_DPG_buy_user_id"/>
        <result property="nxDpgStatus" column="dorDpg_nx_DPG_status"/>
        <result property="nxDpgBuyPrice" column="dorDpg_nx_DPG_buy_price"/>
        <result property="nxDpgPurchaseType" column="dorDpg_nx_DPG_purchase_type"/>
        <result property="nxDpgOrdersAmount" column="dorDpg_nx_DPG_orders_amount"/>
        <result property="nxDpgTypeAddUserId" column="dorDpg_nx_DPG_type_add_user_id"/>
        <result property="nxDpgInputType" column="dorDpg_nx_DPG_input_type"/>
        <result property="nxDpgTime" column="dorDpg_nx_DPG_time"/>
        <result property="nxDpgBatchId" column="dorDpg_nx_DPG_batch_id"/>
        <result property="nxDpgNxWeightId" column="dorDpg_nx_DPG_weight_id"/>
        <result property="nxDpgDistributerId" column="dorDpg_nx_DPG_distributer_id"/>
        <result property="nxDpgInputType" column="dorDpg_nx_DPG_input_type"/>
    </resultMap>

    <resultMap id="weight" type="NxDistributerWeightEntity">
        <id property="nxDistributerWeightId" column="nx_distributer_weight_id"/>
        <result property="nxDwItemCount" column="nx_dw_item_count"/>
        <result property="nxDwItemFinishCount" column="nx_dw_item_finish_count"/>
        <result property="nxDwDisId" column="nx_dw_dis_id"/>
        <result property="nxDwDate" column="nx_dw_date"/>
        <result property="nxDwStatus" column="nx_dw_status"/>
        <result property="nxDwSubtotal" column="nx_dw_subtotal"/>
        <result property="nxDwWeightTotal" column="nx_dw_weight_total"/>
        <result property="nxDwUserId" column="nx_dw_user_id"/>
        <result property="nxDwOrderNames" column="nx_dw_order_names"/>
        <result property="nxDwDepFatherId" column="nx_dw_dep_father_id"/>
        <result property="nxDwGbDepFatherId" column="nx_dw_gb_dep_father_id"/>
        <result property="nxDwResFatherId" column="nx_dw_res_father_id"/>
        <result property="nxDwTradeNo" column="nx_dw_trade_no"/>
    </resultMap>

    <resultMap id="gbOrder" type="GbDepartmentOrdersEntity">
        <id property="gbDepartmentOrdersId" column="gb_department_orders_id"/>
        <result property="gbDoSellingPrice" column="gb_DO_selling_price"/>
        <result property="gbDoSellingSubtotal" column="gb_DO_selling_subtotal"/>
        <result property="gbDoOrderUserId" column="gb_DO_order_user_id"/>
        <result property="gbDoQuantity" column="gb_DO_quantity"/>
        <result property="gbDoStandard" column="gb_DO_standard"/>
        <result property="gbDoDsStandardScale" column="gb_DO_ds_standard_scale"/>
        <result property="gbDoDsStandardId" column="gb_DO_ds_standard_id"/>
        <result property="gbDoRemark" column="gb_DO_remark"/>
        <result property="gbDoWeight" column="gb_DO_weight"/>
        <result property="gbDoScaleWeight" column="gb_DO_scale_weight"/>
        <result property="gbDoScalePrice" column="gb_DO_scale_price"/>
        <result property="gbDoPrice" column="gb_DO_price"/>
        <result property="gbDoSubtotal" column="gb_DO_subtotal"/>
        <result property="gbDoStatus" column="gb_DO_status"/>
        <result property="gbDoBuyStatus" column="gb_DO_buy_status"/>
        <result property="gbDoGoodsType" column="gb_DO_goods_type"/>
        <result property="gbDoDgsrReturnId" column="gb_DO_dgsr_return_id"/>
        <result property="gbDoPurchaseGoodsId" column="gb_DO_purchase_goods_id"/>
        <result property="gbDoDepartmentFatherId" column="gb_DO_department_father_id"/>
        <result property="gbDoDisGoodsId" column="gb_DO_dis_goods_id"/>
        <result property="gbDoDepartmentId" column="gb_DO_department_id"/>
        <result property="gbDoDepDisGoodsId" column="gb_DO_dep_dis_goods_id"/>
        <result property="gbDoOrderType" column="gb_DO_order_type"/>
        <result property="gbDoBillId" column="gb_DO_bill_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_receive_user_id"/>
        <result property="gbDoPurchaseUserId" column="gb_DO_purchase_user_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_return_user_id"/>
        <result property="gbDoWeightTotalId" column="gb_DO_weight_total_id"/>
        <result property="gbDoWeightGoodsId" column="gb_DO_weight_goods_id"/>
        <result property="gbDoPriceDifferent" column="gb_DO_price_different"/>
        <association property="gbDepartmentEntity" resultMap="gbDepartment"/>
    </resultMap>


    <resultMap id="gbPurGoods" type="GbDistributerPurchaseGoodsEntity">
        <id property="gbDistributerPurchaseGoodsId" column="gb_distributer_purchase_goods_id"/>
        <result property="gbDpgPurchaseNxDistributerId" column="gb_DPG_purchase_nx_distributer_id"/>
        <result property="gbDpgOrdersFinishAmount" column="gb_DPG_orders_finish_amount"/>
        <result property="gbDpgWeightId" column="gb_DPG_weight_id"/>
        <result property="gbDpgDisGoodsId" column="gb_DPG_dis_goods_id"/>
        <result property="gbDpgDisGoodsFatherId" column="gb_DPG_dis_goods_father_id"/>
        <result property="gbDpgQuantity" column="gb_DPG_quantity"/>
        <result property="gbDpgStandard" column="gb_DPG_standard"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgStatus" column="gb_DPG_status"/>
        <result property="gbDpgBuyPrice" column="gb_DPG_buy_price"/>
        <result property="gbDpgBuyScalePrice" column="gb_Dpg_buy_scale_price"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_Dpg_buy_scale_quantity"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgBuyQuantity" column="gb_DPG_buy_quantity"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgOrdersAmount" column="gb_DPG_orders_amount"/>
        <result property="gbDpgTypeAddUserId" column="gb_DPG_type_add_user_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgTime" column="gb_DPG_time"/>
        <result property="gbDpgDistributerId" column="gb_DPG_distributer_id"/>
        <result property="gbDpgInputType" column="gb_DPG_input_type"/>
        <result property="gbDpgPurchaseType" column="gb_DPG_purchase_type"/>
        <result property="gbDpgPayType" column="gb_DPG_pay_type"/>
        <result property="gbDpgPurchaseFullTime" column="gb_DPG_purchase_full_time"/>
        <result property="gbDpgBuySubtotal" column="gb_DPG_buy_subtotal"/>
        <result property="gbDpgPurchaseMonth" column="gb_DPG_purchase_month"/>
        <result property="gbDpgPurchaseDate"  column="gb_DPG_purchase_date"/>
        <result property="gbDpgPurchaseYear" column="gb_DPG_purchase_year"/>
        <result property="gbDpgDisGoodsPriceId" column="gb_DPG_dis_goods_price_id"/>
        <result property="gbDpgPurUserId" column="gb_DPG_pur_user_id"/>
        <result property="gbDpgPurchaseDepartmentId" column="gb_DPG_purchase_department_id"/>
        <result property="gbDpgPurchaseWeek" column="gb_DPG_purchase_week"/>
        <result property="gbDpgPurchaseWeekYear" column="gb_DPG_purchase_week_year"/>
        <result property="gbDpgBatchId" column="gb_DPG_batch_id"/>
        <result property="gbDpgBuyScaleQuantity" column="gb_DPG_buy_scale_quantity"/>
        <result property="gbDpgBuyScale" column="gb_DPG_buy_scale"/>
        <result property="gbDpgBuyScalePrice" column="gb_DPG_buy_scale_price"/>
        <result property="gbDpgBuyPriceReason" column="gb_DPG_buy_price_reason"/>
        <result property="gbDpgWarnFullTime" column="gb_DPG_warn_full_time"/>
        <result property="gbDpgWasteFullTime" column="gb_DPG_waste_full_time"/>
        <collection property="gbDepartmentOrdersEntities" resultMap="gbOrder"/>
    </resultMap>

    <resultMap id="gbOrderWithPurGoods" type="GbDepartmentOrdersEntity">
        <id property="gbDepartmentOrdersId" column="gb_department_orders_id"/>
        <result property="gbDoSellingPrice" column="gb_DO_selling_price"/>
        <result property="gbDoSellingSubtotal" column="gb_DO_selling_subtotal"/>
        <result property="gbDoOrderUserId" column="gb_DO_order_user_id"/>
        <result property="gbDoQuantity" column="gb_DO_quantity"/>
        <result property="gbDoStandard" column="gb_DO_standard"/>
        <result property="gbDoDsStandardScale" column="gb_DO_ds_standard_scale"/>
        <result property="gbDoDsStandardId" column="gb_DO_ds_standard_id"/>
        <result property="gbDoRemark" column="gb_DO_remark"/>
        <result property="gbDoWeight" column="gb_DO_weight"/>
        <result property="gbDoScaleWeight" column="gb_DO_scale_weight"/>
        <result property="gbDoScalePrice" column="gb_DO_scale_price"/>
        <result property="gbDoPrice" column="gb_DO_price"/>
        <result property="gbDoSubtotal" column="gb_DO_subtotal"/>
        <result property="gbDoStatus" column="gb_DO_status"/>
        <result property="gbDoBuyStatus" column="gb_DO_buy_status"/>
        <result property="gbDoGoodsType" column="gb_DO_goods_type"/>
        <result property="gbDoDgsrReturnId" column="gb_DO_dgsr_return_id"/>
        <result property="gbDoPurchaseGoodsId" column="gb_DO_purchase_goods_id"/>
        <result property="gbDoDepartmentFatherId" column="gb_DO_department_father_id"/>
        <result property="gbDoDisGoodsId" column="gb_DO_dis_goods_id"/>
        <result property="gbDoDepartmentId" column="gb_DO_department_id"/>
        <result property="gbDoDepDisGoodsId" column="gb_DO_dep_dis_goods_id"/>
        <result property="gbDoOrderType" column="gb_DO_order_type"/>
        <result property="gbDoBillId" column="gb_DO_bill_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_receive_user_id"/>
        <result property="gbDoPurchaseUserId" column="gb_DO_purchase_user_id"/>
        <result property="gbDoReceiveUserId" column="gb_DO_return_user_id"/>
        <result property="gbDoWeightTotalId" column="gb_DO_weight_total_id"/>
        <result property="gbDoWeightGoodsId" column="gb_DO_weight_goods_id"/>
        <result property="gbDoPriceDifferent" column="gb_DO_price_different"/>
        <association property="gbDepartmentEntity" resultMap="needNotBuyGbDeps"/>
        <association property="gbDistributerPurchaseGoodsEntity" resultMap="gbPurGoods"/>
    </resultMap>


    <resultMap id="applysWithGb" type="NxDepartmentOrdersEntity">
         <id property="nxDepartmentOrdersId" column="nx_department_orders_id"/>
        <result property="nxDoGoodsName" column="nx_DO_goods_name"/>
        <result property="nxDoExpcetPrice" column="nx_DO_expect_price"/>
        <result property="nxDoPriceDifferent" column="nx_DO_price_different"/>
        <result property="nxDoTodayOrder" column="nx_DO_today_order"/>
        <result property="nxDoPrintStandard" column="nx_DO_print_standard"/>
        <result property="nxDoGoodsType" column="nx_DO_goods_type"/>
        <result property="nxDoDisGoodsGrandId" column="nx_DO_dis_goods_grand_id"/>
        <result property="nxDoGbDepartmentOrderId" column="nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDistributerId" column="nx_DO_gb_distributer_id"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoNxGoodsId" column="nx_DO_nx_goods_id"/>
        <result property="nxDoOrderUserId" column="nx_DO_order_user_id"/>
        <result property="nxDoApplyDate" column="nx_DO_apply_date"/>
        <result property="nxDoApplyOnlyTime" column="nx_DO_apply_only_time"/>
        <result property="nxDoApplyFullTime" column="nx_DO_apply_full_time"/>
        <result property="nxDoArriveOnlyDate" column="nx_DO_arrive_only_date"/>
        <result property="nxDoArriveDate" column="nx_DO_arrive_date"/>
        <result property="nxDoArriveWhatDay" column="nx_DO_arrive_what_day"/>
        <result property="nxDoQuantity" column="nx_DO_quantity"/>
        <result property="nxDoStandard" column="nx_DO_standard"/>
        <result property="nxDoRemark" column="nx_DO_remark"/>
        <result property="nxDoStatus" column="nx_DO_status"/>
        <result property="nxDoWeight" column="nx_DO_weight"/>
        <result property="nxDoPrice" column="nx_DO_price"/>
        <result property="nxDoSubtotal" column="nx_DO_subtotal"/>
        <result property="nxDoPurchaseStatus" column="nx_DO_purchase_status"/>
        <result property="nxDoNxGoodsFatherId" column="nx_DO_nx_goods_father_id"/>
        <result property="nxDoDepartmentFatherId" column="nx_DO_department_father_id"/>
        <result property="nxDoDisGoodsId" column="nx_DO_dis_goods_id"/>
        <result property="nxDoDisGoodsFatherId" column="nx_DO_dis_goods_father_id"/>
        <result property="nxDoDepDisGoodsId" column="nx_DO_dep_dis_goods_id"/>
        <result property="nxDoDepDisGoodsPrice" column="nx_DO_dep_dis_goods_price"/>
        <result property="nxDoDepartmentId" column="nx_DO_department_id"/>
        <result property="nxDoDepartmentFatherId" column="nx_DO_department_father_id"/>
        <result property="nxDoDistributerId" column="nx_DO_distributer_id"/>
        <result property="nxDoOperationTime" column="nx_DO_operation_time"/>
        <result property="nxDoIsAgent" column="nx_DO_is_agent"/>
        <result property="nxDoPurchaseGoodsId" column="nx_DO_purchase_goods_id"/>
        <result property="nxDoDepDisGoodsId" column="nx_DO_dep_dis_goods_id"/>
        <result property="nxDoPurchaseUserId" column="nx_DO_purchase_user_id"/>
        <result property="nxDoReturnWeight" column="nx_DO_return_weight"/>
        <result property="nxDoReturnBillId" column="nx_DO_return_bill_id"/>
        <result property="nxDoReturnStatus" column="nx_DO_return_status"/>
        <result property="nxDoReturnSubtotal" column="nx_DO_return_subtotal"/>
        <result property="nxDoPurchaseGoodsId" column="nx_DO_purchase_goods_id"/>
        <result property="nxDoCostPrice" column="nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="nx_DO_cost_subtotal"/>
        <result property="nxDoProfitSubtotal" column="nx_DO_profit_subtotal"/>
        <result property="nxDoProfitScale" column="nx_DO_profit_scale"/>
        <result property="nxDoWeightId" column="nx_DO_weight_id"/>
        <result property="nxDoNxCommunityId" column="nx_DO_nx_community_id"/>
        <result property="nxDoNxCommRestrauntFatherId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxCommRestrauntId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxRestrauntOrderId" column="nx_DO_nx_restraunt_order_id"/>
        <result property="nxDoGbDepartmentOrderId" column="nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDepartmentFatherId" column="nx_DO_gb_department_father_id"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoCostPriceUpdate" column="nx_DO_cost_price_update"/>
        <result property="nxDoCostPriceLevel" column="nx_DO_cost_price_level"/>
        <association property="nxDistributerGoodsEntity" resultMap="disGoods"/>
        <association property="gbDepartmentOrdersEntity" resultMap="gbOrderWithPurGoods"/>
    </resultMap>

    <resultMap id="disUser" type="NxDistributerUserEntity">
        <id property="nxDistributerUserId" column="nx_distributer_user_id"/>
        <result property="nxDiuWxNickName" column="nx_DIU_wx_nick_name"/>
        <result property="nxDiuDistributerId" column="nx_DIU_distributer_id"/>
        <result property="nxDiuWxAvartraUrl" column="nx_DIU_wx_avartral_url"/>
    </resultMap>
    <resultMap id="applys" type="NxDepartmentOrdersEntity">
         <id property="nxDepartmentOrdersId" column="nx_department_orders_id"/>
        <result property="nxDoGoodsName" column="nx_DO_goods_name"/>
        <result property="nxDoExpcetPrice" column="nx_DO_expect_price"/>
        <result property="nxDoPriceDifferent" column="nx_DO_price_different"/>
        <result property="nxDoTodayOrder" column="nx_DO_today_order"/>
        <result property="nxDoPrintStandard" column="nx_DO_print_standard"/>
        <result property="nxDoGoodsType" column="nx_DO_goods_type"/>
        <result property="nxDoDisGoodsGrandId" column="nx_DO_dis_goods_grand_id"/>
        <result property="nxDoGbDepartmentOrderId" column="nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDistributerId" column="nx_DO_gb_distributer_id"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoNxGoodsId" column="nx_DO_nx_goods_id"/>
        <result property="nxDoOrderUserId" column="nx_DO_order_user_id"/>
        <result property="nxDoApplyDate" column="nx_DO_apply_date"/>
        <result property="nxDoApplyOnlyTime" column="nx_DO_apply_only_time"/>
        <result property="nxDoApplyFullTime" column="nx_DO_apply_full_time"/>
        <result property="nxDoArriveOnlyDate" column="nx_DO_arrive_only_date"/>
        <result property="nxDoArriveDate" column="nx_DO_arrive_date"/>
        <result property="nxDoArriveWhatDay" column="nx_DO_arrive_what_day"/>
        <result property="nxDoQuantity" column="nx_DO_quantity"/>
        <result property="nxDoStandard" column="nx_DO_standard"/>
        <result property="nxDoRemark" column="nx_DO_remark"/>
        <result property="nxDoStatus" column="nx_DO_status"/>
        <result property="nxDoWeight" column="nx_DO_weight"/>
        <result property="nxDoPrice" column="nx_DO_price"/>
        <result property="nxDoSubtotal" column="nx_DO_subtotal"/>
        <result property="nxDoPurchaseStatus" column="nx_DO_purchase_status"/>
        <result property="nxDoNxGoodsFatherId" column="nx_DO_nx_goods_father_id"/>
        <result property="nxDoDisGoodsId" column="nx_DO_dis_goods_id"/>
        <result property="nxDoDisGoodsFatherId" column="nx_DO_dis_goods_father_id"/>
        <result property="nxDoDepDisGoodsId" column="nx_DO_dep_dis_goods_id"/>
        <result property="nxDoDepDisGoodsPrice" column="nx_DO_dep_dis_goods_price"/>
        <result property="nxDoDepartmentFatherId" column="nx_DO_department_father_id"/>
        <result property="nxDoDepartmentId" column="nx_DO_department_id"/>
        <result property="nxDoDistributerId" column="nx_DO_distributer_id"/>
        <result property="nxDoOperationTime" column="nx_DO_operation_time"/>
        <result property="nxDoIsAgent" column="nx_DO_is_agent"/>
        <result property="nxDoPurchaseGoodsId" column="nx_DO_purchase_goods_id"/>
        <result property="nxDoDepDisGoodsId" column="nx_DO_dep_dis_goods_id"/>
        <result property="nxDoPurchaseUserId" column="nx_DO_purchase_user_id"/>
        <result property="nxDoReturnWeight" column="nx_DO_return_weight"/>
        <result property="nxDoReturnBillId" column="nx_DO_return_bill_id"/>
        <result property="nxDoReturnStatus" column="nx_DO_return_status"/>
        <result property="nxDoReturnSubtotal" column="nx_DO_return_subtotal"/>
        <result property="nxDoPurchaseGoodsId" column="nx_DO_purchase_goods_id"/>
        <result property="nxDoCostPrice" column="nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="nx_DO_cost_subtotal"/>
        <result property="nxDoProfitSubtotal" column="nx_DO_profit_subtotal"/>
        <result property="nxDoProfitScale" column="nx_DO_profit_scale"/>
        <result property="nxDoWeightId" column="nx_DO_weight_id"/>
        <result property="nxDoNxCommunityId" column="nx_DO_nx_community_id"/>
        <result property="nxDoNxCommRestrauntFatherId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxCommRestrauntId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxRestrauntOrderId" column="nx_DO_nx_restraunt_order_id"/>
        <result property="nxDoGbDepartmentOrderId" column="nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDepartmentFatherId" column="nx_DO_gb_department_father_id"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoCostPriceUpdate" column="nx_DO_cost_price_update"/>
        <result property="nxDoCostPriceLevel" column="nx_DO_cost_price_level"/>
        <result property="nxDoBillId" column="nx_DO_bill_id"/>
        <result property="nxDoReturnBillId" column="nx_DO_return_bill_id"/>
        <association property="nxDepartmentUserEntity" resultMap="orderUser"/>
        <association property="nxDistributerGoodsEntity" resultMap="disGoods"/>
        <association property="nxDepartmentDisGoodsEntity" resultMap="depDisGoods"/>
        <association property="purchaseGoodsEntity" resultMap="onlyPurGoods"/>
        <association property="nxAgentUserEntity" resultMap="disUser"/>
<!--        <association property="orderPurGoods" resultMap="purGoods"/>-->
<!--        <association property="nxDistributerWeightEntity" resultMap="weight"/>-->
    </resultMap>


    <resultMap id="purGoodsFatherGbDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="purGbDf_gb_department_id"/>
        <result property="gbDepartmentName" column="purGbDf_gb_department_name"/>
        <result property="gbDepartmentAttrName" column="purGbDf_gb_department_attr_name"/>
    </resultMap>
    <resultMap id="purGbDepartment" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="purGbDs_gb_department_id"/>
        <result property="gbDepartmentName" column="purGbDs_gb_department_name"/>
        <result property="gbDepartmentAttrName" column="purGbDs_gb_department_attr_name"/>
        <association property="fatherGbDepartmentEntity" resultMap="purGoodsFatherGbDep"/>
    </resultMap>
    <!--    -->

    <resultMap id="needNotBuyRes" type="NxRestrauntEntity">
        <id property="nxRestrauntId" column="ndnr_nx_restraunt_id"/>
        <result property="nxRestrauntName" column="ndnr_nx_restraunt_name"/>
        <result property="nxRestrauntAttrName" column="ndnr_nx_restraunt_attr_name"/>
    </resultMap>
    <resultMap id="purRestraunt" type="NxRestrauntEntity">
        <id property="nxRestrauntId" column="purNr_nx_restraunt_id"/>
        <result property="nxRestrauntName" column="purNr_nx_restraunt_name"/>
        <result property="nxRestrauntAttrName" column="purNr_nx_restraunt_attr_name"/>
    </resultMap>
    <resultMap id="orderRestraunt" type="NxRestrauntEntity">
        <id property="nxRestrauntId" column="nx_restraunt_id"/>
        <result property="nxRestrauntName" column="nx_restraunt_name"/>
        <result property="nxRestrauntAttrName" column="nx_restraunt_attr_name"/>
    </resultMap>

    <resultMap id="disGoodsWithApplys" type="NxDistributerGoodsEntity">
       <id property="nxDistributerGoodsId" column="nx_distributer_goods_id"/>
        <result property="nxDgWillPriceOneWeight" column="nx_dg_will_price_one_weight"/>
        <result property="nxDgWillPriceTwoWeight" column="nx_dg_will_price_two_weight"/>
        <result property="nxDgWillPriceThreeWeight" column="nx_dg_will_price_three_weight"/>
		<result property="nxDgGoodsStatus" column="nx_dg_goods_status"/>
		<result property="nxDgWillPriceOne" column="nx_dg_will_price_one"/>
        <result property="nxDgWillPriceTwo" column="nx_dg_will_price_two"/>
		<result property="nxDgWillPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
		<result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
		<result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgGoodsSonsSort" column="nx_dg_goods_sons_sort"/>
		<result property="nxDgPurchaseAuto" column="nx_dg_purchase_auto"/>
        <result property="nxDgWillPrice" column="nx_dg_will_price"/>
        <result property="nxDgPriceFirstDay" column="nx_dg_price_first_day"/>
        <result property="nxDgPriceSecondDay" column="nx_dg_price_second_day"/>
        <result property="nxDgPriceThirdDay" column="nx_dg_price_third_day"/>
        <result property="nxDgDfgGoodsGrandId" column="nx_dg_dfg_goods_grand_id"/>
        <result property="nxDgDfgGoodsFatherId" column="nx_dg_dfg_goods_father_id"/>
        <result property="nxDgGoodsFile" column="nx_dg_goods_file"/>
        <result property="nxDgGoodsFileLarge" column="nx_dg_goods_file_large"/>
        <result property="nxDgGoodsName" column="nx_dg_goods_name"/>
        <result property="nxDgGoodsStandardname" column="nx_dg_goods_standardname"/>
        <result property="nxDgNxGoodsFatherColor" column="nx_dg_nx_goods_father_color"/>
        <result property="nxDgGoodsStandardWeight" column="nx_dg_goods_standard_weight"/>
        <result property="nxDgGoodsBrand" column="nx_dg_goods_brand"/>
        <result property="nxDgGoodsPlace" column="nx_dg_goods_place"/>
        <result property="nxDgGoodsDetail" column="nx_dg_goods_detail"/>
        <result property="nxDgGoodsPinyin" column="nx_dg_goods_pinyin"/>
        <result property="nxDgBuyingPrice" column="nx_dg_buying_price"/>
        <result property="nxDgPriceProfitOne" column="nx_dg_price_profit_one"/>
        <result property="nxDgPriceProfitTwo" column="nx_dg_price_profit_two"/>
        <result property="nxDgPriceProfitThree" column="nx_dg_price_profit_three"/>
        <result property="nxDgSupplierId" column="nx_dg_supplier_id"/>
       <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <result property="nxDgBuyingPriceIsGrade" column="nx_dg_buying_price_is_grade"/>
        <result property="nxDgBuyingPriceOne" column="nx_dg_buying_price_one"/>
        <result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
        <result property="nxDgBuyingPriceTwo" column="nx_dg_buying_price_two"/>
        <result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
        <result property="nxDgBuyingPriceThree" column="nx_dg_buying_price_three"/>
        <result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="orders"/>
    </resultMap>

    <resultMap id="orders" type="NxDepartmentOrdersEntity">
         <id property="nxDepartmentOrdersId" column="nx_department_orders_id"/>
        <result property="nxDoGoodsName" column="nx_DO_goods_name"/>
        <result property="nxDoExpcetPrice" column="nx_DO_expect_price"/>
        <result property="nxDoPriceDifferent" column="nx_DO_price_different"/>
        <result property="nxDoTodayOrder" column="nx_DO_today_order"/>
        <result property="nxDoPrintStandard" column="nx_DO_print_standard"/>
        <result property="nxDoGoodsType" column="nx_DO_goods_type"/>
        <result property="nxDoDisGoodsId" column="nx_DO_dis_goods_id"/>
        <result property="nxDoDisGoodsGrandId" column="nx_DO_dis_goods_grand_id"/>
        <result property="nxDoGbDepartmentOrderId" column="nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDistributerId" column="nx_DO_gb_distributer_id"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoDepartmentId" column="nx_DO_department_id"/>
        <result property="nxDoDepartmentFatherId" column="nx_DO_department_father_id"/>
        <result property="nxDoDistributerId" column="nx_DO_distributer_id"/>
        <result property="nxDoPurchaseGoodsId" column="nx_DO_purchase_goods_id"/>
        <result property="nxDoQuantity" column="nx_DO_quantity"/>
        <result property="nxDoStandard" column="nx_DO_standard"/>
        <result property="nxDoRemark" column="nx_DO_remark"/>
        <result property="nxDoWeight" column="nx_DO_weight"/>
        <result property="nxDoPrice" column="nx_DO_price"/>
        <result property="nxDoSubtotal" column="nx_DO_subtotal"/>
        <result property="nxDoIsAgent" column="nx_DO_is_agent"/>
        <result property="nxDoStatus" column="nx_DO_status"/>
        <result property="nxDoPurchaseStatus" column="nx_DO_purchase_status"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoGbDepartmentFatherId" column="nx_DO_gb_department_father_id"/>
        <result property="nxDoCostPrice" column="nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="nx_DO_cost_subtotal"/>
        <result property="nxDoWeightId" column="nx_DO_weight_id"/>
        <result property="nxDoNxCommunityId" column="nx_DO_nx_community_id"/>
        <result property="nxDoNxCommRestrauntFatherId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxCommRestrauntId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxRestrauntOrderId" column="nx_DO_nx_restraunt_order_id"/>
        <result property="nxDoCostPriceUpdate" column="nx_DO_cost_price_update"/>
        <result property="nxDoCostPriceLevel" column="nx_DO_cost_price_level"/>
        <result property="nxDoPurchaseStatus" column="nx_DO_purchase_status"/>
        <association property="gbDepartmentEntity" resultMap="orderGbDepartment"/>
        <association property="nxDepartmentEntity" resultMap="orderDepartment"/>
        <association property="nxRestrauntEntity" resultMap="orderRestraunt"/>
    </resultMap>

    <resultMap id="newOrders" type="NxDepartmentOrdersEntity">
        <id property="nxDepartmentOrdersId" column="newDor_nx_department_orders_id"/>
        <result property="nxDoDisGoodsGrandId" column="newDor_nx_DO_goods_grand_id"/>
        <result property="nxDoDepartmentId" column="newDor_nx_DO_department_id"/>
        <result property="nxDoDepartmentFatherId" column="newDor_nx_DO_department_father_id"/>
        <result property="nxDoDistributerId" column="newDor_nx_DO_distributer_id"/>
        <result property="nxDoPurchaseGoodsId" column="newDor_nx_DO_purchase_goods_id"/>
        <result property="nxDoQuantity" column="newDor_nx_DO_quantity"/>
        <result property="nxDoWeight" column="newDor_nx_DO_weight"/>
        <result property="nxDoPrice" column="newDor_nx_DO_price"/>
        <result property="nxDoStandard" column="newDor_nx_DO_standard"/>
        <result property="nxDoRemark" column="newDor_nx_DO_remark"/>
        <result property="nxDoIsAgent" column="newDor_nx_DO_is_agent"/>
        <result property="nxDoStatus" column="newDor_nx_DO_status"/>
        <result property="nxDoGbDepartmentId" column="newDor_nx_DO_gb_department_id"/>
        <result property="nxDoGbDepartmentFatherId" column="newDor_nx_DO_gb_department_father_id"/>
        <result property="nxDoCostPrice" column="newDor_nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="newDor_nx_DO_cost_subtotal"/>
        <result property="nxDoWeightId" column="newDor_nx_DO_weight_id"/>
        <result property="nxDoNxCommunityId" column="newDor_nx_DO_nx_community_id"/>
        <result property="nxDoNxCommRestrauntFatherId" column="newDor_nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxCommRestrauntId" column="newDor_nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxRestrauntOrderId" column="newDor_nx_DO_nx_restraunt_order_id"/>
        <result property="nxDoGbDepartmentOrderId" column="newDor_nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDepartmentFatherId" column="newDor_nx_DO_gb_department_father_id"/>
        <result property="nxDoGbDepartmentId" column="newDor_nx_DO_gb_department_id"/>
        <result property="nxDoCostPriceUpdate" column="newDor_nx_DO_cost_price_update"/>
        <result property="nxDoCostPriceLevel" column="newDor_nx_DO_cost_price_level"/>
        <result property="nxDoPurchaseStatus" column="newDor_nx_DO_purchase_status"/>
        <association property="gbDepartmentEntity" resultMap="orderGbDepartment"/>
        <association property="nxDepartmentEntity" resultMap="orderDepartment"/>
        <association property="nxRestrauntEntity" resultMap="orderRestraunt"/>
    </resultMap>

    <resultMap id="purGoods" type="NxDistributerPurchaseGoodsEntity">
        <id property="nxDistributerPurchaseGoodsId" column="nx_distributer_purchase_goods_id"/>
        <result property="nxDpgFinishAmount" column="nx_DPG_finish_amount"/>
        <result property="nxDpgDisGoodsId" column="nx_DPG_dis_goods_id"/>
        <result property="nxDpgDisGoodsFatherId" column="nx_DPG_dis_goods_father_id"/>
        <result property="nxDpgDisGoodsGrandId" column="nx_DPG_dis_goods_grand_id"/>
        <result property="nxDpgNxWeightId" column="nx_DPG_nx_weight_id"/>
        <result property="nxDpgQuantity" column="nx_DPG_quantity"/>
        <result property="nxDpgStandard" column="nx_DPG_standard"/>
        <result property="nxDpgBuyUserId" column="nx_DPG_buy_user_id"/>
        <result property="nxDpgStatus" column="nx_DPG_status"/>
        <result property="nxDpgBuyPrice" column="nx_DPG_buy_price"/>
        <result property="nxDpgPurchaseType" column="nx_DPG_purchase_type"/>
        <result property="nxDpgOrdersAmount" column="nx_DPG_orders_amount"/>
        <result property="nxDpgTypeAddUserId" column="nx_DPG_type_add_user_id"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
        <result property="nxDpgTime" column="nx_DPG_time"/>
        <result property="nxDpgApplyDate" column="nx_DPG_apply_date"/>
        <result property="nxDpgPurchaseDate" column="nx_DPG_purchase_date"/>
        <result property="nxDpgDistributerId" column="nx_DPG_distributer_id"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
        <result property="nxDpgBuyUserId" column="nx_DPG_buy_user_id"/>
        <result property="nxDpgPurUserId" column="nx_DPG_pur_user_id"/>
        <result property="nxDpgSellUserId" column="nx_DPG_sell_user_id"/>
        <result property="nxDpgCostLevel" column="nx_DPG_cost_level"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
    </resultMap>


    <resultMap id="purGoodsOrders" type="NxDistributerPurchaseGoodsEntity">
        <id property="nxDistributerPurchaseGoodsId" column="order_nx_distributer_purchase_goods_id"/>
        <result property="nxDpgDisGoodsId" column="order_nx_DPG_dis_goods_id"/>
        <result property="nxDpgDisGoodsFatherId" column="order_nx_DPG_dis_goods_father_id"/>
        <result property="nxDpgQuantity" column="order_nx_DPG_quantity"/>
        <result property="nxDpgStandard" column="order_nx_DPG_standard"/>
        <result property="nxDpgBuyUserId" column="order_nx_DPG_buy_user_id"/>
        <result property="nxDpgStatus" column="order_nx_DPG_status"/>
        <result property="nxDpgBuyPrice" column="order_nx_DPG_buy_price"/>
        <result property="nxDpgPurchaseType" column="order_nx_DPG_purchase_type"/>
        <result property="nxDpgOrdersAmount" column="order_nx_DPG_orders_amount"/>
        <result property="nxDpgTypeAddUserId" column="order_nx_DPG_type_add_user_id"/>
        <result property="nxDpgInputType" column="order_nx_DPG_input_type"/>
        <result property="nxDpgTime" column="order_nx_DPG_time"/>
        <result property="nxDpgApplyDate" column="order_nx_DPG_apply_date"/>
        <result property="nxDpgPurchaseDate" column="order_nx_DPG_purchase_date"/>
        <result property="nxDpgDistributerId" column="order_nx_DPG_distributer_id"/>
        <result property="nxDpgInputType" column="order_nx_DPG_input_type"/>
        <result property="nxDpgBuyUserId" column="order_nx_DPG_buy_user_id"/>
        <result property="nxDpgPurUserId" column="order_nx_DPG_pur_user_id"/>
        <result property="nxDpgSellUserId" column="order_nx_DPG_sell_user_id"/>
        <result property="nxDpgCostLevel" column="order_nx_DPG_cost_level"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="depsOrders"/>
    </resultMap>


    <resultMap id="onlyPurGoods" type="NxDistributerPurchaseGoodsEntity">
        <id property="nxDistributerPurchaseGoodsId" column="nx_distributer_purchase_goods_id"/>
        <result property="nxDpgFinishAmount" column="nx_DPG_finish_amount"/>
        <result property="nxDpgDisGoodsId" column="nx_DPG_dis_goods_id"/>
        <result property="nxDpgDisGoodsFatherId" column="nx_DPG_dis_goods_father_id"/>
        <result property="nxDpgDisGoodsGrandId" column="nx_DPG_dis_goods_grand_id"/>
        <result property="nxDpgNxWeightId" column="nx_DPG_nx_weight_id"/>
        <result property="nxDpgBatchId" column="nx_DPG_batch_id"/>
        <result property="nxDpgQuantity" column="nx_DPG_quantity"/>
        <result property="nxDpgStandard" column="nx_DPG_standard"/>
        <result property="nxDpgStatus" column="nx_DPG_status"/>
        <result property="nxDpgBuyPrice" column="nx_DPG_buy_price"/>
        <result property="nxDpgPurchaseType" column="nx_DPG_purchase_type"/>
        <result property="nxDpgOrdersAmount" column="nx_DPG_orders_amount"/>
        <result property="nxDpgTypeAddUserId" column="nx_DPG_type_add_user_id"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
        <result property="nxDpgTime" column="nx_DPG_time"/>
        <result property="nxDpgPurchaseDate" column="nx_DPG_purchase_date"/>
        <result property="nxDpgDistributerId" column="nx_DPG_distributer_id"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
        <result property="nxDpgSellUserId" column="nx_DPG_sell_user_id"/>
        <result property="nxDpgBuyUserId" column="nx_DPG_buy_user_id"/>
        <result property="nxDpgPurUserId" column="nx_DPG_pur_user_id"/>
        <result property="nxDpgSellUserId" column="nx_DPG_sell_user_id"/>
        <result property="nxDpgCostLevel" column="nx_DPG_cost_level"/>
        <result property="nxDpgPayType" column="nx_DPG_pay_type"/>
        <association property="sellerUserEntity" resultMap="jrdhSellUser"/>
    </resultMap>

    <resultMap id="ngdsFatherDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="ngdf_dd_gb_department_id"/>
        <result property="gbDepartmentName" column="ngdf_dd_gb_department_name"/>
        <result property="gbDepartmentAttrName" column="ngdf_dd_gb_department_att_name"/>
    </resultMap>


    <resultMap id="needNotBuyGbDeps" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="nds_gb_department_id"/>
        <result property="gbDepartmentName" column="nds_gb_department_name"/>
        <result property="gbDepartmentAttrName" column="nds_gb_department_attr_name"/>
        <result property="gbDepartmentFatherId" column="nds_gb_department_father_id"/>
        <association property="fatherGbDepartmentEntity" resultMap="ngdsFatherDep"/>
    </resultMap>


    <resultMap id="ndsFatherDep" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="ndf_dd_nx_department_id"/>
        <result property="nxDepartmentName" column="ndf_dd_nx_department_name"/>
        <result property="nxDepartmentAttrName" column="ndf_dd_nx_department_attr_name"/>
    </resultMap>


    <resultMap id="neednNotBuyDeps" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="nds_nx_department_id"/>
        <result property="nxDepartmentName" column="nds_nx_department_name"/>
        <result property="nxDepartmentAttrName" column="nds_nx_department_attr_name"/>
        <result property="nxDepartmentFatherId" column="nds_nx_department_father_id"/>
        <association property="fatherDepartmentEntity" resultMap="ndsFatherDep"/>
    </resultMap>
    <resultMap id="needNotBuyOrders" type="NxDepartmentOrdersEntity">
        <id property="nxDepartmentOrdersId" column="needNotDor_nx_department_orders_id"/>
        <result property="nxDoDisGoodsId" column="needNotDor_nx_DO_dis_goods_id"/>
        <result property="nxDoDepartmentId" column="needNotDor_nx_DO_department_id"/>
        <result property="nxDoDepartmentFatherId" column="needNotDor_nx_DO_department_father_id"/>
        <result property="nxDoPurchaseGoodsId" column="needNotDor_nx_DO_purchase_goods_id"/>
        <result property="nxDoPurchaseStatus" column="needNotDor_nx_DO_purchase_status"/>
        <result property="nxDoQuantity" column="needNotDor_nx_DO_quantity"/>
        <result property="nxDoStandard" column="needNotDor_nx_DO_standard"/>
        <result property="nxDoStatus" column="needNotDor_nx_DO_status"/>
        <result property="nxDoWeight" column="needNotDor_nx_DO_weight"/>
        <result property="nxDoPrice" column="needNotDor_nx_DO_price"/>
        <result property="nxDoSubtotal" column="needNotDor_nx_DO_subtotal"/>
        <result property="nxDoCostPrice" column="needNotDor_nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="needNotDor_nx_DO_cost_subtotal"/>
        <result property="nxDoWeightId" column="needNotDor_nx_DO_weight_id"/>
        <result property="nxDoNxCommunityId" column="needNotDor_nx_DO_nx_community_id"/>
        <result property="nxDoNxCommRestrauntFatherId" column="needNotDor_nx_DO_nx_comm_restraunt_father_id"/>
        <result property="nxDoNxCommRestrauntId" column="needNotDor_nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxRestrauntOrderId" column="needNotDor_nx_DO_nx_restraunt_order_id"/>
        <result property="nxDoGbDepartmentOrderId" column="needNotDor_nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDepartmentFatherId" column="needNotDor_nx_DO_gb_department_father_id"/>
        <result property="nxDoGbDepartmentId" column="needNotDornx_DO_gb_department_id"/>
        <result property="nxDoCostPrice" column="needNotDor_nx_DO_cost_price"/>
        <result property="nxDoCostPriceUpdate" column="needNotDor_nx_DO_cost_price_update"/>
        <result property="nxDoCostPriceLevel" column="needNotDor_nx_DO_cost_price_level"/>
        <result property="nxDoDisGoodsGrandId" column="needNotDor_nx_DO_dis_goods_grand_id"/>
        <association property="nxDepartmentEntity" resultMap="neednNotBuyDeps"/>
        <association property="gbDepartmentEntity" resultMap="needNotBuyGbDeps"/>
        <association property="nxRestrauntEntity" resultMap="needNotBuyRes"/>
    </resultMap>

    <resultMap id="depsOrders" type="NxDepartmentOrdersEntity">
        <id property="nxDepartmentOrdersId" column="purDor_nx_department_orders_id"/>
        <result property="nxDoDepartmentId" column="purDor_nx_DO_department_id"/>
        <result property="nxDoCostPriceLevel" column="purDor_nx_cost_price_level"/>
        <result property="nxDoCostPrice" column="purDor_nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="purDor_nx_DO_cost_subtotal"/>
        <result property="nxDoDepartmentFatherId" column="purDor_nx_DO_department_father_id"/>
        <result property="nxDoPurchaseGoodsId" column="purDor_nx_DO_purchase_goods_id"/>
        <result property="nxDoDisGoodsId" column="purDor_nx_DO_dis_goods_id"/>
        <result property="nxDoDisGoodsFatherId" column="purDor_nx_DO_dis_goods_father_id"/>
        <result property="nxDoDisGoodsGrandId" column="purDor_nx_DO_dis_goods_grand_id"/>
        <result property="nxDoQuantity" column="purDor_nx_DO_quantity"/>
        <result property="nxDoStandard" column="purDor_nx_DO_standard"/>
        <result property="nxDoStatus" column="purDor_nx_DO_status"/>
        <result property="nxDoWeight" column="purDor_nx_DO_weight"/>
        <result property="nxDoPrice" column="purDor_nx_DO_price"/>
        <result property="nxDoSubtotal" column="purDor_nx_DO_subtotal"/>
        <result property="nxDoCostPrice" column="purDor_nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="purDor_nx_DO_cost_subtotal"/>
        <result property="nxDoWeightId" column="purDor_nx_DO_weight_id"/>
        <result property="nxDoNxCommunityId" column="purDor_nx_DO_nx_community_id"/>
        <result property="nxDoNxCommRestrauntFatherId" column="purDor_nx_DO_nx_comm_restraunt_father_id"/>
        <result property="nxDoNxCommRestrauntId" column="purDor_nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxRestrauntOrderId" column="purDor_nx_DO_nx_restraunt_order_id"/>
        <result property="nxDoGbDepartmentOrderId" column="purDor_nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDepartmentFatherId" column="purDor_nx_DO_gb_department_father_id"/>
        <result property="nxDoGbDepartmentId" column="purDor_nx_DO_gb_department_id"/>
        <result property="nxDoDisGoodsGrandId" column="purDor_nx_DO_dis_goods_grand_id"/>
        <association property="nxDepartmentEntity" resultMap="purGoodsDep"/>
        <association property="gbDepartmentEntity" resultMap="purGbDepartment"/>
        <association property="nxRestrauntEntity" resultMap="purRestraunt"/>
    </resultMap>

    <resultMap id="purGoodsDep" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="purDs_nx_department_id"/>
        <result property="nxDepartmentFatherId" column="purDs_nx_department_father_id"/>
        <result property="nxDepartmentName" column="purDs_nx_department_name"/>
        <result property="nxDepartmentAttrName" column="purDs_nx_department_attr_name"/>
        <result property="nxDepartmentFatherId" column="purDs_nx_department_father_id"/>
        <association property="fatherDepartmentEntity" resultMap="purGoodsFatherDep"/>
    </resultMap>

    <resultMap id="purGoodsFatherDep" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="purDf_nx_department_id"/>
        <result property="nxDepartmentName" column="purDf_nx_department_name"/>
        <result property="nxDepartmentAttrName" column="purDf_nx_department_attr_name"/>
    </resultMap>
    <resultMap id="disGoodsWithOrders" type="NxDistributerGoodsEntity">
       <id property="nxDistributerGoodsId" column="nx_distributer_goods_id"/>
        <result property="nxDgWillPriceOneWeight" column="nx_dg_will_price_one_weight"/>
        <result property="nxDgWillPriceTwoWeight" column="nx_dg_will_price_two_weight"/>
        <result property="nxDgWillPriceThreeWeight" column="nx_dg_will_price_three_weight"/>
		<result property="nxDgGoodsStatus" column="nx_dg_goods_status"/>
		<result property="nxDgWillPriceOne" column="nx_dg_will_price_one"/>
        <result property="nxDgWillPriceTwo" column="nx_dg_will_price_two"/>
		<result property="nxDgWillPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
		<result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
		<result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgGoodsSonsSort" column="nx_dg_goods_sons_sort"/>
		<result property="nxDgPurchaseAuto" column="nx_dg_purchase_auto"/>
        <result property="nxDgWillPrice" column="nx_dg_will_price"/>
        <result property="nxDgPriceFirstDay" column="nx_dg_price_first_day"/>
        <result property="nxDgPriceSecondDay" column="nx_dg_price_second_day"/>
        <result property="nxDgPriceThirdDay" column="nx_dg_price_third_day"/>
        <result property="nxDgDfgGoodsGrandId" column="nx_dg_dfg_goods_grand_id"/>
        <result property="nxDgDfgGoodsFatherId" column="nx_dg_dfg_goods_father_id"/>
        <result property="nxDgGoodsFile" column="nx_dg_goods_file"/>
        <result property="nxDgGoodsFileLarge" column="nx_dg_goods_file_large"/>
        <result property="nxDgGoodsName" column="nx_dg_goods_name"/>
        <result property="nxDgGoodsStandardname" column="nx_dg_goods_standardname"/>
        <result property="nxDgGoodsPinyin" column="nx_dg_goods_pinyin"/>
        <result property="nxDgGoodsPy" column="nx_dg_goods_py"/>
        <result property="nxDgNxGoodsFatherColor" column="nx_dg_nx_goods_father_color"/>
        <result property="nxDgGoodsStandardWeight" column="nx_dg_goods_standard_weight"/>
        <result property="nxDgGoodsBrand" column="nx_dg_goods_brand"/>
        <result property="nxDgGoodsPlace" column="nx_dg_goods_place"/>
        <result property="nxDgGoodsDetail" column="nx_dg_goods_detail"/>
        <result property="nxDgGoodsPinyin" column="nx_dg_goods_pinyin"/>
        <result property="nxDgBuyingPrice" column="nx_dg_buying_price"/>
        <result property="nxDgPriceProfitOne" column="nx_dg_price_profit_one"/>
        <result property="nxDgPriceProfitTwo" column="nx_dg_price_profit_two"/>
        <result property="nxDgPriceProfitThree" column="nx_dg_price_profit_three"/>
        <result property="nxDgSupplierId" column="nx_dg_supplier_id"/>
       <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <result property="nxDgBuyingPriceIsGrade" column="nx_dg_buying_price_is_grade"/>
        <result property="nxDgBuyingPriceOne" column="nx_dg_buying_price_one"/>
        <result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
        <result property="nxDgBuyingPriceTwo" column="nx_dg_buying_price_two"/>
        <result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
        <result property="nxDgBuyingPriceThree" column="nx_dg_buying_price_three"/>
        <result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <collection property="unPurGoodsDisGoodsList" resultMap="purGoods"/>
        <collection property="unPurOrdersDisGoodsList" resultMap="purGoodsOrders"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="newOrders"/>
        <collection property="neetNotPurOrders" resultMap="needNotBuyOrders"/>
    </resultMap>


    <resultMap id="purGoodsOrdersWithOutExr" type="NxDistributerPurchaseGoodsEntity">
        <id property="nxDistributerPurchaseGoodsId" column="nx_distributer_purchase_goods_id"/>
        <result property="nxDpgFinishAmount" column="nx_DPG_finish_amount"/>
        <result property="nxDpgDisGoodsId" column="nx_DPG_dis_goods_id"/>
        <result property="nxDpgDisGoodsFatherId" column="nx_DPG_dis_goods_father_id"/>
        <result property="nxDpgDisGoodsGrandId" column="nx_DPG_dis_goods_grand_id"/>
        <result property="nxDpgNxWeightId" column="nx_DPG_nx_weight_id"/>
        <result property="nxDpgNxWeightId" column="nx_DPG_nx_weight_id"/>
        <result property="nxDpgQuantity" column="nx_DPG_quantity"/>
        <result property="nxDpgStandard" column="nx_DPG_standard"/>
        <result property="nxDpgBuyUserId" column="nx_DPG_buy_user_id"/>
        <result property="nxDpgStatus" column="nx_DPG_status"/>
        <result property="nxDpgBuyPrice" column="nx_DPG_buy_price"/>
        <result property="nxDpgPurchaseType" column="nx_DPG_purchase_type"/>
        <result property="nxDpgOrdersAmount" column="nx_DPG_orders_amount"/>
        <result property="nxDpgTypeAddUserId" column="nx_DPG_type_add_user_id"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
        <result property="nxDpgTime" column="nx_DPG_time"/>
        <result property="nxDpgApplyDate" column="nx_DPG_apply_date"/>
        <result property="nxDpgPurchaseDate" column="nx_DPG_purchase_date"/>
        <result property="nxDpgDistributerId" column="nx_DPG_distributer_id"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
        <result property="nxDpgBuyUserId" column="nx_DPG_buy_user_id"/>
        <result property="nxDpgPurUserId" column="nx_DPG_pur_user_id"/>
        <result property="nxDpgSellUserId" column="nx_DPG_sell_user_id"/>
        <result property="nxDpgCostLevel" column="nx_DPG_cost_level"/>
        <association property="nxDistributerGoodsEntity" resultMap="disGoods"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="ordersForGoods"/>
    </resultMap>

    <resultMap id="unPlanPurchaseOrdersDisFatherGoods" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="nx_distributer_father_goods_id"/>
        <result property="nxDfgFatherGoodsName" column="nx_DFG_father_goods_name"/>
        <result property="nxDfgFathersFatherId" column="nx_dfg_fathers_father_id"/>
        <collection property="nxDistributerGoodsEntities" resultMap="disGoodsWithOrders"/>
    </resultMap>
    <resultMap id="unPlanPurchaseOrdersDisGreatGoods" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="great_nx_distributer_father_goods_id"/>
        <result property="nxDfgFatherGoodsName" column="great_nx_DFG_father_goods_name"/>
        <result property="nxDfgFathersFatherId" column="great_nx_dfg_fathers_father_id"/>
        <collection property="fatherGoodsEntities" resultMap="unPlanPurchaseOrdersDisFatherGoods"/>
    </resultMap>
    <resultMap id="unPlanPurchaseOrdersDisFatherGoodsAAA" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="nx_distributer_father_goods_id"/>
        <result property="nxDfgFatherGoodsName" column="nx_DFG_father_goods_name"/>
        <result property="nxDfgFathersFatherId" column="nx_dfg_fathers_father_id"/>
        <collection property="nxDistributerPurchaseGoodsEntities" resultMap="purGoodsOrdersWithOutExr"/>
    </resultMap>

    <resultMap id="subDepartmentWithOrders" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="ds_nx_department_id"/>
        <result property="nxDepartmentName" column="ds_nx_department_name"/>
        <result property="nxDepartmentType" column="ds_nx_department_type"/>
        <result property="nxDepartmentSettleType" column="ds_nx_department_settle_type"/>
        <result property="nxDepartmentFilePath" column="ds_nx_department_file_path"/>
        <result property="nxDepartmentFatherId" column="ds_nx_department_father_id"/>
        <result property="nxDepartmentIsGroupDep" column="ds_nx_department_is_group_dep"/>
        <result property="nxDepartmentAttrName" column="ds_nx_department_attr_name"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="applys"/>
    </resultMap>

    <resultMap id="subDepartmentWithFatherGoodsOrders" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="ds_nx_department_id"/>
        <result property="nxDepartmentName" column="ds_nx_department_name"/>
        <result property="nxDepartmentType" column="ds_nx_department_type"/>
        <result property="nxDepartmentSettleType" column="ds_nx_department_settle_type"/>
        <result property="nxDepartmentFilePath" column="ds_nx_department_file_path"/>
        <result property="nxDepartmentFatherId" column="ds_nx_department_father_id"/>
        <result property="nxDepartmentIsGroupDep" column="ds_nx_department_is_group_dep"/>
        <result property="nxDepartmentAttrName" column="ds_nx_department_attr_name"/>
        <collection property="nxDisFatherGoodsEntities" resultMap="unPlanPurchaseOrdersDisGreatGoods"/>
    </resultMap>

    <resultMap id="subGbDepartmentWithOrders" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="ds_gb_department_id"/>
        <result property="gbDepartmentName" column="ds_gb_department_name"/>
        <result property="gbDepartmentType" column="ds_gb_department_type"/>
        <result property="gbDepartmentFilePath" column="ds_gb_department_file_path"/>
        <result property="gbDepartmentFatherId" column="ds_gb_department_father_id"/>
        <result property="gbDepartmentIsGroupDep" column="ds_gb_department_is_group_dep"/>
        <result property="gbDepartmentAttrName" column="ds_gb_department_attr_name"/>
        <result property="gbDepartmentDisId" column="ds_gb_department_dis_id"/>
        <result property="gbDepartmentPrintName" column="ds_gb_department_print_name"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="applys"/>
    </resultMap>

    <resultMap id="gbDepartment" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
    </resultMap>
    <resultMap id="ordersForGoods" type="NxDepartmentOrdersEntity">
         <id property="nxDepartmentOrdersId" column="nx_department_orders_id"/>
        <result property="nxDoGoodsName" column="nx_DO_goods_name"/>
        <result property="nxDoExpcetPrice" column="nx_DO_expect_price"/>
        <result property="nxDoPriceDifferent" column="nx_DO_price_different"/>
        <result property="nxDoTodayOrder" column="nx_DO_today_order"/>
        <result property="nxDoPrintStandard" column="nx_DO_print_standard"/>
        <result property="nxDoGoodsType" column="nx_DO_goods_type"/>
        <result property="nxDoDisGoodsGrandId" column="nx_DO_dis_goods_grand_id"/>
        <result property="nxDoGbDepartmentOrderId" column="nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDistributerId" column="nx_DO_gb_distributer_id"/>
        <result property="nxDoDepartmentId" column="nx_DO_department_id"/>
        <result property="nxDoDepartmentFatherId" column="nx_DO_department_father_id"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoApplyDate" column="nx_DO_apply_date"/>
        <result property="nxDoArriveOnlyDate" column="nx_DO_arrive_only_date"/>
        <result property="nxDoApplyFullTime" column="nx_DO_apply_full_time"/>
        <result property="nxDoApplyOnlyTime" column="nx_DO_apply_only_time"/>
        <result property="nxDoQuantity" column="nx_DO_quantity"/>
        <result property="nxDoStandard" column="nx_DO_standard"/>
        <result property="nxDoRemark" column="nx_DO_remark"/>
        <result property="nxDoStatus" column="nx_DO_status"/>
        <result property="nxDoWeight" column="nx_DO_weight"/>
        <result property="nxDoPrice" column="nx_DO_price"/>
        <result property="nxDoSubtotal" column="nx_DO_subtotal"/>
        <result property="nxDoPurchaseStatus" column="nx_DO_purchase_status"/>
        <result property="nxDoPurchaseGoodsId" column="nx_DO_purchase_goods_id"/>
        <result property="nxDoArriveWhatDay" column="nx_DO_arrive_what_day"/>
        <result property="nxDoArriveWeeksYear" column="nx_DO_arrive_weeks_year"/>
        <result property="nxDoCostPrice" column="nx_DO_cost_price"/>
        <result property="nxDoCostSubtotal" column="nx_DO_cost_subtotal"/>
        <result property="nxDoWeightId" column="nx_DO_weight_id"/>
        <result property="nxDoNxCommunityId" column="nx_DO_nx_community_id"/>
        <result property="nxDoNxCommRestrauntFatherId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxCommRestrauntId" column="nx_DO_nx_comm_restraunt_id"/>
        <result property="nxDoNxRestrauntOrderId" column="nx_DO_nx_restraunt_order_id"/>
        <result property="nxDoGbDepartmentOrderId" column="nx_DO_gb_department_order_id"/>
        <result property="nxDoGbDepartmentFatherId" column="nx_DO_gb_department_father_id"/>
        <result property="nxDoGbDepartmentId" column="nx_DO_gb_department_id"/>
        <result property="nxDoCostPriceUpdate" column="nx_DO_cost_price_update"/>
        <result property="nxDoCostPriceLevel" column="nx_DO_cost_price_level"/>
        <association property="nxDepartmentEntity" resultMap="orderDepartment"/>
        <association property="gbDepartmentEntity" resultMap="gbDepartment"/>
    </resultMap>

    <select id="queryOrdersForDisGoods" resultMap="ordersForGoods">
        select *
        from nx_department_orders as dor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_department as dep on dep.nx_department_id = dor.nx_DO_department_father_id
        left join gb_department as gdp on gdp.gb_department_id = dor.nx_DO_gb_department_father_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id = #{disGoodsId}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="dayuStatus != null">
                and dor.nx_DO_status &gt; #{dayuStatus}
            </if>
        </where>

        order by dep.nx_department_id, dor.nx_DO_arrive_date
    </select>

    <select id="queryTotalByParams" resultType="java.lang.Integer">
        select count(*) from nx_department_orders
        <where>
            <if test="resFatherId != null">
                and nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and nx_DO_department_id = #{depId}
            </if>

            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="onlyDate != null">
                and nx_DO_arrive_only_date &gt; #{onlyDate}
            </if>

            <if test="applyDate != null">
                and nx_DO_apply_date &gt; #{applyDate}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="priceOrder != null and priceOrder == 1">
                and nx_DO_price is not null
            </if>
            <if test="weightOrder != null and weightOrder == 1">
                and nx_DO_weight is not null
            </if>

        </where>
    </select>

    <select id="disQueryDisOrdersByParams" resultMap="applys">
        select
        ds.nx_department_id 'ds_nx_department_id',
        ds.nx_department_name 'ds_nx_department_name',
        ds.nx_department_type 'ds_nx_department_type',
        ds.nx_department_father_id 'ds_nx_department_father_id',
        ds.nx_department_is_group_dep 'ds_nx_department_is_group_dep',
        ds.nx_department_settle_type 'ds_nx_department_settle_type',
        ds.nx_department_attr_name 'ds_nx_department_attr_name',
        dor.nx_department_orders_id,
        dor.nx_DO_nx_goods_id,
        dor.nx_DO_order_user_id,
        dor.nx_DO_apply_date,
        dor.nx_DO_apply_only_time,
        dor.nx_DO_quantity,
        dor.nx_DO_standard,
        dor.nx_DO_remark,
        dor.nx_DO_status,
        dor.nx_DO_purchase_status,
        dor.nx_DO_weight,
        dor.nx_DO_price,
        dor.nx_DO_subtotal,
        dor.nx_DO_apply_full_time,
        dor.nx_DO_arrive_only_date,
        dor.nx_DO_nx_goods_father_id,
        dor.nx_DO_dis_goods_id,
        dor.nx_DO_dep_dis_goods_price,
        dor.nx_DO_department_id,
        dor.nx_DO_distributer_id,
        dor.nx_DO_is_agent,
        dor.nx_DO_purchase_goods_id,
        dor.nx_DO_dep_dis_goods_id,
        dg.nx_distributer_goods_id,
        dg.nx_dg_goods_name,
        dg.nx_dg_goods_brand,
        dg.nx_dg_goods_detail,
        dg.nx_dg_goods_place,
        dg.nx_dg_goods_standardname,
        dg.nx_dg_goods_standard_weight,
        nds.nx_distributer_standard_id,
        nds.nx_DS_standard_name,
        nds.nx_DS_dis_goods_id

        from nx_department_orders as dor
        left join nx_department_dis_goods as ddg on ddg.nx_department_dis_goods_id = dor.nx_DO_dep_dis_goods_id
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_department_user as du on du.nx_department_user_id = dor.nx_DO_order_user_id
        left join nx_department as ds on ds.nx_department_id = dor.nx_DO_department_id
        left join nx_distributer_standard as nds on nds.nx_DS_dis_goods_id = dg.nx_distributer_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_father_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id

        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="depFatherId != null">
                and dor.nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="purGoodsId != null">
                and dor.nx_DO_purchase_goods_id = #{purGoodsId}
            </if>
        </where>
        <if test="orderBy != null and orderBy == 'time'">
            order by dor.nx_DO_today_order
        </if>

        <if test="orderBy == null">
            order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort
        </if>
    </select>

    <select id="queryDistributerTodayGbDepartments" resultMap="subGbDepartmentWithOrders">
        select dor.nx_department_orders_id,
        dor.nx_DO_nx_goods_id,
        dor.nx_DO_order_user_id,
        dor.nx_DO_apply_date,
        dor.nx_DO_apply_only_time,
        dor.nx_DO_quantity,
        dor.nx_DO_standard,
        dor.nx_DO_remark,
        dor.nx_DO_status,
        dor.nx_DO_purchase_status,
        dor.nx_DO_weight,
        dor.nx_DO_price,
        dor.nx_DO_subtotal,
        dor.nx_DO_apply_full_time,
        dor.nx_DO_arrive_only_date,
        dor.nx_DO_nx_goods_father_id,
        dor.nx_DO_dis_goods_id,
        dor.nx_DO_dep_dis_goods_price,
        dor.nx_DO_department_id,
        dor.nx_DO_distributer_id,
        dor.nx_DO_is_agent,
        dor.nx_DO_purchase_goods_id,
        dor.nx_DO_gb_department_id,
        dor.nx_DO_gb_department_father_id,
        dg.nx_distributer_goods_id,
        dg.nx_dg_goods_name,
        dg.nx_dg_goods_brand,
        dg.nx_dg_goods_detail,
        dg.nx_dg_goods_place,
        dg.nx_dg_goods_standardname,
        dg.nx_dg_goods_standard_weight,
        dg.nx_dg_purchase_auto,
        dg.nx_dg_nx_goods_father_color,
        ds.gb_department_id 'ds_gb_department_id',
        ds.gb_department_name 'ds_gb_department_name',
        ds.gb_department_type 'ds_gb_department_type',
        ds.gb_department_father_id 'ds_gb_department_father_id',
        ds.gb_department_is_group_dep 'ds_gb_department_is_group_dep',
        ds.gb_department_settle_type 'ds_gb_department_settle_type',
        ds.gb_department_attr_name 'ds_gb_department_attr_name',
        ds.gb_department_dis_id 'ds_gb_department_dis_id'
        from nx_department_orders as dor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join gb_department as ds on ds.gb_department_id = dor.nx_DO_gb_department_id
        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>
            <if test="gbDisId != null">
                and dor.nx_DO_gb_distributer_id = #{gbDisId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_Date = #{arriveDate}
            </if>
            and dor.nx_DO_department_id = -1
        </where>
        order by ds.gb_department_id, dor.nx_DO_status , dg.nx_dg_dfg_goods_father_id, dg.nx_dg_goods_py
    </select>

    <select id="queryDisOrdersGbByParams" resultMap="applys">
        select * from nx_department_orders as dor
        left join nx_department_dis_goods as ddg on ddg.nx_department_dis_goods_id = dor.nx_DO_dep_dis_goods_id
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_department_user as du on du.nx_department_user_id = dor.nx_DO_order_user_id

        left join nx_distributer_standard as ds on ds.nx_DS_dis_goods_id = dg.nx_distributer_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_father_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id
        left join nx_distributer_user as ndu on ndu.nx_distributer_user_id = dor.nx_DO_is_agent


        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="onlyDate != null">
                and dor.nx_DO_arrive_only_date &gt; #{onlyDate}
            </if>

            <if test="applyDate != null">
                and dor.nx_DO_apply_date &gt; #{applyDate}
            </if>
            <if test="arriveDateDayu != null">
                and dor.nx_DO_apply_date &gt; #{arriveDateDayu}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="userId != null">
                and dor.nx_DO_order_user_id = #{userId}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depDisGoodsId != null">
                and dor.nx_DO_dep_dis_goods_id = #{depDisGoodsId}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="purGoodsId != null">
                and dor.nx_DO_purchase_goods_id = #{purGoodsId}
            </if>
            <if test="purchaseAuto != null">
                and dg.nx_dg_purchase_auto = #{purchaseAuto}
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>

        </where>
        <if test="orderBy != null and orderBy == 'time'">
            order by dor.nx_department_orders_id DESC
        </if>


        <if test="orderBy == null">
            order by great.nx_dfg_father_goods_sort,ndfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort
        </if>
    </select>
    <select id="queryReturnOrdersByBillId" resultMap="applys">
        select *
        from nx_department_orders as dor
                 left join nx_department_dis_goods as ddg on ddg.nx_department_dis_goods_id = dor.nx_DO_dep_dis_goods_id
                 left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        where nx_DO_bill_id = #{billId}
          and dor.nx_DO_return_status = 0
    </select>

    <resultMap id="depUser" type="NxDepartmentUserEntity">
        <id property="nxDepartmentUserId" column="nx_department_user_id"/>
        <result property="nxDuLoginTimes" column="nx_DU_login_times"/>
        <result property="nxDuWxNickName" column="nx_DU_wx_nick_name"/>
        <result property="nxDuWxAvartraUrl" column="nx_DU_wx_avartra_url"/>
        <result property="nxDuWxPhone" column="nx_DU_wx_phone"/>
    </resultMap>

    <resultMap id="subDeps" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="subs_nx_department_id"/>
        <result property="nxDepartmentPrintName" column="subs_nx_department_print_name"/>
        <result property="nxDepartmentType" column="subs_nx_department_type"/>
        <result property="nxDepartmentName" column="subs_nx_department_name"/>
        <result property="nxDepartmentAttrName" column="subs_nx_department_attr_name"/>
        <result property="nxDepartmentSubAmount" column="subs_nx_department_sub_amount"/>
        <result property="nxDepartmentFatherId" column="subs_nx_department_father_id"/>
        <result property="nxDepartmentShowWeeks" column="subs_nx_department_show_weeks"/>
        <result property="nxDepartmentIsGroupDep" column="subs_nx_department_is_group_dep"/>
        <result property="nxDepartmentFatherId" column="subs_nx_department_father_id"/>
        <result property="nxDepartmentDisId" column="subs_nx_department_dis_id"/>
        <result property="nxDepartmentFilePath" column="subs_nx_department_file_path"/>
    </resultMap>
    <resultMap id="depWithUser" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="nx_department_id"/>
        <result property="nxDepartmentPrintName" column="nx_department_print_name"/>
        <result property="nxDepartmentType" column="nx_department_type"/>
        <result property="nxDepartmentName" column="nx_department_name"/>
        <result property="nxDepartmentAttrName" column="nx_department_attr_name"/>
        <result property="nxDepartmentDisId" column="nx_department_dis_id"/>
        <result property="nxDepartmentType" column="nx_department_type"/>
        <result property="nxDepartmentSettleType" column="nx_department_settle_type"/>
        <result property="nxDepartmentIsGroupDep" column="nx_department_is_group_dep"/>
        <result property="nxDepartmentSubAmount" column="nx_department_sub_amount"/>
        <result property="nxDepartmentType" column="nx_department_type"/>
        <result property="nxDepartmentPrintName" column="nx_department_print_name"/>
        <association property="nxDepartmentUserEntity" resultMap="depUser"/>
        <collection property="nxDepartmentEntities" resultMap="subDeps"/>
    </resultMap>

    <select id="queryOrderDepartmentList" resultMap="depWithUser">
        select *,
        subsd.nx_department_id            'subs_nx_department_id',
        subsd.nx_department_name          'subs_nx_department_name',
        subsd.nx_department_attr_name     'subs_nx_department_attr_name',
        subsd.nx_department_type          'subs_nx_department_type',
        subsd.nx_department_print_name    'subs_nx_department_print_name',
        subsd.nx_department_show_weeks    'subs_nx_department_show_weeks',
        subsd.nx_department_father_id     'subs_nx_department_father_id',
        subsd.nx_department_is_group_dep  'subs_nx_department_is_group_dep',
        subsd.nx_department_dis_id        'subs_nx_department_dis_id',
        subsd.nx_department_sub_amount    'subs_nx_department_sub_amount'
        from nx_department_orders as dor
        left join nx_department as ds on ds.nx_department_id = dor.nx_DO_department_father_id
        left join nx_department as subsd on subsd.nx_department_father_id = ds.nx_department_id
        left join nx_department_user as du on du.nx_DU_department_father_id = ds.nx_department_id
        and du.nx_DU_admin = 1
        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_Date = #{arriveDate}
            </if>
            and dor.nx_DO_gb_department_id = -1 and dor.nx_DO_nx_comm_restraunt_id = -1
        </where>
        order by ds.nx_department_id
    </select>

    <resultMap id="fatherNxGoods" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="nx_distributer_father_goods_id"/>
        <result property="nxDfgFatherGoodsName" column="nx_DFG_father_goods_name"/>
        <result property="nxDfgFathersFatherId" column="nx_dfg_fathers_father_id"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="applys"/>
    </resultMap>


    <select id="queryDepOrdersOrderFatherGoods" resultMap="fatherNxGoods">
        select * ,

        sell_user.nx_jrdh_user_id 'sell_user_nx_jrdh_user_id',
        sell_user.nx_jrdh_wx_avartra_url 'sell_user_nx_jrdh_wx_avartra_url',
        sell_user.nx_jrdh_wx_nick_name 'sell_user_nx_jrdh_wx_nick_name',
        sell_user.nx_jrdh_url_change 'sell_user_nx_jrdh_url_change'
        from nx_department_orders as dor
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        ndg.nx_dg_dfg_goods_father_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id

        left join nx_department_dis_goods as nddg on nddg.nx_DDG_dis_goods_id = ndg.nx_distributer_goods_id
        and nddg.nx_DDG_department_id = dor.nx_DO_department_id
        left join nx_distributer_standard as ds on ds.nx_DS_dis_goods_id = ndg.nx_distributer_goods_id
        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_distributer_purchase_goods_id =
        dor.nx_DO_purchase_goods_id
        left join nx_jrdh_user as sell_user on sell_user.nx_jrdh_user_id = ndpg.nx_DPG_sell_user_id
        left join nx_jrdh_user as buyer on buyer.nx_jrdh_user_id = ndpg.nx_DPG_buy_user_id
        left join nx_distributer_weight as ndw on ndw.nx_distributer_weight_id = dor.nx_DO_weight_id
        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="purGoodsId != null ">
                and dor.nx_DO_purchase_goods_id = #{purGoodsId}
            </if>
        </where>
        order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort
    </select>
    <select id="queryDepOrdersAcount" resultType="java.lang.Integer">
        select COUNT(*) from nx_department_orders as dor
        left join nx_distributer_weight as ndw on ndw.nx_distributer_weight_id = dor.nx_DO_weight_id
        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_distributer_purchase_goods_id =
        dor.nx_DO_purchase_goods_id
       left join nx_distributer_father_goods as grand on grand.nx_distributer_father_goods_id = dor.nx_DO_dis_goods_grand_id
        left join   nx_distributer_father_goods as great on great.nx_distributer_father_goods_id = grand.nx_dfg_fathers_father_id

        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="fatherId != null">
                and dor.nx_DO_dis_goods_father_id = #{fatherId}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id = #{disGoodsId}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="startDate != null">
                and dor.nx_DO_arrive_date &gt;=  #{startDate}
            </if>

            <if test="stopDate != null">
                and dor.nx_DO_arrive_date &lt;=  #{stopDate}
            </if>
            <if test="dayuStatus != null">
                and dor.nx_DO_status &gt; #{dayuStatus}
            </if>
            <if test="nxGoodsId != null">
                and dor.nx_DO_nx_goods_id = #{nxGoodsId}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>
            <if test="greatGrandId != null">
                and great.nx_distributer_father_goods_id = #{greatGrandId}
            </if>
            <if test="gbDisId != null">
                and dor.nx_DO_gb_distributer_id = #{gbDisId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>

            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and dor.nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and dor.nx_DO_department_id = #{depId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>

            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="subtotal != null">
                and dor.nx_DO_subtotal &gt; #{subtotal}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>

            <if test="purGoodsId != null and purGoodsId == 1">
                and dor.nx_DO_purchase_goods_id is not null and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="purGoodsId != null and purGoodsId == 0">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purGoodsId != null and purGoodsId == -1">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="hasWeight != null and hasWeight == 1">
                and dor.nx_DO_weight is not null
            </if>
            <if test="hasWeight != null and hasWeight == -1">
                and dor.nx_DO_weight is null
            </if>
            <if test="hasPrice != null and hasPrice == 1">
                and dor.nx_DO_price is not null
            </if>
            <if test="hasPrice != null and hasPrice == -1">
                and dor.nx_DO_price is null
            </if>

            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>

            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id &gt; 0
            </if>

            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="weightType != null">
                and ndw.nx_dw_type = #{weightType}
            </if>
            <if test="inputType != null">
                and ndpg.nx_DPG_input_type = #{inputType}
            </if>
            <if test="nxDepIds != null">
                and dor.nx_DO_department_father_id in
                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>

            </if>
            <if test="gbDepIds != null">
                and dor.nx_DO_gb_department_id in
                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>

            </if>
        </where>
    </select>
    <select id="queryDepOrdersSubtotal" resultType="java.lang.Double">
        select SUM(nx_DO_subtotal) from nx_department_orders dor
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="fatherId != null">
                and dor.nx_DO_dis_goods_father_id = #{fatherId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id = #{disGoodsId}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and nx_DO_department_id = #{depId}
            </if>
            <if test="resFatherId != null">
                and nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and nx_DO_status &gt; #{dayuStatus}
            </if>
            <if test="subtotal != null">
                and nx_DO_subtotal &gt; #{subtotal}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and nx_DO_weight_id is null
            </if>
        </where>
    </select>
    <select id="queryDepOrdersCostSubtotal" resultType="java.lang.Double">
        select SUM(nx_DO_cost_subtotal) from nx_department_orders dor
        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="subtotal != null">
                and nx_DO_subtotal &gt; #{subtotal}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and nx_DO_weight_id is null
            </if>
        </where>
    </select>
    <select id="queryDepOrdersProfitSubtotal" resultType="java.lang.Double">
        select SUM(dor.nx_DO_profit_subtotal) from nx_department_orders as dor
        <where>

            <if test="goodsId != null">
                and dor.nx_DO_dis_goods_id = #{goodsId}
            </if>
            <if test="fatherId != null">
                and dor.nx_DO_dis_goods_father_id = #{fatherId}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="subtotal != null">
                and nx_DO_subtotal &gt; #{subtotal}
            </if>
            <if test="startDate != null">
                and dor.nx_DO_arrive_date &gt;=  #{startDate}
            </if>

            <if test="stopDate != null">
                and dor.nx_DO_arrive_date &lt;=  #{stopDate}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and nx_DO_weight_id is null
            </if>
        </where>
    </select>

    <resultMap id="comUser" type="NxCommunityUserEntity">
        <id property="nxCommunityUserId" column="nx_community_user_id"/>
        <result property="nxCouWxAvartraUrl" column="nx_COU_wx_avartra_url"/>
        <result property="nxCouWxNickName" column="nx_COU_wx_nick_name"/>
        <result property="nxCouWxPhone" column="nx_COU_wx_phone"/>
        <result property="nxCouCommunityId" column="nx_COU_community_id"/>
    </resultMap>

    <resultMap id="nxComm" type="NxCommunityEntity">
        <id property="nxCommunityId" column="nx_community_id"/>
        <result property="nxCommunityName" column="nx_community_name"/>
        <association property="nxCommunityUserEntity" resultMap="comUser"/>
    </resultMap>
    <resultMap id="restrauntWithCommunityUser" type="NxRestrauntEntity">
        <id property="nxRestrauntId" column="nx_restraunt_id"/>
        <result property="nxRestrauntName" column="nx_restraunt_name"/>
        <result property="nxRestrauntAttrName" column="nx_restraunt_attr_name"/>
        <result property="nxRestrauntFatherId" column="nx_restraunt_father_id"/>
        <result property="nxRestrauntIsGroupDep" column="nx_restraunt_is_group_dep"/>
        <result property="nxRestrauntComId" column="nx_restraunt_com_id"/>
        <result property="nxRestrauntType" column="nx_restraunt_type"/>
        <result property="nxRestrauntNumber" column="nx_restraunt_number"/>
        <result property="nxRestrauntServiceLevel" column="nx_restraunt_service_level"/>
        <result property="nxRestrauntSettleType" column="nx_restraunt_settle_type"/>
        <result property="nxRestrauntOweBoxNumber" column="nx_restraunt_owe_box_number"/>
        <result property="nxRestrauntDeliveryBoxNumber" column="nx_restraunt_delivery_box_number"/>
        <result property="nxRestrauntMaxTime" column="nx_restraunt_max_time"/>
        <result property="nxRestrauntMinTime" column="nx_restraunt_min_time"/>
        <result property="nxRestrauntDeliveryCost" column="nx_restraunt_delivery_cost"/>
        <result property="nxRestrauntDeliveryLimit" column="nx_restraunt_delivery_limit"/>
        <result property="nxRestrauntUnPayTotal" column="nx_restraunt_unPay_total"/>
        <result property="nxRestrauntWorkingStatus" column="nx_restraunt_working_status"/>
        <result property="nxRestrauntSubAmount" column="nx_restraunt_sub_amount"/>
        <result property="nxRestrauntClickCount" column="nx_restraunt_click_count"/>
        <result property="nxRestrauntAddCount" column="nx_restraunt_add_count"/>
        <result property="nxRestrauntPayTotal" column="nx_restraunt_pay_total"/>
        <result property="nxRestrauntProfitTotal" column="nx_restraunt_profit_total"/>
        <result property="nxRestrauntProfitPercent" column="nx_restraunt_profit_percent"/>
        <association property="nxCommunityEntity" resultMap="nxComm"/>

    </resultMap>

    <select id="queryOrderNxRestrauntList" resultMap="restrauntWithCommunityUser">
        select *
        from nx_department_orders as dor
        left join nx_restraunt as nr on nr.nx_restraunt_id = dor.nx_DO_nx_comm_restraunt_id
        left join nx_community as nc on nc.nx_community_id = nr.nx_restraunt_com_id
        left join nx_community_user as ncu on ncu.nx_COU_community_id = nc.nx_community_id
        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>

            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_Date = #{arriveDate}
            </if>
            and dor.nx_DO_gb_department_id = -1 and dor.nx_DO_department_id = -1
        </where>
        order by nr.nx_restraunt_id
    </select>
    <resultMap id="gbDepartmentWithOrder" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentAttrName" column="gb_department_attr_name"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentSettleType" column="gb_department_settle_type"/>
        <result property="gbDepartmentFilePath" column="gb_department_file_path"/>
        <result property="gbDepartmentFatherId" column="gb_department_father_id"/>
        <result property="gbDepartmentIsGroupDep" column="gb_department_is_group_dep"/>
        <result property="gbDepartmentAttrName" column="gb_department_attr_name"/>
        <result property="gbDepartmentDisId" column="gb_department_dis_id"/>
        <association property="nxDepartmentOrdersEntities" resultMap="applys"/>
    </resultMap>
    <select id="queryOrderGbDepartmentList" resultMap="gbDepartmentWithOrder">
        select *
        from nx_department_orders as dor
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = dor.nx_DO_gb_department_father_id
        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDisId != null">
                and dor.nx_DO_gb_distributer_id = #{gbDisId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>

            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_Date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            and dor.nx_DO_nx_comm_restraunt_id = -1 and dor.nx_DO_department_id = -1
        </where>
        order by gd.gb_department_id
    </select>




    <select id="queryDepWeightOrder" resultMap="applys">
        select * ,
        sell_user.nx_jrdh_user_id 'sell_user_nx_jrdh_user_id',
        sell_user.nx_jrdh_wx_avartra_url 'sell_user_nx_jrdh_wx_avartra_url',
        sell_user.nx_jrdh_wx_nick_name 'sell_user_nx_jrdh_wx_nick_name',
        sell_user.nx_jrdh_url_change 'sell_user_nx_jrdh_url_change'
        from nx_department_orders as dor
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dor.nx_DO_dis_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id
        left join nx_department_dis_goods as nddg on nddg.nx_DDG_dis_goods_id = ndg.nx_distributer_goods_id
        and nddg.nx_DDG_department_id = dor.nx_DO_department_id
        left join nx_distributer_standard as ds on ds.nx_DS_dis_goods_id = ndg.nx_distributer_goods_id
        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_distributer_purchase_goods_id =
        dor.nx_DO_purchase_goods_id
        left join nx_jrdh_user as sell_user on sell_user.nx_jrdh_user_id = ndpg.nx_DPG_sell_user_id
        left join nx_jrdh_user as buyer on buyer.nx_jrdh_user_id = ndpg.nx_DPG_buy_user_id
        left join nx_distributer_weight as ndw on ndw.nx_distributer_weight_id = dor.nx_DO_weight_id
        left join nx_distributer_user as ndu on ndu.nx_distributer_user_id = dor.nx_DO_is_agent
        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depId != null">
                and nx_DO_department_id = #{depId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>


            <if test="hasWeight != null and hasWeight == 1">
                and nx_DO_weight is not null
            </if>
            <if test="hasWeight != null and hasWeight == -1">
                and nx_DO_weight is null
            </if>
            <if test="hasPrice != null and hasPrice == 1">
                and nx_DO_price is not null
            </if>
            <if test="hasPrice != null and hasPrice == -1">
                and nx_DO_price is null
            </if>
            <if test="offset != null and limit != null">
                limit #{offset}, #{limit}
            </if>
            <if test="orderBy != null and orderBy == 'time'">
                order by dor.nx_DO_today_order
            </if>
            <if test="orderBy != null and orderBy == 'sort'">
                order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort, ndpg.nx_DPG_batch_id,
                ndpg.nx_DPG_nx_weight_id
            </if>
            <if test="orderBy != null and orderBy == 'send'">
                order by  dor.nx_DO_purchase_status, ndpg.nx_DPG_input_type DESC , ndpg.nx_DPG_batch_id,
                ndpg.nx_DPG_nx_weight_id,great.nx_dfg_father_goods_sort,ndfg.nx_dfg_father_goods_sort,
                ndg.nx_dg_goods_sort
            </if>
        </where>
    </select>
    <select id="queryNotWeightDisOrdersByParams" resultMap="applys">
        select * ,
        sell_user.nx_jrdh_user_id 'sell_user_nx_jrdh_user_id',
        sell_user.nx_jrdh_wx_avartra_url 'sell_user_nx_jrdh_wx_avartra_url',
        sell_user.nx_jrdh_wx_nick_name 'sell_user_nx_jrdh_wx_nick_name',
        sell_user.nx_jrdh_url_change 'sell_user_nx_jrdh_url_change'
        from nx_department_orders as dor
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dor.nx_DO_dis_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id
        left join nx_department_dis_goods as nddg on nddg.nx_DDG_dis_goods_id = ndg.nx_distributer_goods_id
        and nddg.nx_DDG_department_id = dor.nx_DO_department_id
        left join nx_distributer_standard as ds on ds.nx_DS_dis_goods_id = ndg.nx_distributer_goods_id
        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_DPG_dis_goods_id =
        dor.nx_DO_dis_goods_id
        left join nx_jrdh_user as sell_user on sell_user.nx_jrdh_user_id = ndpg.nx_DPG_sell_user_id
        left join nx_jrdh_user as buyer on buyer.nx_jrdh_user_id = ndpg.nx_DPG_buy_user_id
        left join nx_distributer_weight as ndw on ndw.nx_distributer_weight_id = dor.nx_DO_weight_id
        left join nx_distributer_user as ndu on ndu.nx_distributer_user_id = dor.nx_DO_is_agent

        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="weight != null and weight == 1">
                and dor.nx_DO_weight is not null
            </if>
            <if test="weightId != null and weightId != -1">
                and dor.nx_DO_weight_id = #{weightId}
            </if>
            <if test="weightId != null and weightId == -1">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="purGoodsId != null ">
                and dor.nx_DO_purchase_goods_id = #{purGoodsId}
            </if>
            <if test="equalPurStatus != null ">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="dayuPurStatus != null ">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
        </where>
        order by dor.nx_DO_today_order
    </select>

    <resultMap id="appDep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="app_gb_department_id"/>
        <result property="gbDepartmentName" column="app_gb_department_name"/>
        <result property="gbDepartmentAttrName" column="app_gb_department_attr_name"/>
        <result property="gbDepartmentType" column="app_gb_department_type"/>
        <result property="gbDepartmentDisId" column="app_gb_department_dis_id"/>
    </resultMap>

    <resultMap id="nxDisGbDis" type="NxDistributerGbDistributerEntity">
        <id property="nxDistributerGbDistributerId" column="nx_distributer_gb_distributer_id"/>
        <result property="nxDgdGbDistributerId" column="nx_DGD_gb_distributer_id"/>
        <result property="nxDgdNxDistributerId" column="nx_DGD_nx_distributer_id"/>
        <result property="nxDgdGbDepId" column="nx_DGD_gb_dep_id"/>
        <result property="nxDgdGbPayMethod" column="nx_dgd_gb_pay_method"/>
        <result property="nxDgdGbPayPeriodWeek" column="nx_dgd_gb_pay_period_week"/>
        <result property="nxDgdGbDepUserId" column="nx_DGD_gb_dep_user_id"/>
        <result property="nxDgdGbGoodsPrice" column="nx_DGD_gb_goods_price"/>
        <result property="nxDgdStatus" column="nx_DGD_status"/>
    </resultMap>
    <resultMap id="gbDis" type="GbDistributerEntity">
        <id property="gbDistributerId" column="gb_distributer_id"/>
        <result property="gbDistributerBusinessType" column="gb_distributer_business_type"/>
        <result property="gbDistributerName" column="gb_distributer_name"/>
        <result property="gbDistributerImg" column="gb_distributer_img"/>
        <result property="gbDistributerAddress" column="gb_distributer_address"/>
        <result property="gbDistributerManager" column="gb_distributer_manager"/>
        <result property="gbDistributerPhone" column="gb_distributer_phone"/>
        <result property="gbDistributerSettleDate" column="gb_distributer_settle_date"/>
        <result property="gbDistributerSettleMonth" column="gb_distributer_settle_month"/>
        <result property="gbDistributerSettleWeek" column="gb_distributer_settle_week"/>
        <result property="gbDistributerSettleFullTime" column="gb_distributer_settle_full_time"/>
        <result property="gbDistributerSettleTimes" column="gb_distributer_settle_times"/>
        <result property="gbDistributerSettleYear" column="gb_distributer_settle_year"/>
        <result property="gbDistributerTimeQuantum" column="gb_distributer_time_quantum"/>
        <association property="appSupplierDepartment" resultMap="appDep"/>
        <association property="nxDistributerGbDistributerEntity" resultMap="nxDisGbDis"/>
        <collection property="mendianDepartmentList" resultMap="gbDepartmentWithOrder"/>
    </resultMap>
    <select id="queryOrderGbDistributerList" resultMap="gbDis">
        select *,
        app.gb_department_id 'app_gb_department_id',
        app.gb_department_name 'app_gb_department_name',
        app.gb_department_attr_name 'app_gb_department_attr_name',
        app.gb_department_dis_id 'app_gb_department_dis_id',
        app.gb_department_type 'app_gb_department_type'
        from nx_department_orders as dor
        left join gb_department as gdd on gdd.gb_department_id = dor.nx_DO_gb_department_father_id
        left join gb_distributer as gd on gd.gb_distributer_id = gdd.gb_department_dis_id
        left join gb_department as app on app.gb_department_dis_id = gd.gb_distributer_id
        and app.gb_department_type = 5
        left join nx_distributer_gb_distributer as ndgd on ndgd.nx_DGD_nx_distributer_id = #{disId}

        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDisId != null">
                and dor.nx_DO_gb_distributer_id = #{gbDisId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>

            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_Date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            and dor.nx_DO_nx_comm_restraunt_id = -1 and dor.nx_DO_department_id = -1
        </where>
        order by gdd.gb_department_id

    </select>
    <select id="queryGbOrderItem" resultType="com.nongxinle.entity.NxDepartmentOrdersEntity">
        select *
        from nx_department_orders dor
        where dor.nx_DO_gb_department_order_id = #{gbDepartmentOrdersId}
    </select>


    <select id="disGetPurchaseGoodsApplys" resultMap="unPlanPurchaseOrdersDisFatherGoodsAAA">
        select * from nx_department_orders as purDor
        left join nx_distributer_purchase_goods as dpg on purDor.nx_DO_purchase_goods_id =
        dpg.nx_distributer_purchase_goods_id
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = purDor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as dfg on dfg.nx_distributer_father_goods_id =
        dpg.nx_DPG_dis_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        dfg.nx_dfg_fathers_father_id

        left join nx_department as purDs on purDs.nx_department_id = purDor.nx_DO_department_id
        left join nx_department as purDf on purDf.nx_department_id = purDor.nx_DO_department_father_id
        left join gb_department as purGbDs on purGbDs.gb_department_id = purDor.nx_DO_gb_department_id
        left join gb_department as purGbDf on purGbDf.gb_department_id = purDor.nx_DO_gb_department_father_id
        left join nx_restraunt as purNr on purNr.nx_restraunt_id = purDor.nx_DO_nx_comm_restraunt_id

        <where>
            <if test="disId != null">
                and purDor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and purDor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="status != null">
                and purDor.nx_DO_status &lt; #{status}
            </if>
            <if test="purStatus != null">
                and purDor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="equalStatus != null">
                and purDor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and purDor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="purType != null and purType == -1">
                and purDor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and purDor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and purDor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and purDor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and purDor.nx_DO_weight_id is null
            </if>


        </where>
        order by great.nx_dfg_father_goods_sort,dfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort,
        purDs.nx_department_id,
        purDf.nx_department_id, purGbDs.gb_department_id,purGbDf.gb_department_id,purNr.nx_restraunt_id

    </select>

    <select id="disGetUnPlanPurchaseApplysSearch" resultMap="unPlanPurchaseOrdersDisFatherGoods">

        select
        dor.nx_department_orders_id,
        dor.nx_DO_nx_goods_id,
        dor.nx_DO_order_user_id,
        dor.nx_DO_apply_date,
        dor.nx_DO_apply_only_time,
        dor.nx_DO_quantity,
        dor.nx_DO_standard,
        dor.nx_DO_remark,
        dor.nx_DO_status,
        dor.nx_DO_purchase_status,
        dor.nx_DO_weight,
        dor.nx_DO_price,
        dor.nx_DO_subtotal,
        dor.nx_DO_apply_full_time,
        dor.nx_DO_arrive_only_date,
        dor.nx_DO_nx_goods_father_id,
        dor.nx_DO_dis_goods_id,
        dor.nx_DO_dep_dis_goods_price,
        dor.nx_DO_department_id,
        dor.nx_DO_distributer_id,
        dor.nx_DO_is_agent,
        dor.nx_DO_purchase_goods_id,
        dor.nx_DO_dep_dis_goods_id,
        dor.nx_DO_gb_department_id,
        dor.nx_DO_gb_department_father_id,
        dor.nx_DO_nx_comm_restraunt_id,
        dor.nx_DO_nx_comm_restraunt_id,
        dor.nx_DO_nx_community_id,
        dor.nx_DO_nx_restraunt_order_id,
        dor.nx_DO_cost_price,
        dor.nx_DO_cost_price_update,
        dor.nx_DO_cost_price_level,
        dor.nx_DO_purchase_status,

        newDor.nx_department_orders_id 'newDor_nx_department_orders_id',
        newDor.nx_DO_quantity 'newDor_nx_DO_quantity',
        newDor.nx_DO_standard 'newDor_nx_DO_standard',
        newDor.nx_DO_remark 'newDor_nx_DO_remark',
        newDor.nx_DO_status 'newDor_nx_DO_status',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',
        newDor.nx_DO_weight 'newDor_nx_DO_weight',
        newDor.nx_DO_price 'newDor_nx_DO_price',
        newDor.nx_DO_subtotal 'newDor_nx_DO_subtotal',
        newDor.nx_DO_dis_goods_id 'newDor_nx_DO_dis_goods_id',
        newDor.nx_DO_dis_goods_grand_id 'newDor_nx_DO_dis_goods_grand_id',
        newDor.nx_DO_dis_goods_father_id 'newDor_nx_DO_dis_goods_father_id',
        newDor.nx_DO_dep_dis_goods_price 'newDor_nx_DO_dep_dis_goods_price',
        newDor.nx_DO_department_id 'newDor_nx_DO_department_id',
        newDor.nx_DO_distributer_id 'newDor_nx_DO_distributer_id',
        newDor.nx_DO_is_agent 'newDor_nx_DO_is_agent',
        newDor.nx_DO_purchase_goods_id 'newDor_nx_DO_purchase_goods_id',
        newDor.nx_DO_gb_department_order_id 'newDor_nx_DO_gb_department_order_id',
        newDor.nx_DO_gb_department_id 'newDor_nx_DO_gb_department_id',
        newDor.nx_DO_gb_department_father_id 'newDor_nx_DO_gb_department_father_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_community_id 'newDor_nx_DO_nx_community_id',
        newDor.nx_DO_nx_restraunt_order_id 'newDor_nx_DO_nx_restraunt_order_id',
        newDor.nx_DO_cost_price 'newDor_nx_DO_cost_price',
        newDor.nx_DO_cost_price_update 'newDor_nx_DO_cost_price_update',
        newDor.nx_DO_cost_price_level 'newDor_nx_DO_cost_price_level',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',

        dfg.nx_distributer_father_goods_id,
        dfg.nx_dfg_father_goods_name,
        dg.nx_distributer_goods_id,
        dg.nx_dg_goods_name,
        dg.nx_dg_goods_brand,
        dg.nx_dg_goods_detail,
        dg.nx_dg_goods_place,
        dg.nx_dg_goods_standardname,
        dg.nx_dg_goods_standard_weight,
        dg.nx_dg_nx_goods_father_color,
        dg.nx_dg_buying_price_is_grade,
        dg.nx_dg_buying_price,
        dg.nx_dg_buying_price_one,
        dg.nx_dg_buying_price_one_update,
        dg.nx_dg_buying_price_two,
        dg.nx_dg_buying_price_two_update,
        dg.nx_dg_buying_price_three,
        dg.nx_dg_buying_price_three_update,
        dg.nx_dg_buying_price_update,
        dg.nx_dg_goods_py,
        dg.nx_dg_goods_pinyin,
        da.nx_distributer_alias_id,
        da.nx_DA_alias_name,
        ds.nx_department_id 'nx_department_id',
        ds.nx_department_name 'nx_department_name',
        ds.nx_department_attr_name 'nx_department_attr_name',
        ds.nx_department_type 'nx_department_type',
        ds.nx_department_father_id 'nx_department_father_id',
        ds.nx_department_is_group_dep 'nx_department_is_group_dep',
        df.nx_department_id 'dd_nx_department_id',
        df.nx_department_name 'dd_nx_department_name',
        df.nx_department_attr_name 'dd_nx_department_attr_name',

        nds.nx_department_id 'nds_nx_department_id',
        nds.nx_department_name 'nds_nx_department_name',
        nds.nx_department_attr_name 'nds_nx_department_attr_name',
        nds.nx_department_type 'nds_nx_department_type',
        nds.nx_department_father_id 'nds_nx_department_father_id',
        nds.nx_department_is_group_dep 'nds_nx_department_is_group_dep',
        ndf.nx_department_id 'ndf_dd_nx_department_id',
        ndf.nx_department_name 'ndf_dd_nx_department_name',
        ndf.nx_department_attr_name 'ndf_dd_nx_department_attr_name',

        nr.nx_restraunt_id,
        nr.nx_restraunt_attr_name,
        nr.nx_restraunt_name,

        ngds.gb_department_id 'nds_gb_department_id',
        ngds.gb_department_name 'nds_gb_department_name',
        ngds.gb_department_attr_name 'nds_gb_department_attr_name',
        ngds.gb_department_type 'nds_gb_department_type',
        ngds.gb_department_father_id 'nds_gb_department_father_id',
        ngds.gb_department_is_group_dep 'nds_gb_department_is_group_dep',
        ngdf.gb_department_id 'ndf_dd_gb_department_id',
        ngdf.gb_department_name 'ndf_dd_gb_department_name',
        ngdf.gb_department_attr_name 'ndf_dd_gb_department_attr_name',
        gds.gb_department_id 'gb_department_id',
        gds.gb_department_name 'gb_department_name',
        gds.gb_department_attr_name 'gb_department_attr_name',
        gds.gb_department_type 'gb_department_type',
        gds.gb_department_father_id 'gb_department_father_id',
        gds.gb_department_is_group_dep 'gb_department_is_group_dep',
        gdf.gb_department_id 'dd_gb_department_id',
        gdf.gb_department_name 'dd_gb_department_name',
        gdf.gb_department_attr_name 'dd_gb_department_attr_name',

        ndnr.nx_restraunt_id 'ndnr_nx_restraunt_id',
        ndnr.nx_restraunt_attr_name 'ndnr_nx_restraunt_attr_name',
        dpg.nx_distributer_purchase_goods_id,
        dpg.nx_DPG_dis_goods_id,
        dpg.nx_DPG_quantity,
        dpg.nx_DPG_status,
        dpg.nx_DPG_orders_amount,
        dpg.nx_DPG_time,
        dpg.nx_DPG_apply_date,
        dpg.nx_DPG_purchase_date,
        dpg.nx_DPG_cost_level,
        dpg.nx_DPG_buy_price,
        purDor.nx_department_orders_id 'purDor_nx_department_orders_id',
        purDor.nx_DO_purchase_goods_id 'purDor_nx_DO_purchase_goods_id',
        purDor.nx_DO_department_id 'purDor_nx_DO_department_id',
        purDor.nx_DO_department_father_id 'purDor_nx_DO_department_father_id',
        purDor.nx_DO_quantity 'purDor_nx_DO_quantity',
        purDor.nx_DO_standard 'purDor_nx_DO_standard',
        purDor.nx_DO_status 'purDor_nx_DO_status',
        purDor.nx_DO_weight 'purDor_nx_DO_weight',
        purDor.nx_DO_price 'purDor_nx_DO_price',
        purDor.nx_DO_subtotal 'purDor_nx_DO_subtotal',
        purDor.nx_DO_gb_department_order_id 'purDor_nx_DO_gb_department_order_id',
        purDor.nx_DO_gb_department_id 'purDor_nx_DO_gb_department_id',
        purDor.nx_DO_gb_department_father_id 'purDor_nx_DO_gb_department_father_id',
        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',
        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',
        purDor.nx_DO_nx_community_id 'purDor_nx_DO_nx_community_id',
        purDor.nx_DO_nx_restraunt_order_id 'purDor_nx_DO_nx_restraunt_order_id',

        needNotDor.nx_department_orders_id 'needNotDor_nx_department_orders_id',
        needNotDor.nx_DO_remark 'needNotDor_nx_DO_remark',
        needNotDor.nx_DO_status 'needNotDor_nx_DO_status',
        needNotDor.nx_department_orders_id 'needNotDor_nx_department_id',
        needNotDor.nx_DO_purchase_goods_id 'needNotDor_nx_Do_purchase_goods_id',
        needNotDor.nx_DO_department_id 'needNotDor_nx_DO_department_id',
        needNotDor.nx_DO_department_father_id 'needNotDor_nx_DO_department_father_id',
        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_father_id',
        needNotDor.nx_DO_quantity 'needNotDor_nx_DO_quantity',
        needNotDor.nx_DO_standard 'needNotDor_nx_DO_standard',
        needNotDor.nx_DO_weight 'needNotDor_nx_DO_weight',
        needNotDor.nx_DO_price 'needNotDor_nx_DO_price',
        needNotDor.nx_DO_subtotal 'needNotDor_nx_DO_subtotal',
        needNotDor.nx_DO_dis_goods_id 'needNotDor_nx_DO_dis_goods_id',
        needNotDor.nx_DO_purchase_status 'needNotDor_nx_DO_purchase_status',
        needNotDor.nx_DO_cost_price 'needNotDor_nx_DO_cost_price',
        needNotDor.nx_DO_cost_price_level 'needNotDor_nx_DO_cost_price_level',
        needNotDor.nx_DO_cost_price_update 'needNotDor_nx_DO_cost_price_update',

        needNotDor.nx_DO_dep_dis_goods_price 'needNotDor_nx_DO_dep_dis_goods_price',
        needNotDor.nx_DO_distributer_id 'needNotDor_nx_DO_distributer_id',

        needNotDor.nx_DO_gb_department_order_id 'needNotDor_nx_DO_gb_department_order_id',
        needNotDor.nx_DO_gb_department_id 'needNotDor_nx_DO_gb_department_id',
        needNotDor.nx_DO_gb_department_father_id 'needNotDor_nx_DO_gb_department_father_id',
        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_id',
        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_id',
        needNotDor.nx_DO_nx_community_id 'needNotDor_nx_DO_nx_community_id',
        needNotDor.nx_DO_nx_restraunt_order_id 'needNotDor_nx_DO_nx_restraunt_order_id',


        purDs.nx_department_id 'purDs_nx_department_id',
        purDs.nx_department_father_id 'purDs_nx_department_father_id',
        purDs.nx_department_name 'purDs_nx_department_name',
        purDs.nx_department_attr_name 'purDs_nx_department_attr_name',
        purDf.nx_department_id 'purDf_nx_department_id',
        purDf.nx_department_name 'purDf_nx_department_name',
        purDf.nx_department_attr_name 'purDf_nx_department_attr_name',
        purGbDs.gb_department_id 'purGbDs_gb_department_id',
        purGbDs.gb_department_name 'purGbDs_gb_department_name',
        purGbDf.gb_department_id 'purGbDf_gb_department_id',
        purGbDf.gb_department_name 'purGbDf_gb_department_name',
        purGbDf.gb_department_attr_name 'purGbDf_gb_department_attr_name',
        purNr.nx_restraunt_id 'purNr_nx_restraunt_id',
        purNr.nx_restraunt_name 'purNr_nx_restraunt_name',
        purNr.nx_restraunt_attr_name 'purNr_nx_restraunt_attr_name',

        dpgOrder.nx_distributer_purchase_goods_id 'order_nx_distributer_purchase_goods_id',
        dpgOrder.nx_DPG_distributer_id 'order_nx_DPG_distributer_id',
        dpgOrder.nx_DPG_cost_level 'order_nx_DPG_cost_level',
        dpgOrder.nx_DPG_status 'order_nx_DPG_status',
        dpgOrder.nx_DPG_dis_goods_id 'order_nx_DPG_dis_goods_id',
        dpgOrder.nx_DPG_orders_amount 'order_nx_DPG_orders_amount'

        from nx_department_orders as dor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_alias as da on da.nx_DA_dis_goods_id = dg.nx_distributer_goods_id
        left join nx_distributer_purchase_goods as dpg on dpg.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and dpg.nx_DPG_orders_amount is null

        left join nx_distributer_father_goods as dfg on dfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_father_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        dfg.nx_dfg_fathers_father_id

        left join nx_department_orders as newDor on newDor.nx_DO_dis_goods_id = dg.nx_distributer_goods_id
        and newDor.nx_DO_purchase_status = 0
        left join nx_department_orders as needNotDor on needNotDor.nx_DO_dis_goods_id = dg.nx_distributer_goods_id
        and needNotDor.nx_DO_purchase_goods_id = -1 and needNotDor.nx_DO_status &lt; 3

        left join nx_distributer_purchase_goods as dpgOrder on dpgOrder.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and dpgOrder.nx_DPG_orders_amount is not null and dpgOrder.nx_DPG_status &lt; 4
        left join nx_department_orders as purDor on purDor.nx_DO_purchase_goods_id =
        dpgOrder.nx_distributer_purchase_goods_id
        and purDor.nx_DO_status &lt; 3

        left join nx_department as ds on ds.nx_department_id = newDor.nx_DO_department_id
        left join nx_department as df on df.nx_department_id = ds.nx_department_father_id
        left join gb_department as gds on gds.gb_department_id = newDor.nx_DO_gb_department_id
        left join gb_department as gdf on gdf.gb_department_id = newDor.nx_DO_gb_department_father_id
        left join nx_restraunt as nr on nr.nx_restraunt_id = newDor.nx_DO_nx_comm_restraunt_id
        left join nx_department as nds on nds.nx_department_id = needNotDor.nx_DO_department_id
        left join nx_department as ndf on ndf.nx_department_id = nds.nx_department_father_id
        left join gb_department as ngds on ngds.gb_department_id = needNotDor.nx_DO_gb_department_id
        left join gb_department as ngdf on ngdf.gb_department_id = needNotDor.nx_DO_gb_department_father_id
        left join nx_restraunt as ndnr on ndnr.nx_restraunt_id = needNotDor.nx_DO_nx_comm_restraunt_id
        left join nx_department as purDs on purDs.nx_department_id = purDor.nx_DO_department_id
        left join nx_department as purDf on purDf.nx_department_id = purDor.nx_DO_department_father_id
        left join gb_department as purGbDs on purGbDs.gb_department_id = purDor.nx_DO_gb_department_id
        left join gb_department as purGbDf on purGbDf.gb_department_id = purDor.nx_DO_gb_department_father_id
        left join nx_restraunt as purNr on purNr.nx_restraunt_id = purDor.nx_DO_nx_comm_restraunt_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and purDor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and purDor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and purDor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and purDor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and purDor.nx_DO_weight_id is null
            </if>
            <if test="searchStr != null">
                and dg.nx_dg_goods_name like concat('%', #{searchStr}, '%')
                or dg.nx_dg_goods_brand like concat('%', #{searchStr}, '%')
                or dg.nx_dg_goods_pinyin like concat('%', #{searchPinyin}, '%')
                or dg.nx_dg_goods_py like concat('%', #{searchPinyin}, '%')
                or da.nx_DA_alias_name like concat('%', #{searchStr}, '%')
            </if>
        </where>
    </select>

    <select id="queryDepWeightOrderSearch" resultMap="applys">
        select * from
        (
        select *
        from nx_distributer_goods as dg
        left join nx_distributer_standard as ds on ds.nx_DS_dis_goods_id = dg.nx_distributer_goods_id
        left join nx_distributer_alias as da on da.nx_DA_dis_goods_id = dg.nx_distributer_goods_id
        left join nx_distributer_father_goods as ndfg
        on ndfg.nx_distributer_father_goods_id = dg.nx_dg_dfg_goods_father_id
        where (nx_dg_goods_name like concat('%', #{searchStr}, '%')
        or nx_dg_goods_brand like concat('%', #{searchStr}, '%')
        or da.nx_DA_alias_name like concat('%', #{searchStr}, '%')
        or nx_dg_goods_pinyin like concat('%', #{searchPinyin}, '%')
        or nx_dg_goods_py like concat('%', #{searchPinyin}, '%')
        )
        ) as result
        left join nx_department_orders as dor on result.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_user as ndu on ndu.nx_distributer_user_id = dor.nx_DO_is_agent

        <where>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>

            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
        </where>
    </select>

    <select id="disGetPurchaseGoodsApplysCount" resultType="java.lang.Integer">
        select COUNT(*) from

        nx_department_orders as dor
        left join nx_distributer_purchase_goods as ndpg on dor.nx_DO_purchase_goods_id =
        ndpg.nx_distributer_purchase_goods_id
        left join nx_distributer_weight as ndw on ndw.nx_distributer_weight_id = dor.nx_DO_weight_id

        <where>
            <if test="weightStatusEqual != null">
                and ndw.nx_dw_status = #{weightStatusEqual}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="weight != null and weight == 1">
                and dor.nx_DO_weight is not null
            </if>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="inputType != null">
                and ndpg.nx_DPG_input_type = #{inputType}
            </if>

            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="batchId != null and batchId == 1">
                and ndpg.nx_DPG_batch_id is not null
            </if>
            <if test="batchId != null and batchId == 0">
                and ndpg.nx_DPG_batch_id is null or ndpg.nx_DPG_batch_id = -1
            </if>

        </where>
    </select>

    <select id="disGetUnPlanPurchaseApplysNew" resultMap="unPlanPurchaseOrdersDisFatherGoods">
        select
        newDor.nx_department_orders_id 'newDor_nx_department_orders_id',
        newDor.nx_DO_quantity 'newDor_nx_DO_quantity',
        newDor.nx_DO_standard 'newDor_nx_DO_standard',
        newDor.nx_DO_remark 'newDor_nx_DO_remark',
        newDor.nx_DO_status 'newDor_nx_DO_status',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',
        newDor.nx_DO_weight 'newDor_nx_DO_weight',
        newDor.nx_DO_price 'newDor_nx_DO_price',
        newDor.nx_DO_subtotal 'newDor_nx_DO_subtotal',
        newDor.nx_DO_dis_goods_id 'newDor_nx_DO_dis_goods_id',
        newDor.nx_DO_dis_goods_grand_id 'newDor_nx_DO_dis_goods_grand_id',
        newDor.nx_DO_dis_goods_father_id 'newDor_nx_DO_dis_goods_father_id',

        newDor.nx_DO_dep_dis_goods_price 'newDor_nx_DO_dep_dis_goods_price',
        newDor.nx_DO_department_id 'newDor_nx_DO_department_id',
        newDor.nx_DO_distributer_id 'newDor_nx_DO_distributer_id',
        newDor.nx_DO_is_agent 'newDor_nx_DO_is_agent',
        newDor.nx_DO_purchase_goods_id 'newDor_nx_DO_purchase_goods_id',
        newDor.nx_DO_gb_department_order_id 'newDor_nx_DO_gb_department_order_id',
        newDor.nx_DO_gb_department_id 'newDor_nx_DO_gb_department_id',
        newDor.nx_DO_gb_department_father_id 'newDor_nx_DO_gb_department_father_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_community_id 'newDor_nx_DO_nx_community_id',
        newDor.nx_DO_nx_restraunt_order_id 'newDor_nx_DO_nx_restraunt_order_id',


        newDor.nx_DO_cost_price 'newDor_nx_DO_cost_price',
        newDor.nx_DO_cost_price_update 'newDor_nx_DO_cost_price_update',
        newDor.nx_DO_cost_price_level 'newDor_nx_DO_cost_price_level',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',

        purDor.nx_department_orders_id 'purDor_nx_department_orders_id',
        purDor.nx_DO_purchase_goods_id 'purDor_nx_DO_purchase_goods_id',
        purDor.nx_DO_department_id 'purDor_nx_DO_department_id',
        purDor.nx_DO_department_father_id 'purDor_nx_DO_department_father_id',
        purDor.nx_DO_quantity 'purDor_nx_DO_quantity',
        purDor.nx_DO_standard 'purDor_nx_DO_standard',
        purDor.nx_DO_status 'purDor_nx_DO_status',
        purDor.nx_DO_weight 'purDor_nx_DO_weight',
        purDor.nx_DO_price 'purDor_nx_DO_price',
        purDor.nx_DO_subtotal 'purDor_nx_DO_subtotal',
        purDor.nx_DO_gb_department_order_id 'purDor_nx_DO_gb_department_order_id',
        purDor.nx_DO_gb_department_id 'purDor_nx_DO_gb_department_id',
        purDor.nx_DO_gb_department_father_id 'purDor_nx_DO_gb_department_father_id',
        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',
        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',
        purDor.nx_DO_nx_community_id 'purDor_nx_DO_nx_community_id',
        purDor.nx_DO_nx_restraunt_order_id 'purDor_nx_DO_nx_restraunt_order_id',
        purDs.nx_department_id 'purDs_nx_department_id',
        purDs.nx_department_father_id 'purDs_nx_department_father_id',
        purDs.nx_department_name 'purDs_nx_department_name',
        purDs.nx_department_attr_name 'purDs_nx_department_attr_name',
        purDf.nx_department_id 'purDf_nx_department_id',
        purDf.nx_department_name 'purDf_nx_department_name',
        purDf.nx_department_attr_name 'purDf_nx_department_attr_name',
        purGbDs.gb_department_id 'purGbDs_gb_department_id',
        purGbDs.gb_department_name 'purGbDs_gb_department_name',
        purGbDf.gb_department_id 'purGbDf_gb_department_id',
        purGbDf.gb_department_name 'purGbDf_gb_department_name',
        purGbDf.gb_department_attr_name 'purGbDf_gb_department_attr_name',
        purNr.nx_restraunt_id 'purNr_nx_restraunt_id',
        purNr.nx_restraunt_name 'purNr_nx_restraunt_name',
        purNr.nx_restraunt_attr_name 'purNr_nx_restraunt_attr_name',


        dfg.nx_distributer_father_goods_id,
        dfg.nx_dfg_father_goods_name,
        dfg.nx_dfg_fathers_father_id,
        dg.nx_distributer_goods_id,
        dg.nx_dg_goods_name,
        dg.nx_dg_goods_brand,
        dg.nx_dg_goods_detail,
        dg.nx_dg_goods_place,
        dg.nx_dg_goods_standardname,
        dg.nx_dg_goods_standard_weight,
        dg.nx_dg_nx_goods_father_color,
        dg.nx_dg_buying_price_is_grade,
        dg.nx_dg_buying_price,
        dg.nx_dg_buying_price_one,
        dg.nx_dg_buying_price_one_update,
        dg.nx_dg_buying_price_two,
        dg.nx_dg_buying_price_two_update,
        dg.nx_dg_buying_price_three,
        dg.nx_dg_buying_price_three_update,
        dg.nx_dg_buying_price_update,
        dg.nx_dg_dfg_goods_grand_id,
        dg.nx_dg_dfg_goods_father_id,

        ds.nx_department_id 'nx_department_id',
        ds.nx_department_name 'nx_department_name',
        ds.nx_department_attr_name 'nx_department_attr_name',
        ds.nx_department_type 'nx_department_type',
        ds.nx_department_father_id 'nx_department_father_id',
        ds.nx_department_is_group_dep 'nx_department_is_group_dep',
        df.nx_department_id 'dd_nx_department_id',
        df.nx_department_name 'dd_nx_department_name',
        df.nx_department_attr_name 'dd_nx_department_attr_name',


        nr.nx_restraunt_id,
        nr.nx_restraunt_attr_name,
        nr.nx_restraunt_name,


        gds.gb_department_id 'gb_department_id',
        gds.gb_department_name 'gb_department_name',
        gds.gb_department_attr_name 'gb_department_attr_name',
        gds.gb_department_type 'gb_department_type',
        gds.gb_department_father_id 'gb_department_father_id',
        gds.gb_department_is_group_dep 'gb_department_is_group_dep',
        gdf.gb_department_id 'dd_gb_department_id',
        gdf.gb_department_name 'dd_gb_department_name',
        gdf.gb_department_attr_name 'dd_gb_department_attr_name',
        dpgOrder.nx_distributer_purchase_goods_id 'order_nx_distributer_purchase_goods_id',
        dpgOrder.nx_DPG_distributer_id 'order_nx_DPG_distributer_id',
        dpgOrder.nx_DPG_cost_level 'order_nx_DPG_cost_level',
        dpgOrder.nx_DPG_status 'order_nx_DPG_status',
        dpgOrder.nx_DPG_dis_goods_id 'order_nx_DPG_dis_goods_id',
        dpgOrder.nx_DPG_orders_amount 'order_nx_DPG_orders_amount',

        dpg.nx_distributer_purchase_goods_id,
        dpg.nx_DPG_dis_goods_id,
        dpg.nx_DPG_quantity,
        dpg.nx_DPG_status,
        dpg.nx_DPG_orders_amount,
        dpg.nx_DPG_time,
        dpg.nx_DPG_apply_date,
        dpg.nx_DPG_purchase_date,
        dpg.nx_DPG_cost_level,
        dpg.nx_DPG_buy_price


        from nx_department_orders as dor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_purchase_goods as dpg on dpg.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and dpg.nx_DPG_orders_amount is null

        left join nx_distributer_father_goods as dfg on dfg.nx_distributer_father_goods_id = dg.nx_dg_dfg_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        dfg.nx_dfg_fathers_father_id

        left join nx_department_orders as newDor on newDor.nx_DO_dis_goods_id = dg.nx_distributer_goods_id
        and newDor.nx_DO_purchase_status = 0

        left join nx_distributer_purchase_goods as dpgOrder on dpgOrder.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and dpgOrder.nx_DPG_orders_amount is not null and dpgOrder.nx_DPG_status &lt; 4
        left join nx_department_orders as purDor on purDor.nx_DO_purchase_goods_id =
        dpgOrder.nx_distributer_purchase_goods_id

        left join nx_department as ds on ds.nx_department_id = newDor.nx_DO_department_id
        left join nx_department as df on df.nx_department_id = ds.nx_department_father_id
        left join gb_department as gds on gds.gb_department_id = newDor.nx_DO_gb_department_id
        left join gb_department as gdf on gdf.gb_department_id = newDor.nx_DO_gb_department_father_id
        left join nx_restraunt as nr on nr.nx_restraunt_id = newDor.nx_DO_nx_comm_restraunt_id
        left join nx_department as purDs on purDs.nx_department_id = purDor.nx_DO_department_id
        left join nx_department as purDf on purDf.nx_department_id = purDor.nx_DO_department_father_id
        left join gb_department as purGbDs on purGbDs.gb_department_id = purDor.nx_DO_gb_department_id
        left join gb_department as purGbDf on purGbDf.gb_department_id = purDor.nx_DO_gb_department_father_id
        left join nx_restraunt as purNr on purNr.nx_restraunt_id = purDor.nx_DO_nx_comm_restraunt_id

        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>

            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and purDor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and purDor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and purDor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>

        </where>
        order by great.nx_dfg_father_goods_sort ,dfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort,
        df.nx_department_id,ds.nx_department_id

    </select>

    <resultMap id="disGoodsWithNeedNotOrders" type="NxDistributerGoodsEntity">
       <id property="nxDistributerGoodsId" column="nx_distributer_goods_id"/>
        <result property="nxDgWillPriceOneWeight" column="nx_dg_will_price_one_weight"/>
        <result property="nxDgWillPriceTwoWeight" column="nx_dg_will_price_two_weight"/>
        <result property="nxDgWillPriceThreeWeight" column="nx_dg_will_price_three_weight"/>
		<result property="nxDgGoodsStatus" column="nx_dg_goods_status"/>
		<result property="nxDgWillPriceOne" column="nx_dg_will_price_one"/>
        <result property="nxDgWillPriceTwo" column="nx_dg_will_price_two"/>
		<result property="nxDgWillPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
		<result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
		<result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgGoodsSonsSort" column="nx_dg_goods_sons_sort"/>
		<result property="nxDgPurchaseAuto" column="nx_dg_purchase_auto"/>
        <result property="nxDgWillPrice" column="nx_dg_will_price"/>
        <result property="nxDgPriceFirstDay" column="nx_dg_price_first_day"/>
        <result property="nxDgPriceSecondDay" column="nx_dg_price_second_day"/>
        <result property="nxDgPriceThirdDay" column="nx_dg_price_third_day"/>
        <result property="nxDgDfgGoodsGrandId" column="nx_dg_dfg_goods_grand_id"/>
        <result property="nxDgDfgGoodsFatherId" column="nx_dg_dfg_goods_father_id"/>
        <result property="nxDgGoodsFile" column="nx_dg_goods_file"/>
        <result property="nxDgGoodsFileLarge" column="nx_dg_goods_file_large"/>
        <result property="nxDgGoodsName" column="nx_dg_goods_name"/>
        <result property="nxDgGoodsStandardname" column="nx_dg_goods_standardname"/>
        <result property="nxDgNxGoodsFatherColor" column="nx_dg_nx_goods_father_color"/>
        <result property="nxDgGoodsStandardWeight" column="nx_dg_goods_standard_weight"/>
        <result property="nxDgGoodsBrand" column="nx_dg_goods_brand"/>
        <result property="nxDgGoodsPlace" column="nx_dg_goods_place"/>
        <result property="nxDgGoodsDetail" column="nx_dg_goods_detail"/>
        <result property="nxDgGoodsPinyin" column="nx_dg_goods_pinyin"/>
        <result property="nxDgBuyingPrice" column="nx_dg_buying_price"/>
        <result property="nxDgPriceProfitOne" column="nx_dg_price_profit_one"/>
        <result property="nxDgPriceProfitTwo" column="nx_dg_price_profit_two"/>
        <result property="nxDgPriceProfitThree" column="nx_dg_price_profit_three"/>
        <result property="nxDgSupplierId" column="nx_dg_supplier_id"/>
       <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <result property="nxDgBuyingPriceIsGrade" column="nx_dg_buying_price_is_grade"/>
        <result property="nxDgBuyingPriceOne" column="nx_dg_buying_price_one"/>
        <result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
        <result property="nxDgBuyingPriceTwo" column="nx_dg_buying_price_two"/>
        <result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
        <result property="nxDgBuyingPriceThree" column="nx_dg_buying_price_three"/>
        <result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <collection property="neetNotPurOrders" resultMap="needNotBuyOrders"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="depsOrders"/>
    </resultMap>
    <resultMap id="disGoodsWithOrdersForStock" type="NxDistributerGoodsEntity">
       <id property="nxDistributerGoodsId" column="nx_distributer_goods_id"/>
        <result property="nxDgWillPriceOneWeight" column="nx_dg_will_price_one_weight"/>
        <result property="nxDgWillPriceTwoWeight" column="nx_dg_will_price_two_weight"/>
        <result property="nxDgWillPriceThreeWeight" column="nx_dg_will_price_three_weight"/>
		<result property="nxDgGoodsStatus" column="nx_dg_goods_status"/>
		<result property="nxDgWillPriceOne" column="nx_dg_will_price_one"/>
        <result property="nxDgWillPriceTwo" column="nx_dg_will_price_two"/>
		<result property="nxDgWillPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceThree" column="nx_dg_will_price_three"/>
		<result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
		<result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
		<result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgGoodsSonsSort" column="nx_dg_goods_sons_sort"/>
		<result property="nxDgPurchaseAuto" column="nx_dg_purchase_auto"/>
        <result property="nxDgWillPrice" column="nx_dg_will_price"/>
        <result property="nxDgPriceFirstDay" column="nx_dg_price_first_day"/>
        <result property="nxDgPriceSecondDay" column="nx_dg_price_second_day"/>
        <result property="nxDgPriceThirdDay" column="nx_dg_price_third_day"/>
        <result property="nxDgDfgGoodsGrandId" column="nx_dg_dfg_goods_grand_id"/>
        <result property="nxDgDfgGoodsFatherId" column="nx_dg_dfg_goods_father_id"/>
        <result property="nxDgGoodsFile" column="nx_dg_goods_file"/>
        <result property="nxDgGoodsFileLarge" column="nx_dg_goods_file_large"/>
        <result property="nxDgGoodsName" column="nx_dg_goods_name"/>
        <result property="nxDgGoodsStandardname" column="nx_dg_goods_standardname"/>
        <result property="nxDgNxGoodsFatherColor" column="nx_dg_nx_goods_father_color"/>
        <result property="nxDgGoodsStandardWeight" column="nx_dg_goods_standard_weight"/>
        <result property="nxDgGoodsBrand" column="nx_dg_goods_brand"/>
        <result property="nxDgGoodsPlace" column="nx_dg_goods_place"/>
        <result property="nxDgGoodsDetail" column="nx_dg_goods_detail"/>
        <result property="nxDgGoodsPinyin" column="nx_dg_goods_pinyin"/>
        <result property="nxDgBuyingPrice" column="nx_dg_buying_price"/>
        <result property="nxDgPriceProfitOne" column="nx_dg_price_profit_one"/>
        <result property="nxDgPriceProfitTwo" column="nx_dg_price_profit_two"/>
        <result property="nxDgPriceProfitThree" column="nx_dg_price_profit_three"/>
        <result property="nxDgSupplierId" column="nx_dg_supplier_id"/>
       <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <result property="nxDgBuyingPriceIsGrade" column="nx_dg_buying_price_is_grade"/>
        <result property="nxDgBuyingPriceOne" column="nx_dg_buying_price_one"/>
        <result property="nxDgBuyingPriceOneUpdate" column="nx_dg_buying_price_one_update"/>
        <result property="nxDgBuyingPriceTwo" column="nx_dg_buying_price_two"/>
        <result property="nxDgBuyingPriceTwoUpdate" column="nx_dg_buying_price_two_update"/>
        <result property="nxDgBuyingPriceThree" column="nx_dg_buying_price_three"/>
        <result property="nxDgBuyingPriceThreeUpdate" column="nx_dg_buying_price_three_update"/>
        <result property="nxDgBuyingPriceUpdate" column="nx_dg_buying_price_update"/>
        <collection property="neetNotPurOrders" resultMap="needNotBuyOrders"/>
        <collection property="nxDepartmentOrdersEntities" resultMap="depsOrders"/>
    </resultMap>
    <resultMap id="disFatherGoodsForStock" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="nx_distributer_father_goods_id"/>
        <result property="nxDfgFatherGoodsName" column="nx_DFG_father_goods_name"/>
        <result property="nxDfgFathersFatherId" column="nx_dfg_fathers_father_id"/>
        <collection property="nxDistributerGoodsEntities" resultMap="disGoodsWithNeedNotOrders"/>
    </resultMap>
    <resultMap id="disFatherGoods" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="nx_distributer_father_goods_id"/>
        <result property="nxDfgFatherGoodsName" column="nx_DFG_father_goods_name"/>
        <result property="nxDfgFathersFatherId" column="nx_dfg_fathers_father_id"/>
        <collection property="nxDistributerGoodsEntities" resultMap="disGoodsWithNeedNotOrders"/>
    </resultMap>

<!--    <select id="disGetOutStockGoodsApply" resultMap="disFatherGoods">-->
<!--        select * ,-->

<!--        dor.nx_department_orders_id,-->
<!--        dor.nx_DO_nx_goods_id,-->
<!--        dor.nx_DO_order_user_id,-->
<!--        dor.nx_DO_apply_date,-->
<!--        dor.nx_DO_apply_only_time,-->
<!--        dor.nx_DO_quantity,-->
<!--        dor.nx_DO_standard,-->
<!--        dor.nx_DO_remark,-->
<!--        dor.nx_DO_status,-->
<!--        dor.nx_DO_purchase_status,-->
<!--        dor.nx_DO_weight,-->
<!--        dor.nx_DO_price,-->
<!--        dor.nx_DO_subtotal,-->
<!--        dor.nx_DO_apply_full_time,-->
<!--        dor.nx_DO_arrive_only_date,-->
<!--        dor.nx_DO_nx_goods_father_id,-->
<!--        dor.nx_DO_dis_goods_id,-->
<!--        dor.nx_DO_dep_dis_goods_price,-->
<!--        dor.nx_DO_department_id,-->
<!--        dor.nx_DO_distributer_id,-->
<!--        dor.nx_DO_is_agent,-->
<!--        dor.nx_DO_purchase_goods_id,-->
<!--        dor.nx_DO_dep_dis_goods_id,-->
<!--        dor.nx_DO_gb_department_id,-->
<!--        dor.nx_DO_gb_department_father_id,-->
<!--        dor.nx_DO_nx_comm_restraunt_id,-->
<!--        dor.nx_DO_nx_comm_restraunt_id,-->
<!--        dor.nx_DO_nx_community_id,-->
<!--        dor.nx_DO_nx_restraunt_order_id,-->
<!--        dor.nx_DO_cost_price,-->
<!--        dor.nx_DO_cost_price_update,-->
<!--        dor.nx_DO_cost_price_level,-->
<!--        dor.nx_DO_purchase_status,-->
<!--        dor.nx_DO_purchase_goods_id,-->
<!--        dor.nx_DO_dis_goods_grand_id,-->
<!--        dor.nx_DO_dis_goods_father_id,-->


<!--        needNotDor.nx_department_orders_id 'needNotDor_nx_department_orders_id',-->
<!--        needNotDor.nx_DO_remark 'needNotDor_nx_DO_remark',-->
<!--        needNotDor.nx_DO_status 'needNotDor_nx_DO_status',-->
<!--        needNotDor.nx_department_orders_id 'needNotDor_nx_department_id',-->
<!--        needNotDor.nx_DO_purchase_goods_id 'needNotDor_nx_Do_purchase_goods_id',-->
<!--        needNotDor.nx_DO_department_id 'needNotDor_nx_DO_department_id',-->
<!--        needNotDor.nx_DO_department_father_id 'needNotDor_nx_DO_department_father_id',-->
<!--        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_father_id',-->
<!--        needNotDor.nx_DO_quantity 'needNotDor_nx_DO_quantity',-->
<!--        needNotDor.nx_DO_standard 'needNotDor_nx_DO_standard',-->
<!--        needNotDor.nx_DO_weight 'needNotDor_nx_DO_weight',-->
<!--        needNotDor.nx_DO_price 'needNotDor_nx_DO_price',-->
<!--        needNotDor.nx_DO_subtotal 'needNotDor_nx_DO_subtotal',-->
<!--        needNotDor.nx_DO_dis_goods_id 'needNotDor_nx_DO_dis_goods_id',-->
<!--        needNotDor.nx_DO_purchase_status 'needNotDor_nx_DO_purchase_status',-->
<!--        needNotDor.nx_DO_cost_price 'needNotDor_nx_DO_cost_price',-->
<!--        needNotDor.nx_DO_cost_price_level 'needNotDor_nx_DO_cost_price_level',-->
<!--        needNotDor.nx_DO_cost_price_update 'needNotDor_nx_DO_cost_price_update',-->

<!--        needNotDor.nx_DO_dep_dis_goods_price 'needNotDor_nx_DO_dep_dis_goods_price',-->
<!--        needNotDor.nx_DO_distributer_id 'needNotDor_nx_DO_distributer_id',-->

<!--        needNotDor.nx_DO_gb_department_order_id 'needNotDor_nx_DO_gb_department_order_id',-->
<!--        needNotDor.nx_DO_gb_department_id 'needNotDor_nx_DO_gb_department_id',-->
<!--        needNotDor.nx_DO_gb_department_father_id 'needNotDor_nx_DO_gb_department_father_id',-->
<!--        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_id',-->
<!--        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_id',-->
<!--        needNotDor.nx_DO_nx_community_id 'needNotDor_nx_DO_nx_community_id',-->
<!--        needNotDor.nx_DO_nx_restraunt_order_id 'needNotDor_nx_DO_nx_restraunt_order_id',-->
<!--        needNotDor.nx_DO_dis_goods_grand_id 'needNotDor_nx_DO_dis_goods_grand_id',-->


<!--        nds.nx_department_id 'nds_nx_department_id',-->
<!--        nds.nx_department_name 'nds_nx_department_name',-->
<!--        nds.nx_department_attr_name 'nds_nx_department_attr_name',-->
<!--        nds.nx_department_type 'nds_nx_department_type',-->
<!--        nds.nx_department_father_id 'nds_nx_department_father_id',-->
<!--        nds.nx_department_is_group_dep 'nds_nx_department_is_group_dep',-->
<!--        ndf.nx_department_id 'ndf_dd_nx_department_id',-->
<!--        ndf.nx_department_name 'ndf_dd_nx_department_name',-->
<!--        ndf.nx_department_attr_name 'ndf_dd_nx_department_attr_name',-->

<!--        ngds.gb_department_id 'nds_gb_department_id',-->
<!--        ngds.gb_department_name 'nds_gb_department_name',-->
<!--        ngds.gb_department_attr_name 'nds_gb_department_attr_name',-->
<!--        ngds.gb_department_type 'nds_gb_department_type',-->
<!--        ngds.gb_department_father_id 'nds_gb_department_father_id',-->
<!--        ngds.gb_department_is_group_dep 'nds_gb_department_is_group_dep',-->
<!--        ngdf.gb_department_id 'ndf_dd_gb_department_id',-->
<!--        ngdf.gb_department_name 'ndf_dd_gb_department_name',-->
<!--        ngdf.gb_department_attr_name 'ndf_dd_gb_department_attr_name',-->


<!--        ndnr.nx_restraunt_id 'ndnr_nx_restraunt_id',-->
<!--        ndnr.nx_restraunt_attr_name 'ndnr_nx_restraunt_attr_name',-->

<!--        purDor.nx_department_orders_id 'purDor_nx_department_orders_id',-->
<!--        purDor.nx_DO_purchase_goods_id 'purDor_nx_DO_purchase_goods_id',-->
<!--        purDor.nx_DO_dis_goods_id 'purDor_nx_DO_dis_goods_id',-->
<!--        purDor.nx_DO_dis_goods_father_id 'purDor_nx_DO_dis_goods_father_id',-->
<!--        purDor.nx_DO_dis_goods_grand_id 'purDor_nx_DO_dis_goods_grand_id',-->
<!--        purDor.nx_DO_department_id 'purDor_nx_DO_department_id',-->
<!--        purDor.nx_DO_department_father_id 'purDor_nx_DO_department_father_id',-->
<!--        purDor.nx_DO_quantity 'purDor_nx_DO_quantity',-->
<!--        purDor.nx_DO_standard 'purDor_nx_DO_standard',-->
<!--        purDor.nx_DO_status 'purDor_nx_DO_status',-->
<!--        purDor.nx_DO_weight 'purDor_nx_DO_weight',-->
<!--        purDor.nx_DO_price 'purDor_nx_DO_price',-->
<!--        purDor.nx_DO_subtotal 'purDor_nx_DO_subtotal',-->
<!--        purDor.nx_DO_cost_price 'purDor_nx_DO_cost_price',-->
<!--        purDor.nx_DO_cost_subtotal 'purDor_nx_DO_cost_subtotal',-->

<!--        purDor.nx_DO_gb_department_order_id 'purDor_nx_DO_gb_department_order_id',-->
<!--        purDor.nx_DO_gb_department_id 'purDor_nx_DO_gb_department_id',-->
<!--        purDor.nx_DO_gb_department_father_id 'purDor_nx_DO_gb_department_father_id',-->
<!--        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',-->
<!--        purDor.nx_DO_nx_comm_restraunt_id 'purDor_nx_DO_nx_comm_restraunt_id',-->
<!--        purDor.nx_DO_nx_community_id 'purDor_nx_DO_nx_community_id',-->
<!--        purDor.nx_DO_nx_restraunt_order_id 'purDor_nx_DO_nx_restraunt_order_id',-->
<!--        purDs.nx_department_id 'purDs_nx_department_id',-->
<!--        purDs.nx_department_father_id 'purDs_nx_department_father_id',-->
<!--        purDs.nx_department_name 'purDs_nx_department_name',-->
<!--        purDs.nx_department_attr_name 'purDs_nx_department_attr_name',-->
<!--        purDf.nx_department_id 'purDf_nx_department_id',-->
<!--        purDf.nx_department_name 'purDf_nx_department_name',-->
<!--        purDf.nx_department_attr_name 'purDf_nx_department_attr_name',-->
<!--        purGbDs.gb_department_id 'purGbDs_gb_department_id',-->
<!--        purGbDs.gb_department_name 'purGbDs_gb_department_name',-->
<!--        purGbDf.gb_department_id 'purGbDf_gb_department_id',-->
<!--        purGbDf.gb_department_name 'purGbDf_gb_department_name',-->
<!--        purGbDf.gb_department_attr_name 'purGbDf_gb_department_attr_name',-->
<!--        purNr.nx_restraunt_id 'purNr_nx_restraunt_id',-->
<!--        purNr.nx_restraunt_name 'purNr_nx_restraunt_name',-->
<!--        purNr.nx_restraunt_attr_name 'purNr_nx_restraunt_attr_name'-->
<!--        from nx_department_orders as dor-->
<!--        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id-->
<!--        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =-->
<!--        dg.nx_dg_dfg_goods_grand_id-->
<!--        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =-->
<!--        ndfg.nx_dfg_fathers_father_id-->

<!--        left join nx_department_orders as needNotDor on needNotDor.nx_DO_dis_goods_id = dg.nx_distributer_goods_id-->
<!--        and needNotDor.nx_DO_status = 0 and needNotDor.nx_DO_purchase_goods_id = -1-->
<!--        left join nx_department as nds on nds.nx_department_id = needNotDor.nx_DO_department_id-->
<!--        left join nx_department as ndf on ndf.nx_department_id = nds.nx_department_father_id-->
<!--        left join gb_department as ngds on ngds.gb_department_id = needNotDor.nx_DO_gb_department_id-->
<!--        left join gb_department as ngdf on ngdf.gb_department_id = needNotDor.nx_DO_gb_department_father_id-->
<!--        left join nx_restraunt as ndnr on ndnr.nx_restraunt_id = needNotDor.nx_DO_nx_comm_restraunt_id-->

<!--        left join nx_department_orders as purDor on purDor.nx_DO_dis_goods_id = dg.nx_distributer_goods_id-->
<!--        and purDor.nx_DO_status &gt; 0 and purDor.nx_DO_status &lt; 3 and purDor.nx_DO_purchase_status &lt; 5-->
<!--        and purDor.nx_DO_purchase_goods_id = -1-->
<!--        left join nx_department as purDs on purDs.nx_department_id = purDor.nx_DO_department_id-->
<!--        left join nx_department as purDf on purDf.nx_department_id = purDor.nx_DO_department_father_id-->
<!--        left join gb_department as purGbDs on purGbDs.gb_department_id = purDor.nx_DO_gb_department_id-->
<!--        left join gb_department as purGbDf on purGbDf.gb_department_id = purDor.nx_DO_gb_department_father_id-->
<!--        left join nx_restraunt as purNr on purNr.nx_restraunt_id = purDor.nx_DO_nx_comm_restraunt_id-->


<!--        <where>-->
<!--            <if test="disId != null">-->
<!--                and dor.nx_DO_distributer_id = #{disId}-->
<!--            </if>-->

<!--            <if test="status != null">-->
<!--                and dor.nx_DO_status &lt; #{status}-->
<!--            </if>-->
<!--            <if test="grandId != null">-->
<!--                and dor.nx_DO_dis_goods_grand_id = #{grandId}-->
<!--            </if>-->
<!--            <if test="fathersFatherId != null">-->
<!--                and ndfg.nx_dfg_fathers_father_id = #{fathersFatherId}-->
<!--            </if>-->
<!--            <if test="purStatus != null">-->
<!--                and dor.nx_DO_purchase_status &lt; #{purStatus}-->
<!--            </if>-->
<!--            <if test="equalStatus != null">-->
<!--                and dor.nx_DO_status = #{equalStatus}-->
<!--            </if>-->
<!--            <if test="equalPurStatus != null">-->
<!--                and dor.nx_DO_purchase_status = #{equalPurStatus}-->
<!--            </if>-->

<!--            <if test="arriveDate != null">-->
<!--                and dor.nx_DO_arrive_date = #{arriveDate}-->
<!--            </if>-->
<!--            <if test="purType != null and purType == -1">-->
<!--                and dor.nx_DO_purchase_goods_id is null-->
<!--            </if>-->
<!--            <if test="purType != null and purType == 0">-->
<!--                and dor.nx_DO_purchase_goods_id = -1-->
<!--            </if>-->
<!--            <if test="purType != null and purType == 1">-->
<!--                and dor.nx_DO_purchase_goods_id != -1-->
<!--            </if>-->
<!--            <if test="weightId != null and weightId == 1">-->
<!--                and dor.nx_DO_weight_id is not null-->
<!--            </if>-->
<!--            <if test="weightId != null and weightId == 0">-->
<!--                and dor.nx_DO_weight_id is null-->
<!--            </if>-->
<!--            <if test="nxDepIds != null">-->
<!--                and dor.nx_DO_department_id in-->
<!--                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--                and needNotDor.nx_DO_department_id in-->
<!--                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--            </if>-->
<!--            <if test="gbDepIds != null">-->
<!--                and dor.nx_DO_gb_department_id in-->
<!--                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--                and needNotDor.nx_DO_gb_department_id in-->
<!--                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">-->
<!--                    #{id}-->
<!--                </foreach>-->
<!--            </if>-->
<!--        </where>-->
<!--        order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort,-->
<!--        nds.nx_department_id,-->
<!--        ngds.gb_department_id,ndnr.nx_restraunt_id,purDs.nx_department_id,purGbDs.gb_department_id,purNr.nx_restraunt_id-->
<!--    </select>-->
    <select id="queryObjectNew" resultType="com.nongxinle.entity.NxDepartmentOrdersEntity">
        select *
        from nx_department_orders
        where nx_department_orders_id = #{nxDepartmentOrdersId}
    </select>
    <resultMap id="grandDisGoods" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="grand_nx_distributer_father_goods_id"/>
        <result property="nxDfgFathersFatherId" column="grand_nx_dfg_fathers_father_id"/>
        <result property="nxDfgFatherGoodsName" column="grand_nx_dfg_father_goods_name"/>
        <result property="nxDfgFatherGoodsImg" column="grand_nx_dfg_father_goods_img"/>
        <result property="nxDfgNxGoodsId" column="grand_nx_dfg_nx_goods_id"/>
        <result property="nxDfgFatherGoodsSort" column="grand_nx_dfg_father_goods_sort"/>
        <collection property="nxDistributerPurchaseGoodsEntities" resultMap="purGoodsOrdersWithOutExr"/>
        <!--        <collection property="nxDistributerGoodsEntities" resultMap="disGoodsWithApplys"/>-->
    </resultMap>
    <resultMap id="grandGoods" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="nx_distributer_father_goods_id"/>
        <result property="nxDfgFathersFatherId" column="nx_dfg_fathers_father_id"/>
        <result property="nxDfgFatherGoodsName" column="nx_dfg_father_goods_name"/>
        <result property="nxDfgFatherGoodsImg" column="nx_dfg_father_goods_img"/>
        <result property="nxDfgNxGoodsId" column="nx_dfg_nx_goods_id"/>
        <result property="nxDfgFatherGoodsSort" column="nx_dfg_father_goods_sort"/>
        <collection property="nxDistributerGoodsEntities" resultMap="disGoodsWithApplys"/>
    </resultMap>

    <resultMap id="disGoodsCata" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="greatGrand_nx_distributer_father_goods_id"/>
        <result property="nxDfgFathersFatherId" column="greatGrand_nx_dfg_fathers_father_id"/>
        <result property="nxDfgFatherGoodsName" column="greatGrand_nx_dfg_father_goods_name"/>
        <result property="nxDfgFatherGoodsColor" column="greatGrand_nx_dfg_father_goods_color"/>
        <result property="nxDfgNxGoodsId" column="greatGrand_nx_dfg_nx_goods_id"/>
        <result property="nxDfgFatherGoodsImg" column="greatGrand_nx_dfg_father_goods_img"/>
        <collection property="fatherGoodsEntities" resultMap="grandDisGoods"/>
    </resultMap>

    <select id="queryGreatGrandOrderFatherGoods" resultMap="disGoodsCata">
        select * ,
        grand.nx_distributer_father_goods_id 'grand_nx_distributer_father_goods_id',
        grand.nx_dfg_fathers_father_id 'grand_nx_dfg_fathers_father_id',
        grand.nx_dfg_father_goods_name 'grand_nx_dfg_father_goods_name',
        grand.nx_dfg_nx_goods_id 'grand_nx_dfg_nx_goods_id',
        grand.nx_dfg_father_goods_img 'grand_nx_dfg_father_goods_img',
        grand.nx_dfg_father_goods_sort 'grand_nx_dfg_father_goods_sort',
        greatGrand.nx_distributer_father_goods_id 'greatGrand_nx_distributer_father_goods_id',
        greatGrand.nx_dfg_fathers_father_id 'greatGrand_nx_dfg_fathers_father_id',
        greatGrand.nx_dfg_father_goods_name 'greatGrand_nx_dfg_father_goods_name',
        greatGrand.nx_dfg_nx_goods_id 'greatGrand_nx_dfg_nx_goods_id',
        greatGrand.nx_dfg_father_goods_color 'greatGrand_nx_dfg_father_goods_color',
        greatGrand.nx_dfg_father_goods_img 'greatGrand_nx_dfg_father_goods_img',
        greatGrand.nx_dfg_father_goods_sort 'greatGrand_nx_dfg_father_goods_sort'
        from nx_department_orders as dor
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as grand on dor.nx_DO_dis_goods_grand_id =
        grand.nx_distributer_father_goods_id
        left join nx_distributer_father_goods as greatGrand on greatGrand.nx_distributer_father_goods_id =
        grand.nx_dfg_fathers_father_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and dor.nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>

            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="nxDepIds != null">
                and dor.nx_DO_department_father_id in
                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="gbDepIds != null">
                and dor.nx_DO_gb_department_id in
                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
        order by greatGrand.nx_dfg_father_goods_sort , grand.nx_dfg_father_goods_sort

    </select>

    <select id="queryDisGoodsForTodayOrders" resultMap="grandDisGoods">
        select *,
        ndfg.nx_distributer_father_goods_id 'grand_nx_distributer_father_goods_id',
        ndfg.nx_dfg_fathers_father_id 'grand_nx_dfg_fathers_father_id',
        ndfg.nx_dfg_father_goods_name 'grand_nx_dfg_father_goods_name',
        ndfg.nx_dfg_nx_goods_id 'grand_nx_dfg_nx_goods_id',
        ndfg.nx_dfg_father_goods_img 'grand_nx_dfg_father_goods_img',
        ndfg.nx_dfg_father_goods_sort 'grand_nx_dfg_father_goods_sort'
        from nx_department_orders as dor
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dor.nx_DO_dis_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id

        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_DPG_dis_goods_grand_id =
        ndfg.nx_distributer_father_goods_id
        and dor.nx_DO_purchase_goods_id = ndpg.nx_distributer_purchase_goods_id
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = ndpg.nx_DPG_dis_goods_id

        left join nx_department as ds on ds.nx_department_id = dor.nx_DO_department_id
        left join nx_department as df on df.nx_department_id = ds.nx_department_father_id
        left join gb_department as gds on gds.gb_department_id = dor.nx_DO_gb_department_id
        left join gb_department as gdf on gdf.gb_department_id = dor.nx_DO_gb_department_father_id
        left join nx_restraunt as nr on nr.nx_restraunt_id = dor.nx_DO_nx_comm_restraunt_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>
            <if test="fathersFatherId != null">
                and ndfg.nx_dfg_fathers_father_id = #{fathersFatherId}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="nxDepIds != null">
                and dor.nx_DO_department_father_id in
                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="gbDepIds != null">
                and dor.nx_DO_gb_department_id in
                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
        order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort,
        ndg.nx_dg_goods_sort,ndpg.nx_DPG_orders_amount DESC, ndg.nx_distributer_goods_id
    </select>


    <resultMap id="fatherDep" type="NxDepartmentEntity">
        <id property="nxDepartmentId" column="nx_department_id"/>
        <result property="nxDepartmentPromotionGoodsId" column="nx_department_promotion_goods_id"/>
        <result property="nxDepartmentName" column="nx_department_name"/>
        <result property="nxDepartmentAttrName" column="nx_department_attr_name"/>
        <result property="nxDepartmentType" column="nx_department_type"/>
        <result property="nxDepartmentPrintName" column="nx_department_print_name"/>
        <result property="nxDepartmentSettleType" column="nx_department_settle_type"/>
        <result property="nxDepartmentSubAmount" column="nx_department_sub_amount"/>
        <result property="nxDepartmentIsGroupDep" column="nx_department_is_group_dep"/>
        <collection property="nxDepartmentEntities" resultMap="subDepartmentWithOrders"/>
    </resultMap>


    <select id="queryPureOrderNxDepartment" resultMap="fatherDep">
        select * ,
        ds.nx_department_id 'ds_nx_department_id',
        ds.nx_department_name 'ds_nx_department_name',
        ds.nx_department_type 'ds_nx_department_type',
        ds.nx_department_father_id 'ds_nx_department_father_id',
        ds.nx_department_is_group_dep 'ds_nx_department_is_group_dep',
        ds.nx_department_settle_type 'ds_nx_department_settle_type',
        ds.nx_department_attr_name 'ds_nx_department_attr_name'
        from nx_department_orders as dor
        left join nx_department as df on df.nx_department_id = dor.nx_DO_department_father_id
        left join nx_department as ds on ds.nx_department_father_id = df.nx_department_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>

            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            and nx_DO_gb_department_id = -1 and dor.nx_DO_nx_comm_restraunt_id = -1
        </where>
        order by df.nx_department_id
    </select>
    <select id="queryPureOrderGbDepartment" resultMap="gbDepartmentWithOrder">
        select *
        from nx_department_orders as dor
        left join gb_department as gds on gds.gb_department_id = dor.nx_DO_gb_department_id
        left join gb_department as gdf on gdf.gb_department_id = dor.nx_DO_gb_department_father_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>

            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            and dor.nx_DO_department_id = -1
        </where>
    </select>
    <select id="queryDisGoodsOrderWeightTotal" resultType="java.lang.Double">
        select SUM(nx_DO_weight) from nx_department_orders as dor
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id= #{disGoodsId}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>

            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="dayuStatus != null">
                and dor.nx_DO_status &gt; #{dayuStatus}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>

            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>

        </where>
    </select>

    <select id="disGetOutStockGoodsApplyForStock" resultMap="disFatherGoodsForStock">
        select *,
        needNotDor.nx_department_orders_id 'needNotDor_nx_department_orders_id',
        needNotDor.nx_DO_remark 'needNotDor_nx_DO_remark',
        needNotDor.nx_DO_status 'needNotDor_nx_DO_status',
        needNotDor.nx_department_orders_id 'needNotDor_nx_department_id',
        needNotDor.nx_DO_purchase_goods_id 'needNotDor_nx_Do_purchase_goods_id',
        needNotDor.nx_DO_department_id 'needNotDor_nx_DO_department_id',
        needNotDor.nx_DO_department_father_id 'needNotDor_nx_DO_department_father_id',
        needNotDor.nx_DO_nx_comm_restraunt_id 'needNotDor_nx_DO_nx_comm_restraunt_father_id',
        needNotDor.nx_DO_quantity 'needNotDor_nx_DO_quantity',
        needNotDor.nx_DO_standard 'needNotDor_nx_DO_standard',
        needNotDor.nx_DO_weight 'needNotDor_nx_DO_weight',
        needNotDor.nx_DO_price 'needNotDor_nx_DO_price',
        needNotDor.nx_DO_subtotal 'needNotDor_nx_DO_subtotal',
        needNotDor.nx_DO_dis_goods_id 'needNotDor_nx_DO_dis_goods_id',
        needNotDor.nx_DO_purchase_status 'needNotDor_nx_DO_purchase_status',
        needNotDor.nx_DO_cost_price 'needNotDor_nx_DO_cost_price',
        needNotDor.nx_DO_cost_price_level 'needNotDor_nx_DO_cost_price_level',
        needNotDor.nx_DO_cost_price_update 'needNotDor_nx_DO_cost_price_update',

        needNotDor.nx_DO_dep_dis_goods_price 'needNotDor_nx_DO_dep_dis_goods_price',
        needNotDor.nx_DO_distributer_id 'needNotDor_nx_DO_distributer_id',

        nds.nx_department_id 'nds_nx_department_id',
        nds.nx_department_name 'nds_nx_department_name',
        nds.nx_department_attr_name 'nds_nx_department_attr_name',
        nds.nx_department_type 'nds_nx_department_type',
        nds.nx_department_father_id 'nds_nx_department_father_id',
        nds.nx_department_is_group_dep 'nds_nx_department_is_group_dep',
        ndf.nx_department_id 'ndf_dd_nx_department_id',
        ndf.nx_department_name 'ndf_dd_nx_department_name',
        ndf.nx_department_attr_name 'ndf_dd_nx_department_attr_name',

        ngds.gb_department_id 'nds_gb_department_id',
        ngds.gb_department_name 'nds_gb_department_name',
        ngds.gb_department_attr_name 'nds_gb_department_attr_name',
        ngds.gb_department_type 'nds_gb_department_type',
        ngds.gb_department_father_id 'nds_gb_department_father_id',
        ngds.gb_department_is_group_dep 'nds_gb_department_is_group_dep',
        ngdf.gb_department_id 'ndf_dd_gb_department_id',
        ngdf.gb_department_name 'ndf_dd_gb_department_name',
        ngdf.gb_department_attr_name 'ndf_dd_gb_department_attr_name',


        ndnr.nx_restraunt_id 'ndnr_nx_restraunt_id',
        ndnr.nx_restraunt_attr_name 'ndnr_nx_restraunt_attr_name'

        from nx_department_orders as needNotDor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = needNotDor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id

        left join nx_department as nds on nds.nx_department_id = needNotDor.nx_DO_department_id
        left join nx_department as ndf on ndf.nx_department_id = nds.nx_department_father_id
        left join gb_department as ngds on ngds.gb_department_id = needNotDor.nx_DO_gb_department_id
        left join gb_department as ngdf on ngdf.gb_department_id = needNotDor.nx_DO_gb_department_father_id
        left join nx_restraunt as ndnr on ndnr.nx_restraunt_id = needNotDor.nx_DO_nx_comm_restraunt_id

        <where>
            <if test="disId != null">
                and needNotDor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and needNotDor.nx_DO_goods_type = #{goodsType}
            </if>

            <if test="status != null">
                and needNotDor.nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and needNotDor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>
            <if test="fathersFatherId != null">
                and ndfg.nx_dfg_fathers_father_id = #{fathersFatherId}
            </if>
            <if test="purStatus != null">
                and needNotDor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="equalStatus != null">
                and needNotDor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and needNotDor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and needNotDor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and needNotDor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and needNotDor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and needNotDor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and needNotDor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and needNotDor.nx_DO_weight_id is null
            </if>
            <if test="nxDepIds != null">
                and needNotDor.nx_DO_department_father_id in
                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>

            </if>
            <if test="gbDepIds != null">
                and needNotDor.nx_DO_gb_department_id in
                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>

            </if>
        </where>
        order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort, dg.nx_dg_goods_sort,
        nds.nx_department_id,
        ngds.gb_department_id,ndnr.nx_restraunt_id
    </select>

    <select id="queryPrintDepOrder" resultMap="applys">
        select *
        from nx_department_orders as dor
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dor.nx_DO_dis_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id
        left join nx_distributer_user as ndu on ndu.nx_distributer_user_id = dor.nx_DO_is_agent

        <where>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="depId != null">
                and nx_DO_department_id = #{depId}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            order by dor.nx_DO_today_order

            <if test="offset != null and limit != null">
                limit #{offset}, #{limit}
            </if>

        </where>

    </select>
    <select id="queryGrandGoodsOrder" resultMap="grandGoods">
        select *,
        ndf.nx_department_id 'dd_nx_department_id',
        ndf.nx_department_name 'dd_nx_department_name',
        ndf.nx_department_attr_name 'dd_nx_department_attr_name'
        from nx_department_orders as dor
        left join nx_department as nds on nds.nx_department_id = dor.nx_DO_department_id
        left join nx_department as ndf on ndf.nx_department_id = nds.nx_department_father_id
        left join gb_department as ngds on ngds.gb_department_id = dor.nx_DO_gb_department_id
        left join gb_department as ngdf on ngdf.gb_department_id = dor.nx_DO_gb_department_father_id
        left join nx_restraunt as ndnr on ndnr.nx_restraunt_id = dor.nx_DO_nx_comm_restraunt_id
        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as grand on dor.nx_DO_dis_goods_grand_id = grand.nx_distributer_father_goods_id
        left join nx_distributer_father_goods as greatGrand on greatGrand.nx_distributer_father_goods_id =  grand.nx_dfg_fathers_father_id

        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and dor.nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>

            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="nxDepIds != null">
                and dor.nx_DO_department_father_id in
                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

            <if test="gbDepIds != null">
                and dor.nx_DO_gb_department_father_id in
                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
        order by greatGrand.nx_dfg_father_goods_sort, grand.nx_dfg_father_goods_sort

    </select>

    <resultMap id="greatGrandWithApplys" type="NxDistributerFatherGoodsEntity">
        <id property="nxDistributerFatherGoodsId" column="greatGrand_nx_distributer_father_goods_id"/>
        <result property="nxDfgFathersFatherId" column="greatGrand_nx_dfg_fathers_father_id"/>
        <result property="nxDfgFatherGoodsName" column="greatGrand_nx_dfg_father_goods_name"/>
        <result property="nxDfgFatherGoodsColor" column="greatGrand_nx_dfg_father_goods_color"/>
        <result property="nxDfgNxGoodsId" column="greatGrand_nx_dfg_nx_goods_id"/>
        <result property="nxDfgFatherGoodsImg" column="greatGrand_nx_dfg_father_goods_img"/>
        <collection property="nxDistributerGoodsEntities" resultMap="disGoodsWithApplys"/>
    </resultMap>

    <select id="queryDisGetPrintOrderGreatGrandGoods" resultMap="greatGrandWithApplys">
        select * ,
        grand.nx_distributer_father_goods_id 'grand_nx_distributer_father_goods_id',
        grand.nx_dfg_fathers_father_id 'grand_nx_dfg_fathers_father_id',
        grand.nx_dfg_father_goods_name 'grand_nx_dfg_father_goods_name',
        grand.nx_dfg_nx_goods_id 'grand_nx_dfg_nx_goods_id',
        grand.nx_dfg_father_goods_img 'grand_nx_dfg_father_goods_img',
        grand.nx_dfg_father_goods_sort 'grand_nx_dfg_father_goods_sort',
        greatGrand.nx_distributer_father_goods_id 'greatGrand_nx_distributer_father_goods_id',
        greatGrand.nx_dfg_fathers_father_id 'greatGrand_nx_dfg_fathers_father_id',
        greatGrand.nx_dfg_father_goods_name 'greatGrand_nx_dfg_father_goods_name',
        greatGrand.nx_dfg_nx_goods_id 'greatGrand_nx_dfg_nx_goods_id',
        greatGrand.nx_dfg_father_goods_color 'greatGrand_nx_dfg_father_goods_color',
        greatGrand.nx_dfg_father_goods_img 'greatGrand_nx_dfg_father_goods_img',
        greatGrand.nx_dfg_father_goods_sort 'greatGrand_nx_dfg_father_goods_sort'
        from nx_department_orders as dor
        left join nx_department as nds on nds.nx_department_id = dor.nx_DO_department_id
        left join nx_department as ndf on ndf.nx_department_id = nds.nx_department_father_id
        left join gb_department as ngds on ngds.gb_department_id = dor.nx_DO_gb_department_id
        left join gb_department as ngdf on ngdf.gb_department_id = dor.nx_DO_gb_department_father_id
        left join nx_restraunt as ndnr on ndnr.nx_restraunt_id = dor.nx_DO_nx_comm_restraunt_id

        left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as grand on dor.nx_DO_dis_goods_grand_id =
        grand.nx_distributer_father_goods_id
        left join nx_distributer_father_goods as greatGrand on greatGrand.nx_distributer_father_goods_id =
        grand.nx_dfg_fathers_father_id
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and dor.nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and dor.nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="resFatherId != null">
                and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
            </if>
            <if test="gbDepFatherId != null">
                and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>

            <if test="status != null">
                and dor.nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id = #{grandId}
            </if>
            <if test="purStatus != null">
                and dor.nx_DO_purchase_status &lt; #{purStatus}
            </if>
            <if test="dayuPurStatus != null">
                and dor.nx_DO_purchase_status &gt; #{dayuPurStatus}
            </if>
            <if test="equalStatus != null">
                and dor.nx_DO_status = #{equalStatus}
            </if>
            <if test="equalPurStatus != null">
                and dor.nx_DO_purchase_status = #{equalPurStatus}
            </if>

            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="arriveDate != null">
                and dor.nx_DO_arrive_date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and dor.nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and dor.nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and dor.nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and dor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and dor.nx_DO_weight_id is null
            </if>
            <if test="nxDepIds != null">
                and dor.nx_DO_department_father_id in
                <foreach item="id" collection="nxDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="gbDepIds != null">
                and dor.nx_DO_gb_department_id in
                <foreach item="id" collection="gbDepIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
        order by greatGrand.nx_dfg_father_goods_sort , grand.nx_dfg_father_goods_sort

    </select>
    <select id="queryDepWeightOrderGb" resultMap="applysWithGb">

    select *,
           ngds.gb_department_id 'nds_gb_department_id',
           ngds.gb_department_name 'nds_gb_department_name',
           ngds.gb_department_attr_name 'nds_gb_department_attr_name',
           ngds.gb_department_type 'nds_gb_department_type',
           ngds.gb_department_father_id 'nds_gb_department_father_id',
           ngds.gb_department_is_group_dep 'nds_gb_department_is_group_dep',
           ngdf.gb_department_id 'ndf_dd_gb_department_id',
           ngdf.gb_department_name 'ndf_dd_gb_department_name',
           ngdf.gb_department_attr_name 'ndf_dd_gb_department_attr_name'
           from nx_department_orders as dor
    left join gb_department_orders as gdo on gdo.gb_department_orders_id = dor.nx_DO_gb_department_order_id
     left join gb_distributer_purchase_goods as gdpg on gdpg.gb_distributer_purchase_goods_id = gdo.gb_DO_purchase_goods_id

     left join nx_distributer_goods as ndg on ndg.nx_distributer_goods_id = dor.nx_DO_dis_goods_id
     left join gb_department as ngds on ngds.gb_department_id = dor.nx_DO_department_id
     left join gb_department as ngdf on ngdf.gb_department_id = ngds.gb_department_father_id
     <where>
         <if test="goodsType != null">
             and dor.nx_DO_goods_type = #{goodsType}
         </if>
         <if test="gbDepFatherId != null">
             and nx_DO_gb_department_father_id = #{gbDepFatherId}
         </if>
         <if test="gbDepId != null">
             and nx_DO_gb_department_id = #{gbDepId}
         </if>
         <if test="depFatherId != null">
             and nx_DO_department_father_id = #{depFatherId}
         </if>
         <if test="resFatherId != null">
             and dor.nx_DO_nx_comm_restraunt_father_id = #{resFatherId}
         </if>
         <if test="gbDepFatherId != null">
             and dor.nx_DO_gb_department_father_id = #{gbDepFatherId}
         </if>
         <if test="status != null">
             and nx_DO_status &lt; #{status}
         </if>
         <if test="weightId != null and weightId == 1">
             and dor.nx_DO_weight_id is not null
         </if>
         <if test="purType != null and purType == -1">
             and nx_DO_purchase_goods_id is null
         </if>
         <if test="purType != null and purType == 0">
             and nx_DO_purchase_goods_id = -1
         </if>
         <if test="purType != null and purType == 1">
             and nx_DO_purchase_goods_id != -1
         </if>
         <if test="weightId != null and weightId == 0">
             and dor.nx_DO_weight_id is null
         </if>
         <if test="inputType != null">
             and dor.nx_DO_goods_type = #{inputType}
         </if>

         <if test="hasWeight != null and hasWeight == 1">
             and nx_DO_weight is not null
         </if>
         <if test="hasWeight != null and hasWeight == -1">
             and nx_DO_weight is null
         </if>
         <if test="hasPrice != null and hasPrice == 1">
             and nx_DO_price is not null
         </if>
         <if test="hasPrice != null and hasPrice == -1">
             and nx_DO_price is null
         </if>
         <if test="offset != null and limit != null">
             limit #{offset}, #{limit}
         </if>
         <if test="orderBy != null and orderBy == 'time'">
             order by dor.nx_DO_today_order
         </if>
         <if test="orderBy != null and orderBy == 'sort'">
             order by great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort, ndpg.nx_DPG_batch_id,
             ndpg.nx_DPG_nx_weight_id
         </if>
         <if test="orderBy != null and orderBy == 'send'">
             order by  dor.nx_DO_purchase_status, ndpg.nx_DPG_input_type DESC , ndpg.nx_DPG_batch_id,
             ndpg.nx_DPG_nx_weight_id,great.nx_dfg_father_goods_sort,ndfg.nx_dfg_father_goods_sort,
             ndg.nx_dg_goods_sort
         </if>

     </where>

    </select>
    <select id="queryDistributerFatherGoodsTodayDepartments" resultMap="subDepartmentWithFatherGoodsOrders">
        select *,
        great.nx_distributer_father_goods_id 'great_nx_distributer_father_goods_id',
        great.nx_dfg_father_goods_name 'great_nx_dfg_father_goods_name',
        great.nx_dfg_father_goods_sort 'great_nx_dfg_father_goods_sort',
        ds.nx_department_id 'ds_nx_department_id',
        ds.nx_department_name 'ds_nx_department_name',
        ds.nx_department_type 'ds_nx_department_type',
        ds.nx_department_father_id 'ds_nx_department_father_id',
        ds.nx_department_is_group_dep 'ds_nx_department_is_group_dep',
        ds.nx_department_settle_type 'ds_nx_department_settle_type',
        ds.nx_department_attr_name 'ds_nx_department_attr_name',
        ndpg.nx_DPG_distributer_id,
        ndpg.nx_DPG_status,
        ndpg.nx_DPG_quantity,
        ndpg.nx_DPG_orders_amount,
        ndpg.nx_DPG_buy_price,
        ndpg.nx_DPG_batch_id,
        ndpg.nx_DPG_nx_weight_id,
        newDor.nx_department_orders_id 'newDor_nx_department_orders_id',
        newDor.nx_DO_quantity 'newDor_nx_DO_quantity',
        newDor.nx_DO_standard 'newDor_nx_DO_standard',
        newDor.nx_DO_remark 'newDor_nx_DO_remark',
        newDor.nx_DO_status 'newDor_nx_DO_status',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',
        newDor.nx_DO_weight 'newDor_nx_DO_weight',
        newDor.nx_DO_price 'newDor_nx_DO_price',
        newDor.nx_DO_subtotal 'newDor_nx_DO_subtotal',
        newDor.nx_DO_dis_goods_id 'newDor_nx_DO_dis_goods_id',
        newDor.nx_DO_dis_goods_grand_id 'newDor_nx_DO_dis_goods_grand_id',
        newDor.nx_DO_dis_goods_father_id 'newDor_nx_DO_dis_goods_father_id',
        newDor.nx_DO_dep_dis_goods_price 'newDor_nx_DO_dep_dis_goods_price',
        newDor.nx_DO_department_id 'newDor_nx_DO_department_id',
        newDor.nx_DO_distributer_id 'newDor_nx_DO_distributer_id',
        newDor.nx_DO_is_agent 'newDor_nx_DO_is_agent',
        newDor.nx_DO_purchase_goods_id 'newDor_nx_DO_purchase_goods_id',
        newDor.nx_DO_gb_department_order_id 'newDor_nx_DO_gb_department_order_id',
        newDor.nx_DO_gb_department_id 'newDor_nx_DO_gb_department_id',
        newDor.nx_DO_gb_department_father_id 'newDor_nx_DO_gb_department_father_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_comm_restraunt_id 'newDor_nx_DO_nx_comm_restraunt_id',
        newDor.nx_DO_nx_community_id 'newDor_nx_DO_nx_community_id',
        newDor.nx_DO_nx_restraunt_order_id 'newDor_nx_DO_nx_restraunt_order_id',
        newDor.nx_DO_cost_price 'newDor_nx_DO_cost_price',
        newDor.nx_DO_cost_price_update 'newDor_nx_DO_cost_price_update',
        newDor.nx_DO_cost_price_level 'newDor_nx_DO_cost_price_level',
        newDor.nx_DO_purchase_status 'newDor_nx_DO_purchase_status',

        dorDpg.nx_distributer_purchase_goods_id 'dorDpg_nx_distributer_purchase_goods_id',
        dorDpg.nx_DPG_quantity 'dorDpg_nx_DPG_quantity',
        dorDpg.nx_DPG_status 'dorDpg_nx_DPG_status',
        dorDpg.nx_DPG_nx_weight_id 'dorDpg_nx_DPG_weight_id',
        dorDpg.nx_DPG_batch_id 'dorDpg_nx_DPG_batch_id'
        from nx_department_orders as newDor
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = newDor.nx_DO_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id =
        dg.nx_dg_dfg_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id =
        ndfg.nx_dfg_fathers_father_id
        left join nx_department_user as du on du.nx_department_user_id = newDor.nx_DO_order_user_id
        left join nx_department as ds on ds.nx_department_id = newDor.nx_DO_department_id
         left join nx_department as df on df.nx_department_id = ds.nx_department_father_id
        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_DPG_dis_goods_id = dg.nx_distributer_goods_id
        and ndpg.nx_DPG_status &lt; 4
        left join nx_distributer_purchase_goods as dorDpg on dorDpg.nx_distributer_purchase_goods_id =
        newDor.nx_DO_purchase_goods_id
        <where>

            <if test="startDate != null">
                and nx_DO_arrive_date &gt;=  #{startDate}
            </if>

            <if test="stopDate != null">
                and nx_DO_arrive_date &lt;=  #{stopDate}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="goodsType != null">
                and newDor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="arriveDate != null">
                and nx_DO_arrive_Date = #{arriveDate}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>

            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and newDor.nx_DO_purchase_goods_id &gt; 0
            </if>
            <if test="equalPurStatus != null">
                and newDor.nx_DO_purchase_status= #{equalPurStatus}
            </if>
            <if test="weightId != null and weightId == 1">
                and newDor.nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and newDor.nx_DO_weight_id is null
            </if>
            <if test="purGoodsId != null and purGoodsId == 1">
                and nx_DO_purchase_goods_id is not null and nx_DO_purchase_goods_id != -1
            </if>
            <if test="purGoodsId != null and purGoodsId == 0">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purGoodsId != null and purGoodsId == -1">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="hasWeight != null and hasWeight == 1">
                and nx_DO_weight is not null
            </if>
            <if test="hasWeight != null and hasWeight == -1">
                and nx_DO_weight is null
            </if>
            <if test="hasPrice != null and hasPrice == 1">
                and nx_DO_price is not null
            </if>
            <if test="hasPrice != null and hasPrice == -1">
                and nx_DO_price is null
            </if>
            and newDor.nx_DO_gb_department_id = -1
        </where>
        order by ds.nx_department_id , great.nx_dfg_father_goods_sort, ndfg.nx_dfg_father_goods_sort,
        dg.nx_dg_goods_sort,  ndpg.nx_distributer_purchase_goods_id

    </select>
    <select id="queryFatherGoodsByParams" resultMap="disFatherGoods">
        select * from nx_distributer_father_goods as ndfg
        left join nx_department_orders as dor on dor.nx_DO_dis_goods_father_id = ndfg.nx_distributer_father_goods_id
        left join nx_distributer_goods as ndg on ndg.nx_dg_dfg_goods_father_id = ndfg.nx_distributer_father_goods_id
        <where>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>

            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="disId != null">
                and nx_DO_distributer_id = #{disId}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="grandId != null">
                and dor.nx_DO_dis_goods_grand_id =  #{grandId}
            </if>
            <if test="startDate != null">
                and dor.nx_DO_arrive_date &gt;=  #{startDate}
            </if>

            <if test="stopDate != null">
                and dor.nx_DO_arrive_date &lt;=  #{stopDate}
            </if>

        </where>
    </select>
    <select id="queryDepOrdersProfitScale" resultType="java.lang.Double">
        select SUM(nx_DO_profit_scale) from nx_department_orders dor
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="fatherId != null">
                and dor.nx_DO_dis_goods_father_id = #{fatherId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id = #{disGoodsId}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and nx_DO_department_id = #{depId}
            </if>
            <if test="resFatherId != null">
                and nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and nx_DO_status &gt; #{dayuStatus}
            </if>
            <if test="subtotal != null">
                and nx_DO_subtotal &gt; #{subtotal}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and nx_DO_weight_id is null
            </if>
        </where>

    </select>
    <select id="queryCostSubtotal" resultType="java.lang.Double">
        select SUM(nx_DO_cost_subtotal) from nx_department_orders dor
        <where>
            <if test="disId != null">
                and dor.nx_DO_distributer_id = #{disId}
            </if>
            <if test="goodsType != null">
                and dor.nx_DO_goods_type = #{goodsType}
            </if>
            <if test="fatherId != null">
                and dor.nx_DO_dis_goods_father_id = #{fatherId}
            </if>
            <if test="disGoodsId != null">
                and dor.nx_DO_dis_goods_id = #{disGoodsId}
            </if>
            <if test="gbDepFatherId != null">
                and nx_DO_gb_department_father_id = #{gbDepFatherId}
            </if>
            <if test="gbDepId != null">
                and nx_DO_gb_department_id = #{gbDepId}
            </if>
            <if test="depFatherId != null">
                and nx_DO_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and nx_DO_department_id = #{depId}
            </if>
            <if test="resFatherId != null">
                and nx_DO_nx_comm_restraunt_id = #{resFatherId}
            </if>
            <if test="status != null">
                and nx_DO_status &lt; #{status}
            </if>
            <if test="equalStatus != null">
                and nx_DO_status = #{equalStatus}
            </if>
            <if test="dayuStatus != null">
                and nx_DO_status &gt; #{dayuStatus}
            </if>
            <if test="subtotal != null">
                and nx_DO_subtotal &gt; #{subtotal}
            </if>
            <if test="purType != null and purType == -1">
                and nx_DO_purchase_goods_id is null
            </if>
            <if test="purType != null and purType == 0">
                and nx_DO_purchase_goods_id = -1
            </if>
            <if test="purType != null and purType == 1">
                and nx_DO_purchase_goods_id != -1
            </if>
            <if test="weightId != null and weightId == 1">
                and nx_DO_weight_id is not null
            </if>
            <if test="weightId != null and weightId == 0">
                and nx_DO_weight_id is null
            </if>
        </where>
    </select>

    <resultMap id="purchaseGoods" type="NxDistributerPurchaseGoodsEntity">
        <id property="nxDistributerPurchaseGoodsId" column="nx_distributer_purchase_goods_id"/>
        <result property="nxDpgQuantity" column="nx_DPG_quantity"/>
        <result property="nxDpgStandard" column="nx_DPG_standard"/>
        <result property="nxDpgBuyQuantity" column="nx_DPG_buy_quantity"/>
        <result property="nxDpgBuyPrice" column="nx_DPG_buy_price"/>
        <result property="nxDpgBuyQuantity" column="nx_DPG_buy_quantity"/>
        <result property="nxDpgInputType" column="nx_DPG_input_type"/>
        <result property="nxDpgPurchaseType" column="nx_DPG_purchase_type"/>
        <result property="nxDpgBuySubtotal" column="nx_DPG_buy_subtotal"/>
        <result property="nxDpgBatchId" column="nx_DPG_batch_id"/>
        <result property="nxDpgStatus" column="nx_DPG_status"/>
        <result property="nxDpgDistributerId" column="nx_DPG_distributer_id"/>
        <result property="nxDpgBuyUserId" column="nx_DPG_buy_user_id"/>
        <result property="nxDpgPurUserId" column="nx_DPG_pur_user_id"/>
        <result property="nxDpgSellUserId" column="nx_DPG_sell_user_id"/>
        <association property="nxDistributerGoodsEntity" resultMap="disGoods"/>
    </resultMap>


    <resultMap id="jrdhSellUser" type="NxJrdhUserEntity">
        <id property="nxJrdhUserId" column="sell_user_nx_jrdh_user_id"/>
        <result property="nxJrdhWxAvartraUrl" column="sell_user_nx_jrdh_wx_avartra_url"/>
        <result property="nxJrdhWxNickName" column="sell_user_nx_jrdh_wx_nick_name"/>
        <result property="nxJrdhNxDistributerId" column="sell_user_nx_jrdh_nx_distributer_id"/>
        <result property="nxJrdhNxPurchaserUserId" column="sell_user_nx_jrdh_nx_purchaser_user_id"/>
        <result property="nxJrdhNxCommunityId" column="sell_user_nx_jrdh_nx_community_id"/>
        <result property="nxJrdhNxPurchaserUserId" column="sell_user_nx_jrdh_nx_comm_user_id"/>
        <result property="nxJrdhUrlChange" column="sell_user_nx_jrdh_url_change"/>
    </resultMap>

    <resultMap id="jrdhBuyUser" type="NxJrdhUserEntity">
        <id property="nxJrdhUserId" column="nx_jrdh_user_id"/>
        <result property="nxJrdhWxAvartraUrl" column="nx_jrdh_wx_avartra_url"/>
        <result property="nxJrdhWxNickName" column="nx_jrdh_wx_nick_name"/>
        <result property="nxJrdhNxDistributerId" column="nx_jrdh_nx_distributer_id"/>
        <result property="nxJrdhNxPurchaserUserId" column="nx_jrdh_nx_purchaser_user_id"/>
        <result property="nxJrdhNxCommunityId" column="nx_jrdh_nx_community_id"/>
        <result property="nxJrdhNxPurchaserUserId" column="nx_jrdh_nx_comm_user_id"/>
        <result property="nxJrdhUrlChange" column="nx_jrdh_url_change"/>

    </resultMap>



    <resultMap id="jrdhSupplier" type="NxJrdhSupplierEntity">
        <id property="nxJrdhSupplierId" column="nx_jrdh_supplier_id"/>
        <result property="nxJrdhsNxDistributerId" column="nx_jrdhs_nx_distributer_id"/>
        <result property="nxJrdhsGbDistributerId" column="nx_jrdhs_gb_distributer_id"/>
        <result property="nxJrdhsGbDepartmentId" column="nx_jrdhs_gb_department_id"/>
        <result property="nxJrdhsSupplierName" column="nx_jrdhs_supplier_name"/>
        <result property="nxJrdhsUserId" column="nx_jrdhs_user_id"/>
    </resultMap>
    <resultMap id="purchaseBatch" type="NxDistributerPurchaseBatchEntity">
        <id property="nxDistributerPurchaseBatchId" column="nx_distributer_purchase_batch_id"/>
        <result property="nxDpbNeedDate" column="nx_DPB_need_date"/>
        <result property="nxDpbSupplierId" column="nx_DPB_supplier_id"/>
        <result property="nxDpbDistributerId" column="nx_DPB_distributer_id"/>
        <result property="nxDpbPayType" column="nx_DPB_pay_type"/>
        <result property="nxDpbStatus" column="nx_DPB_status"/>
        <result property="nxDpbTime" column="nx_DPB_time"/>
        <result property="nxDpbDate" column="nx_DPB_date"/>
        <result property="nxDpbYear" column="nx_DPB_year"/>
        <result property="nxDpbMonth" column="nx_DPB_month"/>
        <result property="nxDpbStatus" column="nx_DPB_status"/>
        <result property="nxDpbSellSubtotal" column="nx_DPB_sell_subtotal"/>
        <result property="nxDpbPurUserId" column="nx_DPB_pur_user_id"/>
        <result property="nxDpbBuyUserId" column="nx_DPB_buy_user_id"/>
        <result property="nxDpbSellUserId" column="nx_DPB_sell_user_id"/>
        <result property="nxDpbPurchaseType" column="nx_DPB_purchase_type"/>
        <result property="nxDpbPayFullTime" column="nx_DPB_pay_full_time"/>
        <result property="nxDpbOrderIsNotice" column="nx_DPB_order_is_notice"/>
        <association property="nxJrdhPurEntity" resultMap="disUser"/>
        <association property="nxJrdhBuyerEntity" resultMap="jrdhBuyUser"/>
        <association property="nxJrdhSellerEntity" resultMap="jrdhSellUser"/>
        <association property="nxJrdhSupplierEntity" resultMap="jrdhSupplier"/>
        <collection property="nxDPGEntities" resultMap="purchaseGoods"/>
    </resultMap>

    <select id="queryDisPurchaseBatch" resultMap="purchaseBatch">
        select * ,
        sell_user.nx_jrdh_user_id        'sell_user_nx_jrdh_user_id',
        sell_user.nx_jrdh_wx_avartra_url 'sell_user_nx_jrdh_wx_avartra_url',
        sell_user.nx_jrdh_wx_nick_name   'sell_user_nx_jrdh_wx_nick_name',
        sell_user.nx_jrdh_url_change     'sell_user_nx_jrdh_url_change'
        from nx_department_orders as dor
        left join nx_distributer_purchase_goods as ndpg on ndpg.nx_distributer_purchase_goods_id =  dor.nx_DO_purchase_goods_id
        left join nx_distributer_purchase_batch as dpb on dpb.nx_distributer_purchase_batch_id = ndpg.nx_DPG_batch_id
        left join nx_jrdh_supplier as njs on njs.nx_jrdh_supplier_id = dpb.nx_DPB_supplier_id
        left join nx_distributer_purchase_goods as dpg on dpg.nx_DPG_batch_id = dpb.nx_distributer_purchase_batch_id
        left join nx_distributer_goods as dg on dg.nx_distributer_goods_id = dpg.nx_DPG_dis_goods_id
        left join nx_distributer_father_goods as ndfg on ndfg.nx_distributer_father_goods_id = dg.nx_dg_dfg_goods_grand_id
        left join nx_distributer_father_goods as great on great.nx_distributer_father_goods_id = ndfg.nx_dfg_fathers_father_id
        left join nx_department as ds on ds.nx_department_id = dor.nx_DO_department_id
        left join nx_department as df on df.nx_department_id = ds.nx_department_father_id
        left join nx_jrdh_user as buy_user on buy_user.nx_jrdh_user_id = dpb.nx_DPB_buy_user_id
        left join nx_jrdh_user as sell_user on sell_user.nx_jrdh_user_id = dpb.nx_DPB_sell_user_id
        left join nx_distributer_user as ndu on ndu.nx_distributer_user_id = dpb.nx_DPB_pur_user_id
        left join gb_department as purGbDs on purGbDs.gb_department_id = dor.nx_DO_gb_department_id
        left join gb_department as purGbDf on purGbDf.gb_department_id = purGbDs.gb_department_father_id
        left join nx_restraunt as nr on nr.nx_restraunt_id = dor.nx_DO_nx_comm_restraunt_id
        <where>
        <if test="disId != null">
            and dor.nx_DO_distributer_id = #{disId}
        </if>
        <if test="goodsType != null">
            and dor.nx_DO_goods_type = #{goodsType}
        </if>
        <if test="fatherId != null">
            and dor.nx_DO_dis_goods_father_id = #{fatherId}
        </if>
        <if test="disGoodsId != null">
            and dor.nx_DO_dis_goods_id = #{disGoodsId}
        </if>
        <if test="gbDepFatherId != null">
            and nx_DO_gb_department_father_id = #{gbDepFatherId}
        </if>
        <if test="gbDepId != null">
            and nx_DO_gb_department_id = #{gbDepId}
        </if>
        <if test="depFatherId != null">
            and nx_DO_department_father_id = #{depFatherId}
        </if>
        <if test="depId != null">
            and nx_DO_department_id = #{depId}
        </if>
            <if test="equalBuyStatus != null">
                and nx_DO_purchase_status = #{equalBuyStatus}
            </if>
            <if test="buyStatus != null">
                and nx_DO_purchase_status &lt; #{buyStatus}
            </if>
        <if test="status != null">
            and nx_DO_status &lt; #{status}
        </if>
        <if test="equalStatus != null">
            and nx_DO_status = #{equalStatus}
        </if>
        <if test="dayuStatus != null">
            and nx_DO_status &gt; #{dayuStatus}
        </if>
        <if test="subtotal != null">
            and nx_DO_subtotal &gt; #{subtotal}
        </if>
        <if test="purType != null and purType == -1">
            and nx_DO_purchase_goods_id is null
        </if>
        <if test="purType != null and purType == 0">
            and nx_DO_purchase_goods_id = -1
        </if>
        <if test="purType != null and purType == 1">
            and nx_DO_purchase_goods_id != -1
        </if>
        <if test="weightId != null and weightId == 1">
            and nx_DO_weight_id is not null
        </if>
        <if test="weightId != null and weightId == 0">
            and nx_DO_weight_id is null
        </if>
            <if test="xiaoyuBatchStatus != null">
                and  dpb.nx_DPB_status &lt; #{xiaoyuBatchStatus}
            </if>

        </where>
    </select>


    <insert id="save" parameterType="com.nongxinle.entity.NxDepartmentOrdersEntity"
            useGeneratedKeys="true" keyProperty="nxDepartmentOrdersId">
        insert into nx_department_orders
        (`nx_department_orders_id`,
         `nx_DO_nx_goods_id`,
         `nx_DO_nx_goods_father_id`,
         `nx_DO_dis_goods_id`,
         `nx_DO_dis_goods_father_id`,
         `nx_DO_dep_dis_goods_id`,
         `nx_DO_dep_dis_goods_price`,
         `nx_DO_quantity`,
         `nx_DO_standard`,
         `nx_DO_remark`,
         `nx_DO_weight`,
         `nx_DO_price`,
         `nx_DO_subtotal`,
         `nx_DO_department_id`,
         `nx_DO_department_father_id`,
         `nx_DO_distributer_id`,
         `nx_DO_bill_id`,
         `nx_DO_status`,
         `nx_DO_order_user_id`,
         `nx_DO_pick_user_id`,
         `nx_DO_account_user_id`,
         `nx_DO_purchase_user_id`,
         `nx_DO_purchase_goods_id`,
         `nx_DO_purchase_status`,
         `nx_DO_apply_date`,
         `nx_DO_arrive_date`,
         `nx_DO_arrive_only_date`,
         `nx_DO_apply_full_time`,
         `nx_DO_operation_time`,
         `nx_DO_arrive_what_day`,
         `nx_DO_is_agent`,
         `nx_DO_arrive_weeks_year`,
         `nx_DO_apply_only_time`,
         `nx_DO_cost_price`,
         `nx_DO_cost_subtotal`,
         `nx_DO_gb_distributer_id`,
         `nx_DO_gb_department_id`,
         `nx_DO_gb_department_father_id`,
         `nx_DO_return_weight`,
         `nx_DO_return_subtotal`,
         `nx_DO_return_bill_id`,
         `nx_DO_return_status`,
         `nx_DO_weight_id`,
         `nx_DO_profit_subtotal`,
         `nx_DO_profit_scale`,
         `nx_DO_nx_community_id`,
         `nx_DO_nx_comm_restraunt_id`,
         `nx_DO_nx_comm_restraunt_father_id`,
         `nx_DO_gb_department_order_id`,
         `nx_DO_nx_restraunt_order_id`,
         `nx_DO_cost_price_update`,
         `nx_DO_cost_price_level`,
         `nx_DO_dis_goods_grand_id`,
         `nx_DO_goods_type`,
         `nx_DO_print_standard`,
         `nx_DO_today_order`,
         `nx_DO_price_different`,
         `nx_DO_expect_price`,
         `nx_DO_goods_name`
         )
        values (#{nxDepartmentOrdersId},
                #{nxDoNxGoodsId},
                #{nxDoNxGoodsFatherId},
                #{nxDoDisGoodsId},
                #{nxDoDisGoodsFatherId},
                #{nxDoDepDisGoodsId},
                #{nxDoDepDisGoodsPrice},
                #{nxDoQuantity},
                #{nxDoStandard},
                #{nxDoRemark},
                #{nxDoWeight},
                #{nxDoPrice},
                #{nxDoSubtotal},
                #{nxDoDepartmentId},
                #{nxDoDepartmentFatherId},
                #{nxDoDistributerId},
                #{nxDoBillId},
                #{nxDoStatus},
                #{nxDoOrderUserId},
                #{nxDoPickUserId},
                #{nxDoAccountUserId},
                #{nxDoPurchaseUserId},
                #{nxDoPurchaseGoodsId},
                #{nxDoPurchaseStatus},
                #{nxDoApplyDate},
                #{nxDoArriveDate},
                #{nxDoArriveOnlyDate},
                #{nxDoApplyFullTime},
                #{nxDoOperationTime},
                #{nxDoArriveWhatDay},
                #{nxDoIsAgent},
                #{nxDoArriveWeeksYear},
                #{nxDoApplyOnlyTime},
                #{nxDoCostPrice},
                #{nxDoCostSubtotal},
                #{nxDoGbDistributerId},
                #{nxDoGbDepartmentId},
                #{nxDoGbDepartmentFatherId},
                #{nxDoReturnWeight},
                #{nxDoReturnSubtotal},
                #{nxDoReturnBillId},
                #{nxDoReturnStatus},
                #{nxDoWeightId},
                #{nxDoProfitSubtotal},
                #{nxDoProfitScale},
                #{nxDoNxCommunityId},
                #{nxDoNxCommRestrauntId},
                #{nxDoNxCommRestrauntFatherId},
                #{nxDoGbDepartmentOrderId},
                #{nxDoNxRestrauntOrderId},
                #{nxDoCostPriceUpdate},
                #{nxDoCostPriceLevel},
                #{nxDoDisGoodsGrandId},
                #{nxDoGoodsType},
                #{nxDoPrintStandard},
                #{nxDoTodayOrder},
                #{nxDoPriceDifferent},
                #{nxDoExpcetPrice},
                #{nxDoGoodsName}
                )
    </insert>

    <update id="update" parameterType="com.nongxinle.entity.NxDepartmentOrdersEntity">
        update nx_department_orders
        <set>
            <if test="nxDoNxGoodsId != null">`nx_DO_nx_goods_id` = #{nxDoNxGoodsId},</if>
            <if test="nxDoNxGoodsFatherId != null">`nx_DO_nx_goods_father_id` = #{nxDoNxGoodsFatherId},</if>
            <if test="nxDoDisGoodsId != null">`nx_DO_dis_goods_id` = #{nxDoDisGoodsId},</if>
            <if test="nxDoDisGoodsFatherId != null">`nx_DO_dis_goods_father_id` = #{nxDoDisGoodsFatherId},</if>
            <if test="nxDoDepDisGoodsId != null">`nx_DO_dep_dis_goods_id` = #{nxDoDepDisGoodsId},</if>
            <if test="nxDoDepDisGoodsPrice != null">`nx_DO_dep_dis_goods_price` = #{nxDoDepDisGoodsPrice},</if>
            <if test="nxDoQuantity != null">`nx_DO_quantity` = #{nxDoQuantity},</if>
            <if test="nxDoStandard != null">`nx_DO_standard` = #{nxDoStandard},</if>
            <if test="nxDoRemark != null">`nx_DO_remark` = #{nxDoRemark},</if>
            <if test="nxDoDepartmentId != null">`nx_DO_department_id` = #{nxDoDepartmentId},</if>
            <if test="nxDoDepartmentFatherId != null">`nx_DO_department_father_id` = #{nxDoDepartmentFatherId},</if>
            <if test="nxDoDistributerId != null">`nx_DO_distributer_id` = #{nxDoDistributerId},</if>
            <if test="nxDoBillId != '-99'">`nx_DO_bill_id` = #{nxDoBillId},</if>
            <if test="nxDoStatus != null">`nx_DO_status` = #{nxDoStatus},</if>
            <if test="nxDoOrderUserId != null">`nx_DO_order_user_id` = #{nxDoOrderUserId},</if>
            <if test="nxDoPickUserId != null">`nx_DO_pick_user_id` = #{nxDoPickUserId},</if>
            <if test="nxDoAccountUserId != null">`nx_DO_account_user_id` = #{nxDoAccountUserId},</if>
            <if test="nxDoPurchaseStatus != null">`nx_DO_purchase_status` = #{nxDoPurchaseStatus},</if>
            <if test="nxDoApplyDate != null">`nx_DO_apply_date` = #{nxDoApplyDate},</if>
            <if test="nxDoArriveOnlyDate != null">`nx_DO_arrive_only_date` = #{nxDoArriveOnlyDate},</if>
            <if test="nxDoApplyFullTime != null">`nx_DO_apply_full_time` = #{nxDoApplyFullTime},</if>
            <if test="nxDoOperationTime != null">`nx_DO_operation_time` = #{nxDoOperationTime},</if>
            <if test="nxDoArriveWhatDay != null">`nx_DO_arrive_what_day` = #{nxDoArriveWhatDay},</if>
            <if test="nxDoIsAgent != null">`nx_DO_is_agent` = #{nxDoIsAgent},</if>
            <if test="nxDoArriveWeeksYear != null">`nx_DO_arrive_weeks_year` = #{nxDoArriveWeeksYear},</if>
            <if test="nxDoApplyOnlyTime != null">`nx_DO_apply_only_time` = #{nxDoApplyOnlyTime},</if>
            <if test="nxDoCostPrice != '-99'">`nx_DO_cost_price` = #{nxDoCostPrice},</if>
            <if test="nxDoReturnWeight != null">`nx_DO_return_weight` = #{nxDoReturnWeight},</if>
            <if test="nxDoReturnSubtotal != null">`nx_DO_return_subtotal` = #{nxDoReturnSubtotal},</if>
            <if test="nxDoReturnBillId != '-99'">`nx_DO_return_bill_id` = #{nxDoReturnBillId},</if>
            <if test="nxDoReturnStatus != null">`nx_DO_return_status` = #{nxDoReturnStatus},</if>
            <if test="nxDoGbDistributerId != null">`nx_DO_gb_distributer_id` = #{nxDoGbDistributerId},</if>
            <if test="nxDoGbDepartmentId != null">`nx_DO_gb_department_id` = #{nxDoGbDepartmentId},</if>
            <if test="nxDoExpcetPrice != null">`nx_DO_expect_price` = #{nxDoExpcetPrice},</if>
            <if test="nxDoGbDepartmentFatherId != null">`nx_DO_gb_department_father_id` = #{nxDoGbDepartmentFatherId},
            </if>
            <if test="nxDoCostSubtotal != '-99'">`nx_DO_cost_subtotal` = #{nxDoCostSubtotal},</if>
            <if test="nxDoPrice != '-99'">`nx_DO_price` = #{nxDoPrice},</if>
            <if test="nxDoWeight != '-99'">`nx_DO_weight` = #{nxDoWeight},</if>
            <if test="nxDoSubtotal != '-99'">`nx_DO_subtotal` = #{nxDoSubtotal},</if>
            <if test="nxDoPurchaseGoodsId != '-99'">`nx_DO_purchase_goods_id` = #{nxDoPurchaseGoodsId},</if>
            <if test="nxDoPurchaseUserId != '-99'">`nx_DO_purchase_user_id` = #{nxDoPurchaseUserId},</if>
            <if test="nxDoWeightId != '-99'">`nx_DO_weight_id` = #{nxDoWeightId},</if>
            <if test="nxDoProfitSubtotal != '-99'">`nx_DO_profit_subtotal` = #{nxDoProfitSubtotal},</if>
            <if test="nxDoProfitScale != '-99'">`nx_DO_profit_scale` = #{nxDoProfitScale},</if>
            <if test="nxDoNxCommunityId != null">`nx_DO_nx_community_id` = #{nxDoNxCommunityId},</if>
            <if test="nxDoNxCommRestrauntId != null">`nx_DO_nx_comm_restraunt_id` = #{nxDoNxCommRestrauntId},</if>
            <if test="nxDoGbDepartmentOrderId != null">`nx_DO_gb_department_order_id` = #{nxDoGbDepartmentOrderId},</if>
            <if test="nxDoNxRestrauntOrderId!= null">`nx_DO_nx_restraunt_order_id` = #{nxDoNxRestrauntOrderId},</if>
            <if test="nxDoCostPriceUpdate!= '-99'">`nx_DO_cost_price_update` = #{nxDoCostPriceUpdate},</if>
            <if test="nxDoCostPriceLevel!= '-99'">`nx_DO_cost_price_level` = #{nxDoCostPriceLevel},</if>
            <if test="nxDoDisGoodsGrandId!= '-99'">`nx_DO_dis_goods_grand_id` = #{nxDoDisGoodsGrandId},</if>
            <if test="nxDoGoodsType!= '-99'">`nx_DO_goods_type` = #{nxDoGoodsType},</if>
            <if test="nxDoPrintStandard!= '-99'">`nx_DO_print_standard` = #{nxDoPrintStandard},</if>
            <if test="nxDoTodayOrder!= '-99'">`nx_DO_today_order` = #{nxDoTodayOrder},</if>
            <if test="nxDoPriceDifferent!= '-99'">`nx_DO_price_different` = #{nxDoPriceDifferent},</if>
            <if test="nxDoGoodsName!= '-99'">`nx_DO_goods_name` = #{nxDoGoodsName},</if>
            <if test="nxDoNxCommRestrauntFatherId != null">`nx_DO_nx_comm_restraunt_father_id` =
                #{nxDoNxCommRestrauntFatherId},
            </if>
            <if test="nxDoArriveDate != null">`nx_DO_arrive_date` = #{nxDoArriveDate}</if>
        </set>
        where nx_department_orders_id = #{nxDepartmentOrdersId}
    </update>

    <delete id="delete">
        delete
        from nx_department_orders
        where nx_department_orders_id = #{value}
    </delete>

    <delete id="deleteBatch">
        delete from nx_department_orders where nx_department_orders_id in
        <foreach item="nxDepartmentOrdersId" collection="array" open="(" separator="," close=")">
            #{nxDepartmentOrdersId}
        </foreach>
    </delete>

</mapper>