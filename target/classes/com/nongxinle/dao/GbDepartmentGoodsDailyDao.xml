<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.nongxinle.dao.GbDepartmentGoodsDailyDao">

    <select id="queryObject" resultType="com.nongxinle.entity.GbDepartmentGoodsDailyEntity">
        select *
        from gb_department_goods_daily
        where gb_department_goods_daily_id = #{value}
    </select>

    <select id="queryList" resultType="com.nongxinle.entity.GbDepartmentGoodsDailyEntity">
        select * from gb_department_goods_daily
        <if test="offset != null and limit != null">
            limit #{offset}, #{limit}
        </if>
    </select>

    <select id="queryTotal" resultType="int">
        select count(*)
        from gb_department_goods_daily
    </select>

    <select id="queryDepGoodsDailyItem" resultType="com.nongxinle.entity.GbDepartmentGoodsDailyEntity">
        select * from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyCount" resultType="java.lang.Integer">
        select COUNT(*) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>

        </where>
    </select>
    <select id="queryDepGoodsDailyListByParams"
            resultType="com.nongxinle.entity.GbDepartmentGoodsDailyEntity">
        select * from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <select id="queryDepGoodsDailyProfitSubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_profit_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <select id="queryDepGoodsDailySalesSubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_sales_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>

    </select>
    <select id="queryDepGoodsDailySalesProfitSubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_after_profit_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <resultMap id="fatherGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsSort" column="gb_dfg_father_goods_sort"/>
        <result property="gbDfgFatherGoodsLevel" column="gb_dfg_father_goods_level"/>
        <collection property="gbDistributerGoodsEntities" resultMap="disGoods"/>
    </resultMap>
    <resultMap id="grandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGrant_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGrant_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGrant_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="ndfgGrant_gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsSort" column="ndfgGrant_gb_dfg_father_goods_sort"/>
        <result property="gbDfgFatherGoodsLevel" column="ndfgGrant_gb_dfg_father_goods_level"/>
        <collection property="fatherGoodsEntities" resultMap="fatherGoods"/>
    </resultMap>

    <resultMap id="greatGrandGoods" type="GbDistributerFatherGoodsEntity">
        <id property="gbDistributerFatherGoodsId" column="ndfgGreatGrand_gb_distributer_father_goods_id"/>
        <result property="gbDfgFathersFatherId" column="ndfgGreatGrand_gb_dfg_fathers_father_id"/>
        <result property="gbDfgFatherGoodsName" column="ndfgGreatGrand_gb_dfg_father_goods_name"/>
        <result property="gbDfgFatherGoodsColor" column="ndfgGreatGrand_gb_dfg_father_goods_color"/>
        <result property="gbDfgFatherGoodsSort" column="ndfgGreatGrand_gb_dfg_father_goods_sort"/>
        <result property="gbDfgFatherGoodsLevel" column="ndfgGreatGrand_gb_dfg_father_goods_level"/>
        <collection property="fatherGoodsEntities" resultMap="grandGoods"/>
    </resultMap>

    <select id="queryDepDailyGoodsFatherTypeByParams" resultMap="greatGrandGoods">
        select *,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGrant.gb_dfg_father_goods_color 'ndfgGrant_gb_dfg_father_goods_color',
        ndfgGrant.gb_dfg_father_goods_sort 'ndfgGrant_gb_dfg_father_goods_sort',
        ndfgGrant.gb_dfg_father_goods_level 'ndfgGrant_gb_dfg_father_goods_level',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_sort 'ndfgGreatGrand_gb_dfg_father_goods_sort',
        ndfgGreatGrand.gb_dfg_father_goods_level 'ndfgGreatGrand_gb_dfg_father_goods_level'
        from gb_department_goods_daily as gdgd
        left join gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgd.gb_dgd_gb_dis_goods_father_id
        left join gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgd.gb_dgd_date &lt;= #{notDayuStopDate}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="return != null">
                and gdgd.gb_dgd_return_weight &gt; #{return}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>

            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>

        </where>
        order by ndfgGreatGrand.gb_distributer_father_goods_id,
        ndfgGrant.gb_distributer_father_goods_id,ndfg.gb_distributer_father_goods_id
    </select>

    <select id="queryDisGoodsTreesetByParams" resultType="com.nongxinle.entity.GbDistributerGoodsEntity">
        select * from gb_distributer_goods as dg
        left join gb_department_goods_daily as gdgd on dg.gb_distributer_goods_id =
        gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as dep on dep.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and dep.gb_department_type = #{depType}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disId != null">
                and gb_dg_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgd.gb_dgd_date &lt;= #{notDayuStopDate}
            </if>
            <if test="disGoodsId != null">
                and gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>

            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and dg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and dg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and dg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyLossSubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_loss_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyWasteSubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_waste_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <resultMap id="depGoods" type="GbDepartmentDisGoodsEntity">
        <id property="gbDepartmentDisGoodsId" column="gb_department_dis_goods_id"/>
        <result property="gbDdgGbDisId" column="gb_DDG_gb_dis_id"/>
        <result property="gbDdgDisGoodsFatherId" column="gb_DDG_dis_goods_Father_id"/>
        <result property="gbDdgDepGoodsName" column="gb_DDG_dep_goods_name"/>
        <result property="gbDdgDepGoodsStandardname" column="gb_DDG_dep_goods_standardname"/>
        <result property="gbDdgDepGoodsBrand" column="gb_DDG_dep_goods_brand"/>
        <result property="gbDdgDepGoodsDetail" column="gb_DDG_dep_goods_detail"/>
        <result property="gbDdgDepGoodsPlace" column="gb_DDG_dep_goods_place"/>
        <result property="gbDdgDisGoodsId" column="gb_DDG_dis_goods_id"/>
        <result property="gbDdgGoodsType" column="gb_DDG_goods_type"/>
        <result property="gbDdgNxDistributerId" column="gb_DDG_nx_distributer_id"/>
        <result property="gbDdgNxDistributerGoodsId" column="gb_DDG_nx_distributer_goods_id"/>
        <result property="gbDdgGbDepartmentId" column="gb_DDG_gb_department_id"/>
        <result property="gbDdgGbSupplierId" column="gb_DDG_gb_supplier_id"/>
        <result property="gbDdgStockTotalSubtotal" column="gb_DDG_stock_total_subtotal"/>
        <result property="gbDdgStockTotalWeight" column="gb_DDG_stock_total_weight"/>
        <result property="gbDdgPrepareTotalWeight" column="gb_DDG_prepare_total_weight"/>
        <result property="gbDdgShowStandardId" column="gb_DDG_show_standard_id"/>
        <result property="gbDdgShowStandardName" column="gb_DDG_show_standard_name"/>
        <result property="gbDdgShowStandardName" column="gb_DDG_show_standard_name"/>
        <result property="gbDdgShowStandardScale" column="gb_DDG_show_standard_scale"/>
        <result property="gbDdgSellingPrice" column="gb_DDG_selling_price"/>
        <result property="gbDdgOrderDate" column="gb_DDG_order_date"/>
        <result property="gbDdgOrderPrice" column="gb_DDG_order_price"/>
        <result property="gbDdgOrderQuantity" column="gb_DDG_order_quantity"/>
        <result property="gbDdgOrderRemark" column="gb_DDG_order_remark"/>
        <result property="gbDdgOrderStandard" column="gb_DDG_order_standard"/>
        <result property="gbDdgOrderWeight" column="gb_DDG_order_weight"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
    </resultMap>
    <resultMap id="disGoods" type="GbDistributerGoodsEntity">
        <id property="gbDistributerGoodsId" column="gb_distributer_goods_id"/>
        <result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgGoodsIsHidden" column="gb_dg_goods_is_hidden"/>
        <result property="gbDgGoodsSonsSort" column="gb_dg_goods_sons_sort"/>
        <result property="gbDgSellingPrice" column="gb_dg_selling_price"/>
        <result property="gbDgPullOff" column="gb_dg_pull_off"/>
        <result property="gbDgDfgGoodsFatherId" column="gb_dg_dfg_goods_father_id"/>
        <result property="gbDgDistributerId" column="gb_dg_distributer_id"/>
        <result property="gbDgNxGoodsId" column="gb_dg_nx_goods_id"/>
        <result property="gbDgNxFatherId" column="gb_dg_nx_father_id"/>
        <result property="gbDgGoodsName" column="gb_dg_goods_name"/>
        <result property="gbDgGoodsStandardname" column="gb_dg_goods_standardname"/>
        <result property="gbDgGoodsStandardWeight" column="gb_dg_goods_standard_weight"/>
        <result property="gbDgGoodsPinyin" column="gb_dg_goods_pinyin"/>
        <result property="gbDgGoodsPy" column="gb_dg_goods_py"/>
        <result property="gbDgGoodsDetail" column="gb_dg_goods_detail"/>
        <result property="gbDgGoodsBrand" column="gb_dg_goods_brand"/>
        <result property="gbDgGoodsPlace" column="gb_dg_goods_place"/>
        <result property="gbDgGoodsIsWeight" column="gb_dg_goods_is_weight"/>
        <result property="gbDgNxGoodsFatherColor" column="gb_dg_nx_goods_father_color"/>
        <result property="gbDgGoodsType" column="gb_dg_goods_type"/>
        <result property="gbDgNxDistributerId" column="gb_dg_nx_distributer_id"/>
        <result property="gbDgNxDistributerGoodsId" column="gb_dg_nx_distributer_goods_id"/>
        <result property="gbDgGbDepartmentId" column="gb_dg_gb_department_id"/>
        <result property="gbDgGbSupplierId" column="gb_dg_gb_supplier_id"/>
        <result property="gbDgGoodsPrice" column="gb_dg_goods_price"/>
        <result property="gbDgGoodsLowestPrice" column="gb_dg_goods_lowest_price"/>
        <result property="gbDgGoodsHighestPrice" column="gb_dg_goods_highest_price"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgControlPrice" column="gb_dg_control_price"/>
        <result property="gbDgControlFresh" column="gb_dg_control_fresh"/>
        <result property="gbDgFreshWarnHour" column="gb_dg_fresh_warn_hour"/>
        <result property="gbDgFreshWasteHour" column="gb_dg_fresh_waste_hour"/>
        <result property="gbDgGoodsInventoryType" column="gb_dg_goods_inventory_type"/>
        <result property="gbDgIsFranchisePrice" column="gb_dg_is_franchise_price"/>
        <result property="gbDgFranchisePriceOne" column="gb_dg_franchise_price_one"/>
        <result property="gbDgFranchisePriceOneUpdate" column="gb_dg_franchise_price_one_update"/>
        <result property="gbDgFranchisePriceTwo" column="gb_dg_franchise_price_two"/>
        <result property="gbDgFranchisePriceTwoUpdate" column="gb_dg_franchise_price_two_update"/>
        <result property="gbDgFranchisePriceThree" column="gb_dg_franchise_price_three"/>
        <result property="gbDgFranchisePriceThreeUpdate" column="gb_dg_franchise_price_three_update"/>
        <result property="gbDgIsSelfControl" column="gb_dg_is_self_control"/>
        <result property="gbDgSelfPrice" column="gb_dg_self_price"/>

    </resultMap>
    <resultMap id="dep" type="GbDepartmentEntity">
        <id property="gbDepartmentId" column="gb_department_id"/>
		<result property="gbDepartmentNamePy" column="gb_department_name_py"/>
        <result property="gbDepartmentName" column="gb_department_name"/>
        <result property="gbDepartmentAttrName" column="gb_department_attr_name"/>
        <result property="gbDepartmentDisId" column="gb_department_dis_id"/>
        <result property="gbDepartmentSubAmount" column="gb_department_sub_amount"/>
        <result property="gbDepartmentIsGroupDep" column="gb_department_is_group_dep"/>
        <result property="gbDepartmentSubAmount" column="gb_department_sub_amount"/>
        <result property="gbDepartmentFatherId" column="gb_department_father_id"/>
        <result property="gbDepartmentSettleType" column="gb_department_settle_type"/>
        <result property="gbDepartmentType" column="gb_department_type"/>
        <result property="gbDepartmentLevel" column="gb_department_level"/>
        <result property="gbDepartmentPrintName" column="gb_department_print_name"/>
        <association property="gbDepartmentDisGoodsEntity" resultMap="depGoods"/>
    </resultMap>
    <select id="queryWhichDepsHasProduceDepGoodsDaily" resultMap="dep">
        select * from gb_department as gd
        left join gb_department_goods_daily as gdgd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department_dis_goods as gddg on gddg.gb_DDG_dis_goods_id = #{disGoodsId} and
        gddg.gb_DDG_department_id = gd.gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
        order by gd.gb_department_type
    </select>
    <select id="queryDepGoodsDailyProduceWeight" resultType="java.lang.Double">
        select SUM(gb_dgd_produce_weight) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyLossWeight" resultType="java.lang.Double">
        select SUM(gb_dgd_loss_weight) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyWasteWeight" resultType="java.lang.Double">
        select SUM(gb_dgd_waste_weight) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryFreshFatherGoods" resultMap="greatGrandGoods">
        select * ,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGrant.gb_dfg_father_goods_color 'ndfgGrant_gb_dfg_father_goods_color',
        ndfgGrant.gb_dfg_father_goods_level 'ndfgGrant_gb_dfg_father_goods_level',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_level 'ndfgGreatGrand_gb_dfg_father_goods_level'
        from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgd.gb_dgd_gb_dis_goods_father_id
        left join gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id

        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyRestWeight" resultType="java.lang.Double">
        select SUM(gb_dgd_rest_weight) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepDisGoodsTreeByParams" resultMap="depGoods">
        select * from gb_department_goods_daily as gdgd
        left join gb_department_dis_goods as gdg on gdg.gb_department_dis_goods_id = gdgd.gb_dgd_gb_dep_dis_goods_id
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdg.gb_DDG_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_week = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="return != null">
                and gdgd.gb_dgd_return_weight &gt; #{return}
            </if>
            <if test="controlFresh != null">
                and dg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and dg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and dg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyWeight" resultType="java.lang.Double">
        select SUM(gb_dgd_weight) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyLastWeight" resultType="java.lang.Double">
        select SUM(gb_dgd_last_weight) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryClearFatherGoods" resultMap="greatGrandGoods">
        select * ,
        ndfgGrant.gb_distributer_father_goods_id 'ndfgGrant_gb_distributer_father_goods_id',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGrant.gb_dfg_father_goods_name 'ndfgGrant_gb_dfg_father_goods_name',
        ndfgGrant.gb_dfg_father_goods_color 'ndfgGrant_gb_dfg_father_goods_color',
        ndfgGrant.gb_dfg_father_goods_level 'ndfgGrant_gb_dfg_father_goods_level',
        ndfgGrant.gb_dfg_fathers_father_id 'ndfgGrant_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_distributer_father_goods_id 'ndfgGreatGrand_gb_distributer_father_goods_id',
        ndfgGreatGrand.gb_dfg_fathers_father_id 'ndfgGreatGrand_gb_dfg_fathers_father_id',
        ndfgGreatGrand.gb_dfg_father_goods_name 'ndfgGreatGrand_gb_dfg_father_goods_name',
        ndfgGreatGrand.gb_dfg_father_goods_color 'ndfgGreatGrand_gb_dfg_father_goods_color',
        ndfgGreatGrand.gb_dfg_father_goods_level 'ndfgGreatGrand_gb_dfg_father_goods_level'
        from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_distributer_father_goods as ndfg on ndfg.gb_distributer_father_goods_id =
        gdgd.gb_dgd_gb_dis_goods_father_id
        left join gb_distributer_father_goods as ndfgGrant on ndfgGrant.gb_distributer_father_goods_id =
        ndfg.gb_dfg_fathers_father_id
        left join gb_distributer_father_goods as ndfgGreatGrand on
        ndfgGreatGrand.gb_distributer_father_goods_id = ndfgGrant.gb_dfg_fathers_father_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>

            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>

    </select>
    <select id="queryDepGoodsDailyClearHour" resultType="java.lang.Integer">
        select SUM(gb_dgd_sell_clear_hour) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyClearMinute" resultType="java.lang.Integer">
        select SUM(gb_dgd_sell_clear_minute) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyProduceSubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_produce_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>
    <select id="queryDepGoodsFreshRate" resultType="java.lang.Double">
        select SUM(gb_dgd_fresh_rate) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailySubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyReturnSubtotal" resultType="java.lang.Double">
        select SUM(gb_dgd_return_subtotal) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyHighestFreshRate" resultType="java.lang.Double">
        select MAX(gb_dgd_fresh_rate) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyLowestFreshRate" resultType="java.lang.Double">
        select MIN(gb_dgd_fresh_rate) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>
    </select>
    <select id="queryDepGoodsDailyReturnWeight" resultType="java.lang.Double">
        select SUM(gb_dgd_return_weight) from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
        </where>

    </select>
    <select id="queryWhichDepsHasProduceDepGoodsDailyNew" resultMap="dep">
        select * from gb_department as gd
        left join gb_department_goods_daily as gdgd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id

        <where>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and dg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and dg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and dg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <resultMap id="dailyWithGoods" type="GbDepartmentGoodsDailyEntity">
        <id property="gbDepartmentGoodsDailyId" column="gb_department_goods_daily_id"/>
        <result property="gbDgdLastProduceWeight" column="gb_dgd_last_produce_weight"/>
        <result property="gbDgdFreshRate" column="gb_dgd_fresh_rate"/>
        <result property="gbDgdLastWeight" column="gb_dgd_last_weight"/>
        <result property="gbDgdAfterProfitSubtotal" column="gb_dgd_after_profit_subtotal"/>
        <result property="gbDgdProfitSubtotal" column="gb_dgd_profit_subtotal"/>
        <result property="gbDgdProduceWeight" column="gb_dgd_produce_weight"/>
        <result property="gbDgdProduceSubtotal" column="gb_dgd_produce_subtotal"/>
        <result property="gbDgdWasteWeight" column="gb_dgd_waste_weight"/>
        <result property="gbDgdWasteSubtotal" column="gb_dgd_waste_subtotal"/>
        <result property="gbDgdLossWeight" column="gb_dgd_loss_weight"/>
        <result property="gbDgdLossSubtotal" column="gb_dgd_loss_subtotal"/>
        <result property="gbDgdDate" column="gb_dgd_date"/>
        <result property="gbDgdFullTime" column="gb_dgd_full_time"/>
        <result property="gbDgdGbDepartmentId" column="gb_dgd_gb_department_id"/>
        <result property="gbDgdGbDepartmentFatherId" column="gb_dgd_gb_department_father_id"/>
        <result property="gbDgdGbDisGoodsId" column="gb_dgd_gb_dis_goods_id"/>
        <result property="gbDgdMonth" column="gb_dgd_month"/>
        <result property="gbDgdWeek" column="gb_dgd_week"/>
        <result property="gbDgdGbDistributerId" column="gb_dgd_gb_distributer_id"/>
        <result property="gbDgdReturnWeight" column="gb_dgd_return_weight"/>
        <result property="gbDgdReturnSubtotal" column="gb_dgd_return_subtotal"/>
        <result property="gbDgdRestWeight" column="gb_dgd_rest_weight"/>
        <result property="gbDgdDay" column="gb_dgd_day"/>
        <result property="gbDgdWeight" column="gb_dgd_weight"/>
        <result property="gbDgdSubtotal" column="gb_dgd_subtotal"/>
        <result property="gbDgdGbDepDisGoodsId" column="gb_dgd_gb_dep_dis_goods_id"/>
        <result property="gbDgdSellClearHour" column="gb_dgd_sell_clear_hour"/>
        <result property="gbDgdSellClearMinute" column="gb_dgd_sell_clear_minute"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
    </resultMap>

    <resultMap id="stockWithReduce" type="GbDepartmentGoodsStockEntity">
        <id property="gbDepartmentGoodsStockId" column="gb_department_goods_stock_id"/>
        <result property="gbDgsProduceSellingSubtotal" column="gb_dgs_produce_selling_subtotal"/>
        <result property="gbDgsNxDistributerId" column="gb_dgs_nx_distributer_id"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsAfterProfitSubtotal" column="gb_dgs_after_profit_subtotal"/>
        <result property="gbDgsBetweenPrice" column="gb_dgs_between_price"/>
        <result property="gbDgsProfitWeight" column="gb_dgs_profit_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsSellingPrice" column="gb_dgs_selling_price"/>
        <result property="gbDgsSellingSubtotal" column="gb_dgs_selling_subtotal"/>
        <result property="gbDgsWasteWeight" column="gb_dgs_waste_weight"/>
        <result property="gbDgsProfitSubtotal" column="gb_dgs_profit_subtotal"/>
        <result property="gbDgsRestWeightShowStandard" column="gb_dgs_rest_weight_show_standard"/>
        <result property="gbDgsRestWeightShowStandardName" column="gb_dgs_rest_weight_show_standard_name"/>
        <result property="gbDgsGbDisGoodsId" column="gb_dgs_gb_dis_goods_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbDisGoodsFatherId" column="gb_dgs_gb_dis_goods_father_id"/>
        <result property="gbDgsGbDepDisGoodsId" column="gb_dgs_gb_dep_dis_goods_id"/>
        <result property="gbDgsPrice" column="gb_dgs_price"/>
        <result property="gbDgsWeight" column="gb_dgs_weight"/>
        <result property="gbDgsSubtotal" column="gb_dgs_subtotal"/>
        <result property="gbDgsRestWeight" column="gb_dgs_rest_weight"/>
        <result property="gbDgsRestSubtotal" column="gb_dgs_rest_subtotal"/>
        <result property="gbDgsProduceWeight" column="gb_dgs_produce_weight"/>
        <result property="gbDgsProduceSubtotal" column="gb_dgs_produce_subtotal"/>
        <result property="gbDgsGbDepartmentId" column="gb_dgs_gb_department_id"/>
        <result property="gbDgsGbDepartmentFatherId" column="gb_dgs_gb_department_father_id"/>
        <result property="gbDgsGbFromDepartmentId" column="gb_dgs_gb_from_department_id"/>
        <result property="gbDgsStatus" column="gb_dgs_status"/>
        <result property="gbDgsReceiveUserId" column="gb_dgs_receive_user_id"/>
        <result property="gbDgsGbDistributerId" column="gb_dgs_gb_distributer_id"/>
        <result property="gbDgsGbGoodsStockId" column="gb_dgs_gb_goods_stock_id"/>
        <result property="gbDgsDate" column="gb_dgs_date"/>
        <result property="gbDgsInventoryDate" column="gb_dgs_inventory_date"/>
        <result property="gbDgsInventoryFullTime" column="gb_dgs_inventory_full_time"/>
        <result property="gbDgsInventoryWeek" column="gb_dgs_inventory_week"/>
        <result property="gbDgsInventoryMonth" column="gb_dgs_inventory_month"/>
        <result property="gbDgsWarnFullTime" column="gb_dgs_warn_full_time"/>
        <result property="gbDgsWasteFullTime" column="gb_dgs_waste_full_time"/>
        <result property="gbDgsFullTime" column="gb_dgs_full_time"/>
        <result property="gbDgsDoWasteFullTime" column="gb_dgs_do_waste_full_time"/>
        <result property="gbDgsLossWeight" column="gb_dgs_loss_weight"/>
        <result property="gbDgsLossSubtotal" column="gb_dgs_loss_subtotal"/>
        <result property="gbDgsReturnWeight" column="gb_dgs_return_weight"/>
        <result property="gbDgsReturnSubtotal" column="gb_dgs_return_subtotal"/>
        <result property="gbDgsWarnTimeQuantumName" column="gb_dgs_warn_time_quantum_name"/>
        <result property="gbDgsWasteTimeQuantumName" column="gb_dgs_waste_time_quantum_name"/>
        <result property="gbDgsGbPurGoodsId" column="gb_dgs_gb_pur_goods_id"/>
        <result property="gbDgsGbPriceGoodsId" column="gb_dgs_gb_price_goods_id"/>
        <result property="gbDgsGbPriceSubtotal" column="gb_dgs_gb_price_subtotal"/>
        <result property="gbDgsOutFullTime" column="gb_dgs_out_full_time"/>
        <collection property="goodsStockReduceEntityList" resultMap="reduce"/>
    </resultMap>

    <resultMap id="wasteReduce" type="GbDepartmentGoodsStockReduceEntity">
        <id property="gbDepartmentGoodsStockReduceId" column="waste_gb_department_goods_stock_reduce_id"/>
        <result property="gbDgsrGbGoodsStockId" column="waste_gb_dgsr_gb_goods_stock_id"/>
        <result property="gbDgsrGbDisGoodsId" column="waste_gb_dgsr_gb_dis_goods_id"/>
        <result property="gbDgsrWasteWeight" column="waste_gb_dgsr_waste_weight"/>
        <result property="gbDgsrWasteSubtotal" column="waste_gb_dgsr_waste_subtotal"/>
        <result property="gbDgsrDate" column="waste_gb_dgsr_date"/>
        <result property="gbDgsrType" column="waste_gb_dgsr_type"/>
    </resultMap>
    <resultMap id="reduce" type="GbDepartmentGoodsStockReduceEntity">
        <id property="gbDepartmentGoodsStockReduceId" column="all_gb_department_goods_stock_reduce_id"/>
        <result property="gbDgsrStockNxDistribtuerId" column="all_gb_dgsr_stock_nx_distributer_id"/>
        <result property="gbDgsrProfitSubtotal" column="all_gb_dgsr_profit_subtotal"/>
        <result property="gbDgsrGbGoodsStockId" column="all_gb_dgsr_gb_goods_stock_id"/>
        <result property="gbDgsrProduceWeight" column="all_gb_dgsr_produce_weight"/>
        <result property="gbDgsrProduceSubtotal" column="all_gb_dgsr_produce_subtotal"/>
        <result property="gbDgsrWasteWeight" column="all_gb_dgsr_waste_weight"/>
        <result property="gbDgsrWasteSubtotal" column="all_gb_dgsr_waste_subtotal"/>
        <result property="gbDgsrLossWeight" column="all_gb_dgsr_loss_weight"/>
        <result property="gbDgsrLossSubtotal" column="all_gb_dgsr_loss_subtotal"/>
        <result property="gbDgsrDate" column="all_gb_dgsr_date"/>
        <result property="gbDgsrType" column="all_gb_dgsr_type"/>
        <result property="gbDgsrStatus" column="all_gb_dgsr_status"/>
        <result property="gbDgsrGbDepartmentId" column="all_gb_dgsr_gb_department_id"/>
        <result property="gbDgsrGbDepartmentFatherId" column="all_gb_dgsr_gb_department_father_id"/>
        <result property="gbDgsrGbDisGoodsId" column="all_gb_dgsr_gb_dis_goods_id"/>
        <result property="gbDgsrMonth" column="all_gb_dgsr_month"/>
        <result property="gbDgsrWeek" column="all_gb_dgsr_week"/>
        <result property="gbDgsrGbDistributerId" column="all_gb_dgsr_gb_distributer_id"/>
        <result property="gbDgsrReturnWeight" column="all_gb_dgsr_return_weight"/>
        <result property="gbDgsrReturnSubtotal" column="all_gb_dgsr_return_subtotal"/>
    </resultMap>

    <resultMap id="dailyWithReduce" type="GbDepartmentGoodsDailyEntity">
        <id property="gbDepartmentGoodsDailyId" column="gb_department_goods_daily_id"/>
        <result property="gbDgdLastProduceWeight" column="gb_dgd_last_produce_weight"/>
        <result property="gbDgdFreshRate" column="gb_dgd_fresh_rate"/>
        <result property="gbDgdLastWeight" column="gb_dgd_last_weight"/>
        <result property="gbDgdAfterProfitSubtotal" column="gb_dgd_after_profit_subtotal"/>
        <result property="gbDgdProfitSubtotal" column="gb_dgd_profit_subtotal"/>
        <result property="gbDgdProduceWeight" column="gb_dgd_produce_weight"/>
        <result property="gbDgdProduceSubtotal" column="gb_dgd_produce_subtotal"/>
        <result property="gbDgdWasteWeight" column="gb_dgd_waste_weight"/>
        <result property="gbDgdWasteSubtotal" column="gb_dgd_waste_subtotal"/>
        <result property="gbDgdLossWeight" column="gb_dgd_loss_weight"/>
        <result property="gbDgdLossSubtotal" column="gb_dgd_loss_subtotal"/>
        <result property="gbDgdDate" column="gb_dgd_date"/>
        <result property="gbDgdFullTime" column="gb_dgd_full_time"/>
        <result property="gbDgdGbDepartmentId" column="gb_dgd_gb_department_id"/>
        <result property="gbDgdGbDepartmentFatherId" column="gb_dgd_gb_department_father_id"/>
        <result property="gbDgdGbDisGoodsId" column="gb_dgd_gb_dis_goods_id"/>
        <result property="gbDgdMonth" column="gb_dgd_month"/>
        <result property="gbDgdWeek" column="gb_dgd_week"/>
        <result property="gbDgdGbDistributerId" column="gb_dgd_gb_distributer_id"/>
        <result property="gbDgdReturnWeight" column="gb_dgd_return_weight"/>
        <result property="gbDgdReturnSubtotal" column="gb_dgd_return_subtotal"/>
        <result property="gbDgdRestWeight" column="gb_dgd_rest_weight"/>
        <result property="gbDgdDay" column="gb_dgd_day"/>
        <result property="gbDgdWeight" column="gb_dgd_weight"/>
        <result property="gbDgdSubtotal" column="gb_dgd_subtotal"/>
        <result property="gbDgdGbDepDisGoodsId" column="gb_dgd_gb_dep_dis_goods_id"/>
        <result property="gbDgdSellClearHour" column="gb_dgd_sell_clear_hour"/>
        <result property="gbDgdSellClearMinute" column="gb_dgd_sell_clear_minute"/>
        <association property="gbDistributerGoodsEntity" resultMap="disGoods"/>
        <collection property="wasteReduceList" resultMap="wasteReduce"/>
        <collection property="gbDepartmentGoodsStockEntities" resultMap="stockWithReduce"/>
    </resultMap>
    <select id="queryDepGoodsDailyListWithGoodsByParams" resultMap="dailyWithGoods">
        select * from gb_department_goods_daily as gdgd
        left join gb_distributer_goods as gdg on gdg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        left join gb_department as gd on gd.gb_department_id = gdgd.gb_dgd_gb_department_id

        <where>
            <if test="clear != null">
                and gdgd.gb_dgd_sell_clear_hour &gt; #{clear}
            </if>
            <if test="depType != null">
                and gd.gb_department_type = #{depType}
            </if>
            <if test="disId != null">
                and gdgd.gb_dgd_gb_distributer_id = #{disId}
            </if>
            <if test="disGoodsFatherId != null">
                and gdgd.gb_dgd_gb_dis_goods_father_id = #{disGoodsFatherId}
            </if>
            <if test="disGoodsId != null">
                and gdgd.gb_dgd_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depGoodsId != null">
                and gdgd.gb_dgd_gb_dep_dis_goods_id = #{depGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depId != null">
                and gdgd.gb_dgd_gb_department_id = #{depId}
            </if>
            <if test="date != null">
                and gdgd.gb_dgd_date = #{date}
            </if>
            <if test="week != null">
                and gdgd.gb_dgd_date = #{week}
            </if>
            <if test="month != null">
                and gdgd.gb_dgd_month = #{month}
            </if>
            <if test="year != null">
                and gdgd.gb_dgd_year = #{year}
            </if>
            <if test="startDate != null">
                and gdgd.gb_dgd_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgd.gb_dgd_date &lt;= #{stopDate}
            </if>
            <if test="equalRestWeight != null">
                and gdgd.gb_dgd_rest_weight = #{equalRestWeight}
            </if>
            <if test="restWeight != null">
                and gdgd.gb_dgd_rest_weight &gt; #{restWeight}
            </if>
            <if test="produce != null">
                and gdgd.gb_dgd_produce_weight &gt; #{produce}
            </if>
            <if test="loss != null">
                and gdgd.gb_dgd_loss_weight &gt; #{loss}
            </if>
            <if test="waste != null">
                and gdgd.gb_dgd_waste_weight &gt; #{waste}
            </if>
            <if test="controlFresh != null">
                and gdg.gb_dg_control_fresh = #{controlFresh}
            </if>
            <if test="toDepId != null">
                and gdg.gb_dg_gb_department_id = #{toDepId}
            </if>
            <if test="nxDisId != null">
                and gdg.gb_dg_nx_distributer_id = #{nxDisId}
            </if>
            <if test="depFatherIds != null">
                and gdgd.gb_dgd_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>

    <select id="queryDepGoodsDailyListWithReduceByParams" resultMap="dailyWithReduce">
        select *,
        gdgsr.gb_department_goods_stock_reduce_id 'waste_gb_department_goods_stock_reduce_id',
        gdgsr.gb_dgsr_date 'waste_gb_dgsr_date',
        gdgsr.gb_dgsr_gb_goods_stock_id 'waste_gb_dgsr_gb_goods_stock_id',
        gdgsr.gb_dgsr_gb_dis_goods_id 'waste_gb_dgsr_gb_dis_goods_id',
        gdgsr.gb_dgsr_type 'waste_gb_dgsr_type',
        gdgsr.gb_dgsr_waste_weight 'waste_gb_dgsr_waste_weight',
        gdgsr.gb_dgsr_waste_subtotal 'waste_gb_dgsr_waste_subtotal',

        gsr.gb_dgsr_date 'all_gb_dgsr_date',
        gsr.gb_dgsr_gb_goods_stock_id 'all_gb_dgsr_gb_goods_stock_id',
        gsr.gb_dgsr_gb_dis_goods_id 'all_gb_dgsr_gb_dis_goods_id',
        gsr.gb_dgsr_type 'all_gb_dgsr_type',
        gsr.gb_dgsr_waste_weight 'all_gb_dgsr_waste_weight',
        gsr.gb_dgsr_waste_subtotal 'all_gb_dgsr_waste_subtotal',
        gsr.gb_department_goods_stock_reduce_id 'all_gb_department_goods_stock_reduce_id',
        gsr.gb_dgsr_gb_department_father_id 'all_gb_dgsr_gb_department_father_id',
        gsr.gb_dgsr_gb_dis_goods_father_id 'all_gb_dgsr_gb_dis_goods_father_id',
        gsr.gb_dgsr_return_weight 'all_gb_dgsr_return_weight',
        gsr.gb_dgsr_return_subtotal 'all_gb_dgsr_return_subtotal',
        gsr.gb_dgsr_produce_weight 'all_gb_dgsr_produce_weight',
        gsr.gb_dgsr_produce_subtotal 'all_gb_dgsr_produce_subtotal',
        gsr.gb_dgsr_loss_weight 'all_gb_dgsr_loss_weight',
        gsr.gb_dgsr_loss_subtotal 'all_gb_dgsr_loss_subtotal',
        gsr.gb_dgsr_gb_dep_dis_goods_id 'all_gb_dgsr_gb_dep_dis_goods_id',
        gsr.gb_dgsr_month 'all_gb_dgsr_month',
        gsr.gb_dgsr_week 'all_gb_dgsr_week'
        from gb_department_goods_stock_reduce as gdgsr
        left join gb_department_goods_daily as gdgd on gdgsr.gb_dgsr_gb_dis_goods_id = gdgd.gb_dgd_gb_dis_goods_id
        and gdgd.gb_dgd_waste_weight &gt; 0 and gdgd.gb_dgd_date = gdgsr.gb_dgsr_date
        and gdgd.gb_dgd_gb_department_father_id = #{depFatherId}
        left join gb_department_goods_stock as gdgs on gdgs.gb_department_goods_stock_id =
        gdgsr.gb_dgsr_gb_goods_stock_id
        left join gb_department_goods_stock_reduce as gsr on gsr.gb_dgsr_gb_goods_stock_id =
        gdgs.gb_department_goods_stock_id
        left join gb_distributer_goods as dg on dg.gb_distributer_goods_id = gdgd.gb_dgd_gb_dis_goods_id

        <where>
            <if test="inventoryType != null">
                and gdgsr.gb_dgsr_gb_goods_inventory_type = #{inventoryType}
            </if>
            <if test="disId != null">
                and gdgsr.gb_dgsr_gb_distributer_id = #{disId}
            </if>
            <if test="date != null">
                and gdgsr.gb_dgsr_date = #{date}
            </if>
            <if test="startDate != null">
                and gdgsr.gb_dgsr_date &gt;= #{startDate}
            </if>
            <if test="stopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{stopDate}
            </if>
            <if test="notDayuStopDate != null">
                and gdgsr.gb_dgsr_date &lt;= #{notDayuStopDate}
            </if>
            <if test="equalType != null">
                and gdgsr.gb_dgsr_type = #{equalType}
            </if>

            <if test="disGoodsId != null">
                and gdgsr.gb_dgsr_gb_dis_goods_id = #{disGoodsId}
            </if>
            <if test="depFatherId != null">
                and gdgsr.gb_dgsr_gb_department_father_id = #{depFatherId}
            </if>
            <if test="depFatherIds != null">
                and gdgsr.gb_dgsr_gb_department_father_id in
                <foreach item="id" collection="depFatherIds" open="(" separator="," close=")">
                    #{id}
                </foreach>
            </if>
        </where>
    </select>


    <insert id="save" parameterType="com.nongxinle.entity.GbDepartmentGoodsDailyEntity">
        insert into gb_department_goods_daily
        (`gb_department_goods_daily_id`,
         `gb_dgd_gb_distributer_id`,
         `gb_dgd_gb_department_id`,
         `gb_dgd_gb_department_father_id`,
         `gb_dgd_gb_dis_goods_id`,
         `gb_dgd_gb_dis_goods_father_id`,
         `gb_dgd_gb_dep_dis_goods_id`,
         `gb_dgd_weight`,
         `gb_dgd_rest_weight`,
         `gb_dgd_subtotal`,
         `gb_dgd_date`,
         `gb_dgd_day`,
         `gb_dgd_week`,
         `gb_dgd_month`,
         `gb_dgd_full_time`,
         `gb_dgd_year`,
         `gb_dgd_produce_weight`,
         `gb_dgd_produce_subtotal`,
         `gb_dgd_loss_weight`,
         `gb_dgd_loss_subtotal`,
         `gb_dgd_waste_weight`,
         `gb_dgd_waste_subtotal`,
         `gb_dgd_return_weight`,
         `gb_dgd_return_subtotal`,
         `gb_dgd_profit_subtotal`,
         `gb_dgd_sales_subtotal`,
         `gb_dgd_after_profit_subtotal`,
         `gb_dgd_sell_clear_hour`,
         `gb_dgd_sell_clear_minute`,
         `gb_dgd_last_weight`,
         `gb_dgd_fresh_rate`,
         `gb_dgd_task_time`,
         `gb_dgd_last_produce_weight`)
        values (#{gbDepartmentGoodsDailyId},
                #{gbDgdGbDistributerId},
                #{gbDgdGbDepartmentId},
                #{gbDgdGbDepartmentFatherId},
                #{gbDgdGbDisGoodsId},
                #{gbDgdGbDisGoodsFatherId},
                #{gbDgdGbDepDisGoodsId},
                #{gbDgdWeight},
                #{gbDgdRestWeight},
                #{gbDgdSubtotal},
                #{gbDgdDate},
                #{gbDgdDay},
                #{gbDgdWeek},
                #{gbDgdMonth},
                #{gbDgdFullTime},
                #{gbDgdYear},
                #{gbDgdProduceWeight},
                #{gbDgdProduceSubtotal},
                #{gbDgdLossWeight},
                #{gbDgdLossSubtotal},
                #{gbDgdWasteWeight},
                #{gbDgdWasteSubtotal},
                #{gbDgdReturnWeight},
                #{gbDgdReturnSubtotal},
                #{gbDgdProfitSubtotal},
                #{gbDgdSalesSubtotal},
                #{gbDgdAfterProfitSubtotal},
                #{gbDgdSellClearHour},
                #{gbDgdSellClearMinute},
                #{gbDgdLastWeight},
                #{gbDgdFreshRate},
                #{gbDgdTaskTime},
                #{gbDgdLastProduceWeight})
    </insert>

    <update id="update" parameterType="com.nongxinle.entity.GbDepartmentGoodsDailyEntity">
        update gb_department_goods_daily
        <set>
            <if test="gbDgdGbDistributerId != null">`gb_dgd_gb_distributer_id` = #{gbDgdGbDistributerId},</if>
            <if test="gbDgdGbDepartmentId != null">`gb_dgd_gb_department_id` = #{gbDgdGbDepartmentId},</if>
            <if test="gbDgdGbDepartmentFatherId != null">`gb_dgd_gb_department_father_id` =
                #{gbDgdGbDepartmentFatherId},
            </if>
            <if test="gbDgdGbDisGoodsId != null">`gb_dgd_gb_dis_goods_id` = #{gbDgdGbDisGoodsId},</if>
            <if test="gbDgdGbDisGoodsFatherId != null">`gb_dgd_gb_dis_goods_father_id` = #{gbDgdGbDisGoodsFatherId},
            </if>
            <if test="gbDgdGbDepDisGoodsId != null">`gb_dgd_gb_dep_dis_goods_id` = #{gbDgdGbDepDisGoodsId},</if>
            <if test="gbDgdWeight != null">`gb_dgd_weight` = #{gbDgdWeight},</if>
            <if test="gbDgdRestWeight != null">`gb_dgd_rest_weight` = #{gbDgdRestWeight},</if>
            <if test="gbDgdSubtotal != null">`gb_dgd_subtotal` = #{gbDgdSubtotal},</if>
            <if test="gbDgdDate != null">`gb_dgd_date` = #{gbDgdDate},</if>
            <if test="gbDgdDay != null">`gb_dgd_day` = #{gbDgdDay},</if>
            <if test="gbDgdWeek != null">`gb_dgd_week` = #{gbDgdWeek},</if>
            <if test="gbDgdMonth != null">`gb_dgd_month` = #{gbDgdMonth},</if>
            <if test="gbDgdFullTime != null">`gb_dgd_full_time` = #{gbDgdFullTime},</if>
            <if test="gbDgdYear != null">`gb_dgd_year` = #{gbDgdYear},</if>
            <if test="gbDgdProduceWeight != null">`gb_dgd_produce_weight` = #{gbDgdProduceWeight},</if>
            <if test="gbDgdProduceSubtotal != null">`gb_dgd_produce_subtotal` = #{gbDgdProduceSubtotal},</if>
            <if test="gbDgdLossWeight != null">`gb_dgd_loss_weight` = #{gbDgdLossWeight},</if>
            <if test="gbDgdLossSubtotal != null">`gb_dgd_loss_subtotal` = #{gbDgdLossSubtotal},</if>
            <if test="gbDgdWasteWeight != null">`gb_dgd_waste_weight` = #{gbDgdWasteWeight},</if>
            <if test="gbDgdWasteSubtotal != null">`gb_dgd_waste_subtotal` = #{gbDgdWasteSubtotal},</if>
            <if test="gbDgdReturnWeight != null">`gb_dgd_return_weight` = #{gbDgdReturnWeight},</if>
            <if test="gbDgdReturnSubtotal != null">`gb_dgd_return_subtotal` = #{gbDgdReturnSubtotal},</if>
            <if test="gbDgdProfitSubtotal != null">`gb_dgd_profit_subtotal` = #{gbDgdProfitSubtotal},</if>
            <if test="gbDgdSalesSubtotal != null">`gb_dgd_sales_subtotal` = #{gbDgdSalesSubtotal},</if>
            <if test="gbDgdSellClearHour != null">`gb_dgd_sell_clear_hour` = #{gbDgdSellClearHour},</if>
            <if test="gbDgdSellClearMinute != null">`gb_dgd_sell_clear_minute` = #{gbDgdSellClearMinute},</if>
            <if test="gbDgdLastWeight != null">`gb_dgd_last_weight` = #{gbDgdLastWeight},</if>
            <if test="gbDgdFreshRate != null">`gb_dgd_fresh_rate` = #{gbDgdFreshRate},</if>
            <if test="gbDgdTaskTime != null">`gb_dgd_task_time` = #{gbDgdTaskTime},</if>
            <if test="gbDgdLastProduceWeight != null">`gb_dgd_last_produce_weight` = #{gbDgdLastProduceWeight},</if>
            <if test="gbDgdAfterProfitSubtotal != null">`gb_dgd_after_profit_subtotal` = #{gbDgdAfterProfitSubtotal}
            </if>
        </set>
        where gb_department_goods_daily_id = #{gbDepartmentGoodsDailyId}
    </update>

    <delete id="delete">
        delete
        from gb_department_goods_daily
        where gb_department_goods_daily_id = #{value}
    </delete>

    <delete id="deleteBatch">
        delete from gb_department_goods_daily where gb_department_goods_daily_id in
        <foreach item="gbDepartmentGoodsDailyId" collection="array" open="(" separator="," close=")">
            #{gbDepartmentGoodsDailyId}
        </foreach>
    </delete>

</mapper>